//! @file
//! 
//! This source file was generated from CellML.
//! 
//! Model: courtemanche_ramirez_nattel_model_1998
//! 
//! Processed by pycml - CellML Tools in Python
//!     (translators: , pycml: , optimize: )
//! on Wed Mar 11 16:43:38 2020
//! 
//! <autogenerated>

#include "courtemanche_ramirez_nattel_model_1998.hpp"
#include <cmath>
#include <cassert>
#include <memory>
#include "CardiacNewtonSolver.hpp"
#include "Exception.hpp"
#include "OdeSystemInformation.hpp"
#include "RegularStimulus.hpp"
#include "HeartConfig.hpp"
#include "IsNan.hpp"
#include "MathsCustomFunctions.hpp"

    boost::shared_ptr<RegularStimulus> Dynamiccourtemanche_ramirez_nattel_model_1998FromCellMLBackwardEuler::UseCellMLDefaultStimulus()
    {
        // Use the default stimulus specified by CellML metadata
        const double var_membrane__Cm = 100.0; // picoF
        const double var_chaste_interface__membrane__stim_start = 50.0; // millisecond
        const double var_chaste_interface__membrane__stim_period = 1000.0; // millisecond
        const double var_chaste_interface__membrane__stim_duration = 2.0; // millisecond
        const double var_chaste_interface__membrane__stim_amplitude = ( -2000.0 / var_membrane__Cm) * HeartConfig::Instance()->GetCapacitance(); // uA_per_cm2
        boost::shared_ptr<RegularStimulus> p_cellml_stim(new RegularStimulus(
                -fabs(var_chaste_interface__membrane__stim_amplitude),
                var_chaste_interface__membrane__stim_duration,
                var_chaste_interface__membrane__stim_period,
                var_chaste_interface__membrane__stim_start
                ));
        mpIntracellularStimulus = p_cellml_stim;
        return p_cellml_stim;
    }
    
    Dynamiccourtemanche_ramirez_nattel_model_1998FromCellMLBackwardEuler::Dynamiccourtemanche_ramirez_nattel_model_1998FromCellMLBackwardEuler(boost::shared_ptr<AbstractIvpOdeSolver> /* unused; should be empty */, boost::shared_ptr<AbstractStimulusFunction> pIntracellularStimulus)
        : AbstractBackwardEulerCardiacCell<8>(
                21,
                0,
                pIntracellularStimulus)
    {
        // Time units: millisecond
        // 
        this->mpSystemInfo = OdeSystemInformation<Dynamiccourtemanche_ramirez_nattel_model_1998FromCellMLBackwardEuler>::Instance();
        Init();

        // We have a default stimulus specified in the CellML file metadata
        this->mHasDefaultStimulusFromCellML = true;
    }
    
    Dynamiccourtemanche_ramirez_nattel_model_1998FromCellMLBackwardEuler::~Dynamiccourtemanche_ramirez_nattel_model_1998FromCellMLBackwardEuler()
    {
    }
    
    double Dynamiccourtemanche_ramirez_nattel_model_1998FromCellMLBackwardEuler::GetIIonic(const std::vector<double>* pStateVariables)
    {
        // For state variable interpolation (SVI) we read in interpolated state variables,
        // otherwise for ionic current interpolation (ICI) we use the state variables of this model (node).
        if (!pStateVariables) pStateVariables = &rGetStateVariables();
        const std::vector<double>& rY = *pStateVariables;
        double var_chaste_interface__membrane__V = (mSetVoltageDerivativeToZero ? this->mFixedVoltage : rY[0]);
        // Units: millivolt; Initial value: -81.18
        double var_chaste_interface__fast_sodium_current_m_gate__m = rY[1];
        // Units: dimensionless; Initial value: 2.908e-3
        double var_chaste_interface__fast_sodium_current_h_gate__h = rY[2];
        // Units: dimensionless; Initial value: 9.649e-1
        double var_chaste_interface__fast_sodium_current_j_gate__j = rY[3];
        // Units: dimensionless; Initial value: 9.775e-1
        double var_chaste_interface__transient_outward_K_current_oa_gate__oa = rY[4];
        // Units: dimensionless; Initial value: 3.043e-2
        double var_chaste_interface__transient_outward_K_current_oi_gate__oi = rY[5];
        // Units: dimensionless; Initial value: 9.992e-1
        double var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ua_gate__ua = rY[6];
        // Units: dimensionless; Initial value: 4.966e-3
        double var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ui_gate__ui = rY[7];
        // Units: dimensionless; Initial value: 9.986e-1
        double var_chaste_interface__rapid_delayed_rectifier_K_current_xr_gate__xr = rY[8];
        // Units: dimensionless; Initial value: 3.296e-5
        double var_chaste_interface__slow_delayed_rectifier_K_current_xs_gate__xs = rY[9];
        // Units: dimensionless; Initial value: 1.869e-2
        double var_chaste_interface__L_type_Ca_channel_d_gate__d = rY[10];
        // Units: dimensionless; Initial value: 1.367e-4
        double var_chaste_interface__L_type_Ca_channel_f_gate__f = rY[11];
        // Units: dimensionless; Initial value: 9.996e-1
        double var_chaste_interface__L_type_Ca_channel_f_Ca_gate__f_Ca = rY[12];
        // Units: dimensionless; Initial value: 7.755e-1
        double var_chaste_interface__intracellular_ion_concentrations__Na_i = rY[16];
        // Units: millimolar; Initial value: 1.117e+01
        double var_chaste_interface__intracellular_ion_concentrations__Ca_i = rY[17];
        // Units: millimolar; Initial value: 1.013e-4
        double var_chaste_interface__intracellular_ion_concentrations__K_i = rY[18];
        // Units: millimolar; Initial value: 1.39e+02
        
        const double var_membrane__Cm = 100.0; // picoF
        const double var_fast_sodium_current__E_Na = 26.71283192398538 * log(140.0 / var_chaste_interface__intracellular_ion_concentrations__Na_i); // millivolt
        const double var_fast_sodium_current__i_Na = var_membrane__Cm * 7.7999999999999998 * pow(var_chaste_interface__fast_sodium_current_m_gate__m, 3.0) * var_chaste_interface__fast_sodium_current_h_gate__h * var_chaste_interface__fast_sodium_current_j_gate__j * (var_chaste_interface__membrane__V - var_fast_sodium_current__E_Na); // picoA
        const double var_time_independent_potassium_current__E_K = 26.71283192398538 * log(5.4000000000000004 / var_chaste_interface__intracellular_ion_concentrations__K_i); // millivolt
        const double var_time_independent_potassium_current__i_K1 = (var_membrane__Cm * 0.089999999999999997 * (var_chaste_interface__membrane__V - var_time_independent_potassium_current__E_K)) / (1.0 + exp(0.070000000000000007 * (var_chaste_interface__membrane__V + 80.0))); // picoA
        const double var_transient_outward_K_current__i_to = var_membrane__Cm * 0.16520000000000001 * pow(var_chaste_interface__transient_outward_K_current_oa_gate__oa, 3.0) * var_chaste_interface__transient_outward_K_current_oi_gate__oi * (var_chaste_interface__membrane__V - var_time_independent_potassium_current__E_K); // picoA
        const double var_ultrarapid_delayed_rectifier_K_current__i_Kur = var_membrane__Cm * (0.0050000000000000001 + (0.050000000000000003 / (1.0 + exp((var_chaste_interface__membrane__V - 15.0) *  -0.076923076923076927)))) * pow(var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ua_gate__ua, 3.0) * var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ui_gate__ui * (var_chaste_interface__membrane__V - var_time_independent_potassium_current__E_K); // picoA
        const double var_rapid_delayed_rectifier_K_current__i_Kr = (var_membrane__Cm * 0.029411764999999999 * var_chaste_interface__rapid_delayed_rectifier_K_current_xr_gate__xr * (var_chaste_interface__membrane__V - var_time_independent_potassium_current__E_K)) / (1.0 + exp((var_chaste_interface__membrane__V + 15.0) * 0.044642857142857144)); // picoA
        const double var_slow_delayed_rectifier_K_current__i_Ks = var_membrane__Cm * 0.12941175999999999 * pow(var_chaste_interface__slow_delayed_rectifier_K_current_xs_gate__xs, 2.0) * (var_chaste_interface__membrane__V - var_time_independent_potassium_current__E_K); // picoA
        const double var_L_type_Ca_channel__i_Ca_L = var_membrane__Cm * 0.12375 * var_chaste_interface__L_type_Ca_channel_d_gate__d * var_chaste_interface__L_type_Ca_channel_f_gate__f * var_chaste_interface__L_type_Ca_channel_f_Ca_gate__f_Ca * (var_chaste_interface__membrane__V - 65.0); // picoA
        const double var_sarcolemmal_calcium_pump_current__i_CaP = (var_membrane__Cm * 0.27500000000000002 * var_chaste_interface__intracellular_ion_concentrations__Ca_i) / (0.00050000000000000001 + var_chaste_interface__intracellular_ion_concentrations__Ca_i); // picoA
        const double var_sodium_potassium_pump__i_NaK = (((var_membrane__Cm * pow(1.0 + (0.1245 * exp((var_chaste_interface__membrane__V *  -9.648670000000001) * 0.0003879829271992715)) + (exp(( -96.486699999999999 * var_chaste_interface__membrane__V) * 0.0003879829271992715) * 0.036533226130519084),  -1.0) * 0.59933873999999998) / (1.0 + pow(10.0 / var_chaste_interface__intracellular_ion_concentrations__Na_i, 1.5))) * 5.4000000000000004) * 0.14492753623188406; // picoA
        const double var_Na_Ca_exchanger_current__i_NaCa = (var_membrane__Cm * 1600.0 * ((exp((var_chaste_interface__membrane__V * 33.770344999999999) * 0.0003879829271992715) * pow(var_chaste_interface__intracellular_ion_concentrations__Na_i, 3.0) * 1.8) - (exp((var_chaste_interface__membrane__V *  -62.716355) * 0.0003879829271992715) * 2744000.0 * var_chaste_interface__intracellular_ion_concentrations__Ca_i))) / ((1.0 + (0.10000000000000001 * exp((var_chaste_interface__membrane__V *  -62.716355) * 0.0003879829271992715))) * 10856271.562499998); // picoA
        const double var_background_currents__i_B_Na = var_membrane__Cm * 0.00067443750000000002 * (var_chaste_interface__membrane__V - var_fast_sodium_current__E_Na); // picoA
        const double var_background_currents__i_B_Ca = var_membrane__Cm * 0.0011310000000000001 * (var_chaste_interface__membrane__V - (13.35641596199269 * log(1.8 / var_chaste_interface__intracellular_ion_concentrations__Ca_i))); // picoA
        const double var_chaste_interface__i_ionic = ((var_fast_sodium_current__i_Na + var_time_independent_potassium_current__i_K1 + var_transient_outward_K_current__i_to + var_ultrarapid_delayed_rectifier_K_current__i_Kur + var_rapid_delayed_rectifier_K_current__i_Kr + var_slow_delayed_rectifier_K_current__i_Ks + var_background_currents__i_B_Na + var_background_currents__i_B_Ca + var_sodium_potassium_pump__i_NaK + var_sarcolemmal_calcium_pump_current__i_CaP + var_Na_Ca_exchanger_current__i_NaCa + var_L_type_Ca_channel__i_Ca_L) / var_membrane__Cm) * HeartConfig::Instance()->GetCapacitance(); // uA_per_cm2
        
        const double i_ionic = var_chaste_interface__i_ionic;
        EXCEPT_IF_NOT(!std::isnan(i_ionic));
        return i_ionic;
    }
    
    void Dynamiccourtemanche_ramirez_nattel_model_1998FromCellMLBackwardEuler::ComputeResidual(double var_chaste_interface__environment__time, const double rCurrentGuess[8], double rResidual[8])
    {
        std::vector<double>& rY = rGetStateVariables();
        double var_chaste_interface__membrane__V = (mSetVoltageDerivativeToZero ? this->mFixedVoltage : rY[0]);
        // Units: millivolt; Initial value: -81.18
        double var_chaste_interface__fast_sodium_current_m_gate__m = rY[1];
        // Units: dimensionless; Initial value: 2.908e-3
        double var_chaste_interface__fast_sodium_current_h_gate__h = rY[2];
        // Units: dimensionless; Initial value: 9.649e-1
        double var_chaste_interface__fast_sodium_current_j_gate__j = rY[3];
        // Units: dimensionless; Initial value: 9.775e-1
        double var_chaste_interface__transient_outward_K_current_oa_gate__oa = rY[4];
        // Units: dimensionless; Initial value: 3.043e-2
        double var_chaste_interface__transient_outward_K_current_oi_gate__oi = rY[5];
        // Units: dimensionless; Initial value: 9.992e-1
        double var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ua_gate__ua = rY[6];
        // Units: dimensionless; Initial value: 4.966e-3
        double var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ui_gate__ui = rY[7];
        // Units: dimensionless; Initial value: 9.986e-1
        double var_chaste_interface__rapid_delayed_rectifier_K_current_xr_gate__xr = rY[8];
        // Units: dimensionless; Initial value: 3.296e-5
        double var_chaste_interface__slow_delayed_rectifier_K_current_xs_gate__xs = rY[9];
        // Units: dimensionless; Initial value: 1.869e-2
        double var_chaste_interface__L_type_Ca_channel_d_gate__d = rY[10];
        // Units: dimensionless; Initial value: 1.367e-4
        double var_chaste_interface__L_type_Ca_channel_f_gate__f = rY[11];
        // Units: dimensionless; Initial value: 9.996e-1
        double var_chaste_interface__Ca_release_current_from_JSR_w_gate__w = rY[15];
        // Units: dimensionless; Initial value: 0.9992
        
        //output_nonlinear_state_assignments
        double var_chaste_interface__Ca_release_current_from_JSR_u_gate__u = rCurrentGuess[0];
        double var_chaste_interface__Ca_release_current_from_JSR_v_gate__v = rCurrentGuess[1];
        double var_chaste_interface__L_type_Ca_channel_f_Ca_gate__f_Ca = rCurrentGuess[2];
        double var_chaste_interface__intracellular_ion_concentrations__Ca_i = rCurrentGuess[3];
        double var_chaste_interface__intracellular_ion_concentrations__Ca_rel = rCurrentGuess[4];
        double var_chaste_interface__intracellular_ion_concentrations__Ca_up = rCurrentGuess[5];
        double var_chaste_interface__intracellular_ion_concentrations__K_i = rCurrentGuess[6];
        double var_chaste_interface__intracellular_ion_concentrations__Na_i = rCurrentGuess[7];
        
        //output_equations
        const double var_membrane__Cm = 100.0; // picoF
        const double var_fast_sodium_current__E_Na = 26.71283192398538 * log(140.0 / var_chaste_interface__intracellular_ion_concentrations__Na_i); // millivolt
        const double var_fast_sodium_current__i_Na = var_membrane__Cm * 7.7999999999999998 * pow(var_chaste_interface__fast_sodium_current_m_gate__m, 3.0) * var_chaste_interface__fast_sodium_current_h_gate__h * var_chaste_interface__fast_sodium_current_j_gate__j * (var_chaste_interface__membrane__V - var_fast_sodium_current__E_Na); // picoA
        const double var_time_independent_potassium_current__E_K = 26.71283192398538 * log(5.4000000000000004 / var_chaste_interface__intracellular_ion_concentrations__K_i); // millivolt
        const double var_time_independent_potassium_current__i_K1 = (var_membrane__Cm * 0.089999999999999997 * (var_chaste_interface__membrane__V - var_time_independent_potassium_current__E_K)) / (1.0 + exp(0.070000000000000007 * (var_chaste_interface__membrane__V + 80.0))); // picoA
        const double var_transient_outward_K_current__i_to = var_membrane__Cm * 0.16520000000000001 * pow(var_chaste_interface__transient_outward_K_current_oa_gate__oa, 3.0) * var_chaste_interface__transient_outward_K_current_oi_gate__oi * (var_chaste_interface__membrane__V - var_time_independent_potassium_current__E_K); // picoA
        const double var_ultrarapid_delayed_rectifier_K_current__i_Kur = var_membrane__Cm * (0.0050000000000000001 + (0.050000000000000003 / (1.0 + exp((var_chaste_interface__membrane__V - 15.0) *  -0.076923076923076927)))) * pow(var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ua_gate__ua, 3.0) * var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ui_gate__ui * (var_chaste_interface__membrane__V - var_time_independent_potassium_current__E_K); // picoA
        const double var_rapid_delayed_rectifier_K_current__i_Kr = (var_membrane__Cm * 0.029411764999999999 * var_chaste_interface__rapid_delayed_rectifier_K_current_xr_gate__xr * (var_chaste_interface__membrane__V - var_time_independent_potassium_current__E_K)) / (1.0 + exp((var_chaste_interface__membrane__V + 15.0) * 0.044642857142857144)); // picoA
        const double var_slow_delayed_rectifier_K_current__i_Ks = var_membrane__Cm * 0.12941175999999999 * pow(var_chaste_interface__slow_delayed_rectifier_K_current_xs_gate__xs, 2.0) * (var_chaste_interface__membrane__V - var_time_independent_potassium_current__E_K); // picoA
        const double var_L_type_Ca_channel__i_Ca_L = var_membrane__Cm * 0.12375 * var_chaste_interface__L_type_Ca_channel_d_gate__d * var_chaste_interface__L_type_Ca_channel_f_gate__f * var_chaste_interface__L_type_Ca_channel_f_Ca_gate__f_Ca * (var_chaste_interface__membrane__V - 65.0); // picoA
        const double var_sarcolemmal_calcium_pump_current__i_CaP = (var_membrane__Cm * 0.27500000000000002 * var_chaste_interface__intracellular_ion_concentrations__Ca_i) / (0.00050000000000000001 + var_chaste_interface__intracellular_ion_concentrations__Ca_i); // picoA
        const double var_sodium_potassium_pump__i_NaK = (((var_membrane__Cm * pow(1.0 + (0.1245 * exp((var_chaste_interface__membrane__V *  -9.648670000000001) * 0.0003879829271992715)) + (exp(( -96.486699999999999 * var_chaste_interface__membrane__V) * 0.0003879829271992715) * 0.036533226130519084),  -1.0) * 0.59933873999999998) / (1.0 + pow(10.0 / var_chaste_interface__intracellular_ion_concentrations__Na_i, 1.5))) * 5.4000000000000004) * 0.14492753623188406; // picoA
        const double var_Na_Ca_exchanger_current__i_NaCa = (var_membrane__Cm * 1600.0 * ((exp((var_chaste_interface__membrane__V * 33.770344999999999) * 0.0003879829271992715) * pow(var_chaste_interface__intracellular_ion_concentrations__Na_i, 3.0) * 1.8) - (exp((var_chaste_interface__membrane__V *  -62.716355) * 0.0003879829271992715) * 2744000.0 * var_chaste_interface__intracellular_ion_concentrations__Ca_i))) / ((1.0 + (0.10000000000000001 * exp((var_chaste_interface__membrane__V *  -62.716355) * 0.0003879829271992715))) * 10856271.562499998); // picoA
        const double var_background_currents__i_B_Na = var_membrane__Cm * 0.00067443750000000002 * (var_chaste_interface__membrane__V - var_fast_sodium_current__E_Na); // picoA
        const double var_background_currents__i_B_Ca = var_membrane__Cm * 0.0011310000000000001 * (var_chaste_interface__membrane__V - (13.35641596199269 * log(1.8 / var_chaste_interface__intracellular_ion_concentrations__Ca_i))); // picoA
        const double var_Ca_release_current_from_JSR__i_rel = 30.0 * pow(var_chaste_interface__Ca_release_current_from_JSR_u_gate__u, 2.0) * var_chaste_interface__Ca_release_current_from_JSR_v_gate__v * var_chaste_interface__Ca_release_current_from_JSR_w_gate__w * (var_chaste_interface__intracellular_ion_concentrations__Ca_rel - var_chaste_interface__intracellular_ion_concentrations__Ca_i); // millimolar_per_millisecond
        const double var_Ca_release_current_from_JSR__Fn = 1000.0 * ((var_Ca_release_current_from_JSR__i_rel * 9.6479999999999996e-14) - (5.182061361824998e-18 * ((0.5 * var_L_type_Ca_channel__i_Ca_L) - (0.20000000000000001 * var_Na_Ca_exchanger_current__i_NaCa)))); // dimensionless
        const double var_transfer_current_from_NSR_to_JSR__i_tr = (var_chaste_interface__intracellular_ion_concentrations__Ca_up - var_chaste_interface__intracellular_ion_concentrations__Ca_rel) * 0.0055555555555555558; // millimolar_per_millisecond
        const double var_Ca_uptake_current_by_the_NSR__i_up = 0.0050000000000000001 / (1.0 + (0.00092000000000000003 / var_chaste_interface__intracellular_ion_concentrations__Ca_i)); // millimolar_per_millisecond
        const double var_Ca_leak_current_by_the_NSR__i_up_leak = (0.0050000000000000001 * var_chaste_interface__intracellular_ion_concentrations__Ca_up) * 0.066666666666666666; // millimolar_per_millisecond
        const double d_dt_chaste_interface__L_type_Ca_channel_f_Ca_gate__f_Ca = (pow(1.0 + (var_chaste_interface__intracellular_ion_concentrations__Ca_i * 2857.1428571428573),  -1.0) - var_chaste_interface__L_type_Ca_channel_f_Ca_gate__f_Ca) * 0.5; // per_millisecond
        const double d_dt_chaste_interface__Ca_release_current_from_JSR_u_gate__u = (pow(1.0 + exp((-(var_Ca_release_current_from_JSR__Fn - 3.4174999999999998e-13)) * 731528895391368.0),  -1.0) - var_chaste_interface__Ca_release_current_from_JSR_u_gate__u) * 0.125; // per_millisecond
        const double d_dt_chaste_interface__Ca_release_current_from_JSR_v_gate__v = ((1.0 - pow(1.0 + exp((-(var_Ca_release_current_from_JSR__Fn - 6.8349999999999994e-14)) * 731528895391368.0),  -1.0)) - var_chaste_interface__Ca_release_current_from_JSR_v_gate__v) / (1.9099999999999999 + (2.0899999999999999 * pow(1.0 + exp((-(var_Ca_release_current_from_JSR__Fn - 3.4174999999999998e-13)) * 731528895391368.0),  -1.0))); // per_millisecond
        const double d_dt_chaste_interface__intracellular_ion_concentrations__Na_i = (( -3.0 * var_sodium_potassium_pump__i_NaK) - ((3.0 * var_Na_Ca_exchanger_current__i_NaCa) + var_background_currents__i_B_Na + var_fast_sodium_current__i_Na)) * 7.5827646500219442e-07; // 'millimole per litre per millisecond'
        const double d_dt_chaste_interface__intracellular_ion_concentrations__Ca_i = ((((2.0 * var_Na_Ca_exchanger_current__i_NaCa) - (var_sarcolemmal_calcium_pump_current__i_CaP + var_L_type_Ca_channel__i_Ca_L + var_background_currents__i_B_Ca)) * 3.7913823250109721e-07) + (((1109.52 * (var_Ca_leak_current_by_the_NSR__i_up_leak - var_Ca_uptake_current_by_the_NSR__i_up)) + (var_Ca_release_current_from_JSR__i_rel * 96.47999999999999)) * 7.3163593795727233e-05)) / (1.0 + (3.5000000000000004e-05 / pow(var_chaste_interface__intracellular_ion_concentrations__Ca_i + 0.00050000000000000001, 2.0)) + (0.00011900000000000002 / pow(var_chaste_interface__intracellular_ion_concentrations__Ca_i + 0.0023800000000000002, 2.0))); // 'millimole per litre per millisecond'
        const double d_dt_chaste_interface__intracellular_ion_concentrations__K_i = ((2.0 * var_sodium_potassium_pump__i_NaK) - (var_time_independent_potassium_current__i_K1 + var_transient_outward_K_current__i_to + var_ultrarapid_delayed_rectifier_K_current__i_Kur + var_rapid_delayed_rectifier_K_current__i_Kr + var_slow_delayed_rectifier_K_current__i_Ks + (var_membrane__Cm * 0.0 * (var_chaste_interface__membrane__V - var_time_independent_potassium_current__E_K)))) * 7.5827646500219442e-07; // 'millimole per litre per millisecond'
        const double d_dt_chaste_interface__intracellular_ion_concentrations__Ca_rel = (var_transfer_current_from_NSR_to_JSR__i_tr - var_Ca_release_current_from_JSR__i_rel) * pow(1.0 + (8.0 / pow(var_chaste_interface__intracellular_ion_concentrations__Ca_rel + 0.80000000000000004, 2.0)),  -1.0); // 'millimole per litre per millisecond'
        const double d_dt_chaste_interface__intracellular_ion_concentrations__Ca_up = var_Ca_uptake_current_by_the_NSR__i_up - (var_Ca_leak_current_by_the_NSR__i_up_leak + ((var_transfer_current_from_NSR_to_JSR__i_tr * 96.47999999999999) * 0.00090129064820823417)); // 'millimole per litre per millisecond'
        
        rResidual[2] = rCurrentGuess[2] - rY[12] - mDt*d_dt_chaste_interface__L_type_Ca_channel_f_Ca_gate__f_Ca;
        rResidual[0] = rCurrentGuess[0] - rY[13] - mDt*d_dt_chaste_interface__Ca_release_current_from_JSR_u_gate__u;
        rResidual[1] = rCurrentGuess[1] - rY[14] - mDt*d_dt_chaste_interface__Ca_release_current_from_JSR_v_gate__v;
        rResidual[7] = rCurrentGuess[7] - rY[16] - mDt*d_dt_chaste_interface__intracellular_ion_concentrations__Na_i;
        rResidual[3] = rCurrentGuess[3] - rY[17] - mDt*d_dt_chaste_interface__intracellular_ion_concentrations__Ca_i;
        rResidual[6] = rCurrentGuess[6] - rY[18] - mDt*d_dt_chaste_interface__intracellular_ion_concentrations__K_i;
        rResidual[4] = rCurrentGuess[4] - rY[19] - mDt*d_dt_chaste_interface__intracellular_ion_concentrations__Ca_rel;
        rResidual[5] = rCurrentGuess[5] - rY[20] - mDt*d_dt_chaste_interface__intracellular_ion_concentrations__Ca_up;
    }
    
    void Dynamiccourtemanche_ramirez_nattel_model_1998FromCellMLBackwardEuler::ComputeJacobian(double var_chaste_interface__environment__time, const double rCurrentGuess[8], double rJacobian[8][8])
    {
        std::vector<double>& rY = rGetStateVariables();
        double var_chaste_interface__membrane__V = (mSetVoltageDerivativeToZero ? this->mFixedVoltage : rY[0]);
        // Units: millivolt; Initial value: -81.18
        double var_chaste_interface__fast_sodium_current_m_gate__m = rY[1];
        // Units: dimensionless; Initial value: 2.908e-3
        double var_chaste_interface__fast_sodium_current_h_gate__h = rY[2];
        // Units: dimensionless; Initial value: 9.649e-1
        double var_chaste_interface__fast_sodium_current_j_gate__j = rY[3];
        // Units: dimensionless; Initial value: 9.775e-1
        double var_chaste_interface__transient_outward_K_current_oa_gate__oa = rY[4];
        // Units: dimensionless; Initial value: 3.043e-2
        double var_chaste_interface__transient_outward_K_current_oi_gate__oi = rY[5];
        // Units: dimensionless; Initial value: 9.992e-1
        double var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ua_gate__ua = rY[6];
        // Units: dimensionless; Initial value: 4.966e-3
        double var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ui_gate__ui = rY[7];
        // Units: dimensionless; Initial value: 9.986e-1
        double var_chaste_interface__rapid_delayed_rectifier_K_current_xr_gate__xr = rY[8];
        // Units: dimensionless; Initial value: 3.296e-5
        double var_chaste_interface__slow_delayed_rectifier_K_current_xs_gate__xs = rY[9];
        // Units: dimensionless; Initial value: 1.869e-2
        double var_chaste_interface__L_type_Ca_channel_d_gate__d = rY[10];
        // Units: dimensionless; Initial value: 1.367e-4
        double var_chaste_interface__L_type_Ca_channel_f_gate__f = rY[11];
        // Units: dimensionless; Initial value: 9.996e-1
        double var_chaste_interface__Ca_release_current_from_JSR_w_gate__w = rY[15];
        // Units: dimensionless; Initial value: 0.9992
        
        double var_chaste_interface__Ca_release_current_from_JSR_u_gate__u = rCurrentGuess[0];
        double var_chaste_interface__Ca_release_current_from_JSR_v_gate__v = rCurrentGuess[1];
        double var_chaste_interface__L_type_Ca_channel_f_Ca_gate__f_Ca = rCurrentGuess[2];
        double var_chaste_interface__intracellular_ion_concentrations__Ca_i = rCurrentGuess[3];
        double var_chaste_interface__intracellular_ion_concentrations__Ca_rel = rCurrentGuess[4];
        double var_chaste_interface__intracellular_ion_concentrations__Ca_up = rCurrentGuess[5];
        double var_chaste_interface__intracellular_ion_concentrations__K_i = rCurrentGuess[6];
        double var_chaste_interface__intracellular_ion_concentrations__Na_i = rCurrentGuess[7];
        
        const double var_chaste_interface__environment__dt = mDt;

        const double var_membrane__Cm = 100.0; // picoF
        const double var_t1 = var_membrane__Cm * 7.7999999999999998; // dimensionless
        const double var_t3 = pow(var_chaste_interface__fast_sodium_current_m_gate__m, 2.0) * var_chaste_interface__fast_sodium_current_m_gate__m; // dimensionless
        const double var_t4 = var_t3 * var_chaste_interface__fast_sodium_current_h_gate__h; // dimensionless
        const double var_t7 = var_membrane__Cm * 0.089999999999999997; // dimensionless
        const double var_t10 = exp((0.070000000000000007 * var_chaste_interface__membrane__V) + 5.5999999999999996); // dimensionless
        const double var_t11 = 1.0 + var_t10; // dimensionless
        const double var_t12 = 1.0 / var_t11; // dimensionless
        const double var_t16 = 1.0 / var_chaste_interface__intracellular_ion_concentrations__K_i; // dimensionless
        const double var_t32 = ((var_membrane__Cm * 0.16520000000000001) * (pow(var_chaste_interface__transient_outward_K_current_oa_gate__oa, 2.0) * var_chaste_interface__transient_outward_K_current_oa_gate__oa)) * var_chaste_interface__transient_outward_K_current_oi_gate__oi; // dimensionless
        const double var_t35 = exp(( -0.076923076923076927 * var_chaste_interface__membrane__V) + 1.1538461538461537); // dimensionless
        const double var_t36 = 1.0 + var_t35; // dimensionless
        const double var_t43 = (pow(var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ua_gate__ua, 2.0) * var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ua_gate__ua) * var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ui_gate__ui; // dimensionless
        const double var_t51 = (var_membrane__Cm * (0.0050000000000000001 + (0.050000000000000003 / var_t36))) * var_t43; // dimensionless
        const double var_t52 = var_membrane__Cm * 0.029411764999999999; // dimensionless
        const double var_t55 = exp((0.044642857139999999 * var_chaste_interface__membrane__V) + 0.66964285710000004); // dimensionless
        const double var_t56 = 1.0 + var_t55; // dimensionless
        const double var_t57 = 1.0 / var_t56; // dimensionless
        const double var_t69 = (var_membrane__Cm * 0.12941175999999999) * pow(var_chaste_interface__slow_delayed_rectifier_K_current_xs_gate__xs, 2.0); // dimensionless
        const double var_t70 = var_membrane__Cm * 0.00067443750000000002; // dimensionless
        const double var_t71 = var_membrane__Cm * 0.0011310000000000001; // dimensionless
        const double var_t72 = var_membrane__Cm * 0.59933873999999998; // dimensionless
        const double var_t77 = (96.486699999999999 * var_chaste_interface__membrane__V) * 0.00038798292719927156; // dimensionless
        const double var_t79 = exp( -0.10000000000000001 * var_t77); // dimensionless
        const double var_t84 = exp(-var_t77); // dimensionless
        const double var_t87 = (1.0 + (0.1245 * var_t79)) + (0.036533226126172443 * var_t84); // dimensionless
        const double var_t91 = 1.0 / var_chaste_interface__intracellular_ion_concentrations__Na_i; // dimensionless
        const double var_t92 = 10.0 * var_t91; // dimensionless
        const double var_t94 = 1.0 + pow(var_t92, 1.5); // dimensionless
        const double var_t111 = var_membrane__Cm * 1600.0; // dimensionless
        const double var_t115 = (var_chaste_interface__membrane__V * 0.12027470743177418) * 0.0032258064516129032; // dimensionless
        const double var_t117 = exp(33.770344999999999 * var_t115); // dimensionless
        const double var_t119 = pow(var_chaste_interface__intracellular_ion_concentrations__Na_i, 2.0); // dimensionless
        const double var_t120 = var_t119 * var_chaste_interface__intracellular_ion_concentrations__Na_i; // dimensionless
        const double var_t128 = exp( -62.716355 * var_t115); // dimensionless
        const double var_t145 = 1.0 + (0.10000000000000001 * var_t128); // dimensionless
        const double var_t146 = 1.0 / var_t145; // dimensionless
        const double var_t147 = 9.2112655274231051e-08 * var_t146; // dimensionless
        const double var_t151 = var_t128 * 2744000.0; // dimensionless
        const double var_t154 = var_t111 * (((var_t117 * var_t120) * 1.8) - (var_t151 * var_chaste_interface__intracellular_ion_concentrations__Ca_i)); // dimensionless
        const double var_t164 = var_membrane__Cm * 0.12375; // dimensionless
        const double var_t165 = var_chaste_interface__L_type_Ca_channel_d_gate__d * var_chaste_interface__L_type_Ca_channel_f_gate__f; // dimensionless
        const double var_t204 = var_chaste_interface__membrane__V - 65.0; // dimensionless
        const double var_t214 = 3.2128780443314988 * var_t91; // dimensionless
        const double var_t222 = (1.0 / var_t87) / pow(var_t94, 2.0); // dimensionless
        const double var_t225 = pow(var_t92, 0.5); // dimensionless
        const double var_t227 = 1.0 / var_t119; // dimensionless
        const double var_t232 = var_t117 * var_t119; // dimensionless
        const double var_t235 = 0.31446540880503149 * var_t146; // dimensionless
        const double var_t242 = 1.0 / var_chaste_interface__intracellular_ion_concentrations__Ca_i; // dimensionless
        const double var_t246 = var_membrane__Cm * 0.27500000000000002; // dimensionless
        const double var_t247 = 0.00050000000000000001 + var_chaste_interface__intracellular_ion_concentrations__Ca_i; // dimensionless
        const double var_t248 = 1.0 / var_t247; // dimensionless
        const double var_t256 = 0.8037676609105181 * var_t235; // dimensionless
        const double var_t265 = 26.71283192398538 * var_t16; // dimensionless
        const double var_t821 = pow(var_chaste_interface__Ca_release_current_from_JSR_u_gate__u, 2.0); // dimensionless
        const double var_t823 = var_chaste_interface__Ca_release_current_from_JSR_v_gate__v * var_chaste_interface__Ca_release_current_from_JSR_w_gate__w; // dimensionless
        const double var_t824 = var_chaste_interface__intracellular_ion_concentrations__Ca_rel - var_chaste_interface__intracellular_ion_concentrations__Ca_i; // dimensionless
        const double var_t825 = var_t823 * var_t824; // dimensionless
        const double var_t826 = (603000.0 * var_t821) * var_t825; // dimensionless
        const double var_t827 = 3.5113386979999999 * var_t826; // dimensionless
        const double var_t831 = ((var_t164 * var_chaste_interface__L_type_Ca_channel_d_gate__d) * (var_chaste_interface__L_type_Ca_channel_f_gate__f * var_chaste_interface__L_type_Ca_channel_f_Ca_gate__f_Ca)) * var_t204; // dimensionless
        const double var_t833 = var_t154 * var_t147; // dimensionless
        const double var_t837 = 3.7908276239108605 * ((0.5 * var_t831) - (0.20000000000000001 * var_t833)); // dimensionless
        const double var_t839 = exp(((-var_t827) + var_t837) + 250.0); // dimensionless
        const double var_t840 = 1.0 + var_t839; // dimensionless
        const double var_t842 = 1.0 / pow(var_t840, 2.0); // dimensionless
        const double var_t843 = var_t842 * 0.010364122723649996; // dimensionless
        const double var_t863 = var_t842 * 20100.0; // dimensionless
        const double var_t864 = 30.0 * var_chaste_interface__Ca_release_current_from_JSR_u_gate__u; // dimensionless
        const double var_t866 = var_t824 * var_t839; // dimensionless
        const double var_t871 = var_t863 * 30.0; // dimensionless
        const double var_t872 = var_t821 * var_chaste_interface__Ca_release_current_from_JSR_w_gate__w; // dimensionless
        const double var_t876 = var_t821 * var_chaste_interface__Ca_release_current_from_JSR_v_gate__v; // dimensionless
        const double var_t889 = (603000.0 * var_t876) * var_chaste_interface__Ca_release_current_from_JSR_w_gate__w; // dimensionless
        const double var_t891 = 0.010364122723649996 * var_membrane__Cm; // dimensionless
        const double var_t896 = (3.5113386979999999 * var_t889) + ((((73.152889540000004 * var_t891) * 1600.0) * var_t128) * var_t256); // dimensionless
        const double var_t898 = (var_t842 * var_t896) * var_t839; // dimensionless
        const double var_t905 = exp(((-var_t827) + var_t837) + 50.0); // dimensionless
        const double var_t906 = 1.0 + var_t905; // dimensionless
        const double var_t908 = 1.0 / pow(var_t906, 2.0); // dimensionless
        const double var_t909 = var_t908 * 0.010364122723649996; // dimensionless
        const double var_t913 = 1.9099999999999999 + (2.0899999999999999 / var_t840); // dimensionless
        const double var_t914 = 1.0 / var_t913; // dimensionless
        const double var_t922 = ((1.0 - (1.0 / var_t906)) - var_chaste_interface__Ca_release_current_from_JSR_v_gate__v) / pow(var_t913, 2.0); // dimensionless
        const double var_t957 = var_t908 * 20100.0; // dimensionless
        const double var_t959 = var_t824 * var_t905; // dimensionless
        const double var_t966 = var_chaste_interface__Ca_release_current_from_JSR_w_gate__w * var_t824; // dimensionless
        const double var_t967 = var_t966 * var_t839; // dimensionless
        const double var_t978 = var_t922 * var_t863; // dimensionless
        const double var_t979 = 30.0 * var_t821; // dimensionless
        const double var_t986 = var_t905 * var_t914; // dimensionless
        const double var_t1007 = var_t232 * 1.8; // dimensionless
        const double var_t1120 = var_chaste_interface__intracellular_ion_concentrations__Ca_i + 0.00050000000000000001; // dimensionless
        const double var_t1121 = pow(var_t1120, 2.0); // dimensionless
        const double var_t1125 = var_chaste_interface__intracellular_ion_concentrations__Ca_i + 0.0023800000000000002; // dimensionless
        const double var_t1126 = pow(var_t1125, 2.0); // dimensionless
        const double var_t1129 = (1.0 + (3.5000000000000004e-05 / var_t1121)) + (0.00011900000000000002 / var_t1126); // dimensionless
        const double var_t1130 = 1.0 / var_t1129; // dimensionless
        const double var_t1145 = var_t864 * var_chaste_interface__Ca_release_current_from_JSR_v_gate__v; // dimensionless
        const double var_t1146 = var_t966 * var_t1130; // dimensionless
        const double var_t1166 = 1.0 + (0.00092000000000000003 * var_t242); // dimensionless
        const double var_t1168 = 1.0 / pow(var_t1166, 2.0); // dimensionless
        const double var_t1171 = 1.0 / pow(var_chaste_interface__intracellular_ion_concentrations__Ca_i, 2.0); // dimensionless
        const double var_t1273 = var_chaste_interface__intracellular_ion_concentrations__Ca_rel + 0.80000000000000004; // dimensionless
        const double var_t1274 = pow(var_t1273, 2.0); // dimensionless
        const double var_t1277 = 1.0 + (8.0 / var_t1274); // dimensionless
        const double var_t1278 = 1.0 / var_t1277; // dimensionless
        const double var_t1279 = var_t966 * var_t1278; // dimensionless
        
        rJacobian[0][0] = 1.0 - (var_chaste_interface__environment__dt * (((((0.87783467449999997 * var_t863) * var_t864) * var_t823) * var_t866) - 0.125));
        rJacobian[0][1] = -(var_chaste_interface__environment__dt * (((0.43891733719999998 * var_t871) * var_t872) * var_t866));
        rJacobian[0][2] = -(var_chaste_interface__environment__dt * ((( -22.860277979999999 * (var_t843 * var_t164)) * var_t165) * (var_t204 * var_t839)));
        rJacobian[0][3] = -(var_chaste_interface__environment__dt * ( -0.125 * var_t898));
        rJacobian[0][4] = -(var_chaste_interface__environment__dt * ((((0.43891733719999998 * var_t871) * var_t876) * var_chaste_interface__Ca_release_current_from_JSR_w_gate__w) * var_t839));
        rJacobian[0][5] = 0.0;
        rJacobian[0][6] = 0.0;
        rJacobian[0][7] = -(var_chaste_interface__environment__dt * ((((((((27.432333580000002 * var_t843) * var_t111) * var_t117) * var_t119) * 1.8) * 2.9291824377205469e-07) * var_t235) * var_t839));
        rJacobian[1][0] = -(var_chaste_interface__environment__dt * (((((( -7.0226773959999997 * var_t957) * var_t864) * var_t823) * var_t959) * var_t914) - (((((14.67739576 * var_t922) * var_t871) * var_chaste_interface__Ca_release_current_from_JSR_u_gate__u) * var_chaste_interface__Ca_release_current_from_JSR_v_gate__v) * var_t967)));
        rJacobian[1][1] = 1.0 - (var_chaste_interface__environment__dt * ((((((( -3.5113386979999999 * var_t957) * 30.0) * var_t872) * var_t959) - 1.0) * var_t914) - (((7.3386978789999997 * var_t978) * var_t979) * var_t967)));
        rJacobian[1][2] = -(var_chaste_interface__environment__dt * ((((182.88222379999999 * (var_t909 * var_t164)) * var_t165) * ((var_t204 * var_t905) * var_t914)) + ((((382.22384770000002 * ((var_t922 * var_t843) * var_membrane__Cm)) * (0.12375 * var_chaste_interface__L_type_Ca_channel_d_gate__d)) * (var_chaste_interface__L_type_Ca_channel_f_gate__f * var_t204)) * var_t839)));
        rJacobian[1][3] = -(var_chaste_interface__environment__dt * (((var_t908 * var_t896) * var_t986) + ((2.0899999999999999 * var_t922) * var_t898)));
        rJacobian[1][4] = -(var_chaste_interface__environment__dt * (((( -3.5113386979999999 * (var_t957 * var_t979)) * var_t823) * var_t986) - ((((7.3386978789999997 * var_t978) * var_t979) * var_t823) * var_t839)));
        rJacobian[1][5] = 0.0;
        rJacobian[1][6] = 0.0;
        rJacobian[1][7] = -(var_chaste_interface__environment__dt * ((((((((((( -219.45866860000001 * var_t909) * var_membrane__Cm) * 1600.0) * var_t117) * var_t119) * 5.2725283878969849e-07) * 0.31446540880503149) * var_t146) * var_t905) * var_t914) - (((((((458.66861740000002 * (var_t922 * var_t842)) * var_t891) * 1600.0) * var_t1007) * 9.2112655274231051e-08) * var_t146) * var_t839)));
        rJacobian[2][0] = 0.0;
        rJacobian[2][1] = 0.0;
        rJacobian[2][2] = 1.0 - (var_chaste_interface__environment__dt *  -0.5);
        rJacobian[2][3] = -(var_chaste_interface__environment__dt * ( -1428.571428 / pow(1.0 + (2857.1428569999998 * var_chaste_interface__intracellular_ion_concentrations__Ca_i), 2.0)));
        rJacobian[2][4] = 0.0;
        rJacobian[2][5] = 0.0;
        rJacobian[2][6] = 0.0;
        rJacobian[2][7] = 0.0;
        rJacobian[3][0] = -(var_chaste_interface__environment__dt * ((0.01411764706 * var_t1145) * var_t1146));
        rJacobian[3][1] = -(var_chaste_interface__environment__dt * ((0.0070588235280000002 * var_t979) * var_t1146));
        rJacobian[3][2] = -(var_chaste_interface__environment__dt * ((( -0.73529411749999996 * var_t164) * var_t165) * ((var_t204 * 4.9751243781094526e-05) * (0.010364122723649996 * var_t1130))));
        rJacobian[3][3] = 1.0 - (var_chaste_interface__environment__dt * ((((((0.73529411749999996 * (((( -2.0 * ((var_t111 * var_t128) * var_t256)) - (var_t246 * var_t248)) + ((var_t246 * var_chaste_interface__intracellular_ion_concentrations__Ca_i) / pow(var_t247, 2.0))) - ((((0.5 * var_t71) * 8.3142999999999994) * 3.2128780443314988) * var_t242))) * 4.9751243781094526e-05) * 0.010364122723649996) + ((1.4705882349999999 * (((( -5.5476000000000001 * var_t1168) * 0.00092000000000000003) * var_t1171) - (0.0047999999999999996 * var_t889))) * 4.9751243781094526e-05)) * var_t1130) - (((2.0 * ((((0.73529411749999996 * ((((2.0 * var_t833) - ((var_t246 * var_chaste_interface__intracellular_ion_concentrations__Ca_i) * var_t248)) - var_t831) - (var_t71 * (var_chaste_interface__membrane__V - (13.35641596199269 * log(1.8 * var_t242)))))) * 4.9751243781094526e-05) * 0.010364122723649996) + ((1.4705882349999999 * ((1109.52 * (((0.0050000000000000001 * var_chaste_interface__intracellular_ion_concentrations__Ca_up) * 0.066666666666666666) - (0.0050000000000000001 / var_t1166))) + (0.0047999999999999996 * var_t826))) * 4.9751243781094526e-05))) / pow(var_t1129, 2.0)) * ((( -3.5000000000000004e-05 / var_t1121) / var_t1120) - ((0.00011900000000000002 / var_t1126) / var_t1125)))));
        rJacobian[3][4] = -(var_chaste_interface__environment__dt * (((0.0070588235280000002 * var_t979) * var_t823) * var_t1130));
        rJacobian[3][5] = -(var_chaste_interface__environment__dt * (2.7058823523333335e-05 * var_t1130));
        rJacobian[3][6] = 0.0;
        rJacobian[3][7] = -(var_chaste_interface__environment__dt * (((((4.4117647050000004 * var_t111) * var_t1007) * var_t147) * 5.1562799620149231e-07) * var_t1130));
        rJacobian[4][0] = -(var_chaste_interface__environment__dt * (( -2.0 * var_t1145) * var_t1279));
        rJacobian[4][1] = -(var_chaste_interface__environment__dt * ((-var_t979) * var_t1279));
        rJacobian[4][2] = 0.0;
        rJacobian[4][3] = -(var_chaste_interface__environment__dt * ((var_t979 * var_t823) * var_t1278));
        rJacobian[4][4] = 1.0 - (var_chaste_interface__environment__dt * ((( -0.0055555555555555558 - (var_t979 * var_t823)) * var_t1278) + (((((2.0 * (((var_chaste_interface__intracellular_ion_concentrations__Ca_up - var_chaste_interface__intracellular_ion_concentrations__Ca_rel) * 0.0055555555555555558) - (var_t979 * var_t825))) / pow(var_t1277, 2.0)) * 8.0) / var_t1274) / var_t1273)));
        rJacobian[4][5] = -(var_chaste_interface__environment__dt * (0.0055555555555555558 * var_t1278));
        rJacobian[4][6] = 0.0;
        rJacobian[4][7] = 0.0;
        rJacobian[5][0] = 0.0;
        rJacobian[5][1] = 0.0;
        rJacobian[5][2] = 0.0;
        rJacobian[5][3] = -(var_chaste_interface__environment__dt * (((0.0050000000000000001 * var_t1168) * 0.00092000000000000003) * var_t1171));
        rJacobian[5][4] = -(var_chaste_interface__environment__dt * 0.00048309178744444445);
        rJacobian[5][5] = 1.0 - (var_chaste_interface__environment__dt *  -0.00081642512077777772);
        rJacobian[5][6] = 0.0;
        rJacobian[5][7] = 0.0;
        rJacobian[6][0] = 0.0;
        rJacobian[6][1] = 0.0;
        rJacobian[6][2] = 0.0;
        rJacobian[6][3] = 0.0;
        rJacobian[6][4] = 0.0;
        rJacobian[6][5] = 0.0;
        rJacobian[6][6] = 1.0 - (var_chaste_interface__environment__dt * (((1.4705882349999999 * ((((((-((((var_t7 * 8.3142999999999994) * 3.2128780443314988) * var_t16) * var_t12)) - (var_t32 * var_t265)) - (var_t51 * var_t265)) - (((((var_t52 * var_chaste_interface__rapid_delayed_rectifier_K_current_xr_gate__xr) * 8.3142999999999994) * 3.2128780443314988) * var_t16) * var_t57)) - (var_t69 * var_t265)) - ((((var_membrane__Cm * 0.0) * 8.3142999999999994) * 3.2128780443314988) * var_t16))) * 4.9751243781094526e-05) * 0.010364122723649996));
        rJacobian[6][7] = -(var_chaste_interface__environment__dt * (((((((((4.4117647050000004 * var_t72) * var_t222) * 5.4000000000000004) * 0.14492753623188406) * var_t225) * 10.0) * var_t227) * 4.9751243781094526e-05) * 0.010364122723649996));
        rJacobian[7][0] = 0.0;
        rJacobian[7][1] = 0.0;
        rJacobian[7][2] = 0.0;
        rJacobian[7][3] = -(var_chaste_interface__environment__dt * ((((((4.4117647050000004 * var_t111) * var_t151) * 9.2112655274231051e-08) * var_t146) * 4.9751243781094526e-05) * 0.010364122723649996));
        rJacobian[7][4] = 0.0;
        rJacobian[7][5] = 0.0;
        rJacobian[7][6] = 0.0;
        rJacobian[7][7] = 1.0 - (var_chaste_interface__environment__dt * (((1.4705882349999999 * (((( -4.5 * ((((((var_t72 * var_t222) * 5.4000000000000004) * 0.14492753623188406) * var_t225) * 10.0) * var_t227)) - (9.0 * (((var_t111 * var_t232) * 5.2725283878969849e-07) * var_t235))) - ((var_t70 * 8.3142999999999994) * var_t214)) - ((((var_t1 * var_t4) * var_chaste_interface__fast_sodium_current_j_gate__j) * 8.3142999999999994) * var_t214))) * 4.9751243781094526e-05) * 0.010364122723649996));
    }
    
    void Dynamiccourtemanche_ramirez_nattel_model_1998FromCellMLBackwardEuler::UpdateTransmembranePotential(double var_chaste_interface__environment__time)
    {
        // Time units: millisecond
        std::vector<double>& rY = rGetStateVariables();
        double var_chaste_interface__membrane__V = (mSetVoltageDerivativeToZero ? this->mFixedVoltage : rY[0]);
        // Units: millivolt; Initial value: -81.18
        double var_chaste_interface__fast_sodium_current_m_gate__m = rY[1];
        // Units: dimensionless; Initial value: 2.908e-3
        double var_chaste_interface__fast_sodium_current_h_gate__h = rY[2];
        // Units: dimensionless; Initial value: 9.649e-1
        double var_chaste_interface__fast_sodium_current_j_gate__j = rY[3];
        // Units: dimensionless; Initial value: 9.775e-1
        double var_chaste_interface__transient_outward_K_current_oa_gate__oa = rY[4];
        // Units: dimensionless; Initial value: 3.043e-2
        double var_chaste_interface__transient_outward_K_current_oi_gate__oi = rY[5];
        // Units: dimensionless; Initial value: 9.992e-1
        double var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ua_gate__ua = rY[6];
        // Units: dimensionless; Initial value: 4.966e-3
        double var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ui_gate__ui = rY[7];
        // Units: dimensionless; Initial value: 9.986e-1
        double var_chaste_interface__rapid_delayed_rectifier_K_current_xr_gate__xr = rY[8];
        // Units: dimensionless; Initial value: 3.296e-5
        double var_chaste_interface__slow_delayed_rectifier_K_current_xs_gate__xs = rY[9];
        // Units: dimensionless; Initial value: 1.869e-2
        double var_chaste_interface__L_type_Ca_channel_d_gate__d = rY[10];
        // Units: dimensionless; Initial value: 1.367e-4
        double var_chaste_interface__L_type_Ca_channel_f_gate__f = rY[11];
        // Units: dimensionless; Initial value: 9.996e-1
        double var_chaste_interface__L_type_Ca_channel_f_Ca_gate__f_Ca = rY[12];
        // Units: dimensionless; Initial value: 7.755e-1
        double var_chaste_interface__intracellular_ion_concentrations__Na_i = rY[16];
        // Units: millimolar; Initial value: 1.117e+01
        double var_chaste_interface__intracellular_ion_concentrations__Ca_i = rY[17];
        // Units: millimolar; Initial value: 1.013e-4
        double var_chaste_interface__intracellular_ion_concentrations__K_i = rY[18];
        // Units: millimolar; Initial value: 1.39e+02
        
        const double var_membrane__Cm = 100.0; // picoF
        const double var_chaste_interface__membrane__i_st = GetIntracellularAreaStimulus(var_chaste_interface__environment__time);
        const double var_fast_sodium_current__E_Na = 26.71283192398538 * log(140.0 / var_chaste_interface__intracellular_ion_concentrations__Na_i); // millivolt
        const double var_fast_sodium_current__i_Na = var_membrane__Cm * 7.7999999999999998 * pow(var_chaste_interface__fast_sodium_current_m_gate__m, 3.0) * var_chaste_interface__fast_sodium_current_h_gate__h * var_chaste_interface__fast_sodium_current_j_gate__j * (var_chaste_interface__membrane__V - var_fast_sodium_current__E_Na); // picoA
        const double var_time_independent_potassium_current__E_K = 26.71283192398538 * log(5.4000000000000004 / var_chaste_interface__intracellular_ion_concentrations__K_i); // millivolt
        const double var_time_independent_potassium_current__i_K1 = (var_membrane__Cm * 0.089999999999999997 * (var_chaste_interface__membrane__V - var_time_independent_potassium_current__E_K)) / (1.0 + exp(0.070000000000000007 * (var_chaste_interface__membrane__V + 80.0))); // picoA
        const double var_transient_outward_K_current__i_to = var_membrane__Cm * 0.16520000000000001 * pow(var_chaste_interface__transient_outward_K_current_oa_gate__oa, 3.0) * var_chaste_interface__transient_outward_K_current_oi_gate__oi * (var_chaste_interface__membrane__V - var_time_independent_potassium_current__E_K); // picoA
        const double var_ultrarapid_delayed_rectifier_K_current__i_Kur = var_membrane__Cm * (0.0050000000000000001 + (0.050000000000000003 / (1.0 + exp((var_chaste_interface__membrane__V - 15.0) *  -0.076923076923076927)))) * pow(var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ua_gate__ua, 3.0) * var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ui_gate__ui * (var_chaste_interface__membrane__V - var_time_independent_potassium_current__E_K); // picoA
        const double var_rapid_delayed_rectifier_K_current__i_Kr = (var_membrane__Cm * 0.029411764999999999 * var_chaste_interface__rapid_delayed_rectifier_K_current_xr_gate__xr * (var_chaste_interface__membrane__V - var_time_independent_potassium_current__E_K)) / (1.0 + exp((var_chaste_interface__membrane__V + 15.0) * 0.044642857142857144)); // picoA
        const double var_slow_delayed_rectifier_K_current__i_Ks = var_membrane__Cm * 0.12941175999999999 * pow(var_chaste_interface__slow_delayed_rectifier_K_current_xs_gate__xs, 2.0) * (var_chaste_interface__membrane__V - var_time_independent_potassium_current__E_K); // picoA
        const double var_L_type_Ca_channel__i_Ca_L = var_membrane__Cm * 0.12375 * var_chaste_interface__L_type_Ca_channel_d_gate__d * var_chaste_interface__L_type_Ca_channel_f_gate__f * var_chaste_interface__L_type_Ca_channel_f_Ca_gate__f_Ca * (var_chaste_interface__membrane__V - 65.0); // picoA
        const double var_sarcolemmal_calcium_pump_current__i_CaP = (var_membrane__Cm * 0.27500000000000002 * var_chaste_interface__intracellular_ion_concentrations__Ca_i) / (0.00050000000000000001 + var_chaste_interface__intracellular_ion_concentrations__Ca_i); // picoA
        const double var_sodium_potassium_pump__i_NaK = (((var_membrane__Cm * pow(1.0 + (0.1245 * exp((var_chaste_interface__membrane__V *  -9.648670000000001) * 0.0003879829271992715)) + (exp(( -96.486699999999999 * var_chaste_interface__membrane__V) * 0.0003879829271992715) * 0.036533226130519084),  -1.0) * 0.59933873999999998) / (1.0 + pow(10.0 / var_chaste_interface__intracellular_ion_concentrations__Na_i, 1.5))) * 5.4000000000000004) * 0.14492753623188406; // picoA
        const double var_Na_Ca_exchanger_current__i_NaCa = (var_membrane__Cm * 1600.0 * ((exp((var_chaste_interface__membrane__V * 33.770344999999999) * 0.0003879829271992715) * pow(var_chaste_interface__intracellular_ion_concentrations__Na_i, 3.0) * 1.8) - (exp((var_chaste_interface__membrane__V *  -62.716355) * 0.0003879829271992715) * 2744000.0 * var_chaste_interface__intracellular_ion_concentrations__Ca_i))) / ((1.0 + (0.10000000000000001 * exp((var_chaste_interface__membrane__V *  -62.716355) * 0.0003879829271992715))) * 10856271.562499998); // picoA
        const double var_background_currents__i_B_Na = var_membrane__Cm * 0.00067443750000000002 * (var_chaste_interface__membrane__V - var_fast_sodium_current__E_Na); // picoA
        const double var_background_currents__i_B_Ca = var_membrane__Cm * 0.0011310000000000001 * (var_chaste_interface__membrane__V - (13.35641596199269 * log(1.8 / var_chaste_interface__intracellular_ion_concentrations__Ca_i))); // picoA
        const double d_dt_chaste_interface__membrane__V = (-(var_fast_sodium_current__i_Na + var_time_independent_potassium_current__i_K1 + var_transient_outward_K_current__i_to + var_ultrarapid_delayed_rectifier_K_current__i_Kur + var_rapid_delayed_rectifier_K_current__i_Kr + var_slow_delayed_rectifier_K_current__i_Ks + var_background_currents__i_B_Na + var_background_currents__i_B_Ca + var_sodium_potassium_pump__i_NaK + var_sarcolemmal_calcium_pump_current__i_CaP + var_Na_Ca_exchanger_current__i_NaCa + var_L_type_Ca_channel__i_Ca_L + ((var_chaste_interface__membrane__i_st * var_membrane__Cm) / HeartConfig::Instance()->GetCapacitance()))) / var_membrane__Cm; // 'millivolt per millisecond'
        
        rY[0] += mDt*d_dt_chaste_interface__membrane__V;
    }
    
    void Dynamiccourtemanche_ramirez_nattel_model_1998FromCellMLBackwardEuler::ComputeOneStepExceptVoltage(double var_chaste_interface__environment__time)
    {
        // Time units: millisecond
        std::vector<double>& rY = rGetStateVariables();
        double var_chaste_interface__membrane__V = (mSetVoltageDerivativeToZero ? this->mFixedVoltage : rY[0]);
        // Units: millivolt; Initial value: -81.18
        double var_chaste_interface__fast_sodium_current_m_gate__m = rY[1];
        // Units: dimensionless; Initial value: 2.908e-3
        double var_chaste_interface__fast_sodium_current_h_gate__h = rY[2];
        // Units: dimensionless; Initial value: 9.649e-1
        double var_chaste_interface__fast_sodium_current_j_gate__j = rY[3];
        // Units: dimensionless; Initial value: 9.775e-1
        double var_chaste_interface__transient_outward_K_current_oa_gate__oa = rY[4];
        // Units: dimensionless; Initial value: 3.043e-2
        double var_chaste_interface__transient_outward_K_current_oi_gate__oi = rY[5];
        // Units: dimensionless; Initial value: 9.992e-1
        double var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ua_gate__ua = rY[6];
        // Units: dimensionless; Initial value: 4.966e-3
        double var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ui_gate__ui = rY[7];
        // Units: dimensionless; Initial value: 9.986e-1
        double var_chaste_interface__rapid_delayed_rectifier_K_current_xr_gate__xr = rY[8];
        // Units: dimensionless; Initial value: 3.296e-5
        double var_chaste_interface__slow_delayed_rectifier_K_current_xs_gate__xs = rY[9];
        // Units: dimensionless; Initial value: 1.869e-2
        double var_chaste_interface__L_type_Ca_channel_d_gate__d = rY[10];
        // Units: dimensionless; Initial value: 1.367e-4
        double var_chaste_interface__L_type_Ca_channel_f_gate__f = rY[11];
        // Units: dimensionless; Initial value: 9.996e-1
        double var_chaste_interface__Ca_release_current_from_JSR_w_gate__w = rY[15];
        // Units: dimensionless; Initial value: 0.9992
        
        const double var_chaste_interface__environment__dt = mDt;

        const double var_fast_sodium_current_m_gate__alpha_m = (var_chaste_interface__membrane__V ==  -47.130000000000003) ? 3.2000000000000002 : ((0.32000000000000001 * (var_chaste_interface__membrane__V + 47.130000000000003)) / (1.0 - exp( -0.10000000000000001 * (var_chaste_interface__membrane__V + 47.130000000000003)))); // per_millisecond
        const double var_fast_sodium_current_m_gate__beta_m = 0.080000000000000002 * exp((-var_chaste_interface__membrane__V) * 0.090909090909090912); // per_millisecond
        const double var_fast_sodium_current_m_gate__tau_m = 1.0 / (var_fast_sodium_current_m_gate__alpha_m + var_fast_sodium_current_m_gate__beta_m); // millisecond
        const double var_fast_sodium_current_h_gate__beta_h = (var_chaste_interface__membrane__V <  -40.0) ? ((3.5600000000000001 * exp(0.079000000000000001 * var_chaste_interface__membrane__V)) + (310000.0 * exp(0.34999999999999998 * var_chaste_interface__membrane__V))) : (1.0 / (0.13 * (1.0 + exp((var_chaste_interface__membrane__V + 10.66) *  -0.0900900900900901)))); // per_millisecond
        const double var_fast_sodium_current_h_gate__alpha_h = (var_chaste_interface__membrane__V <  -40.0) ? (0.13500000000000001 * exp((var_chaste_interface__membrane__V + 80.0) *  -0.14705882352941177)) : 0.0; // per_millisecond
        const double var_fast_sodium_current_h_gate__tau_h = 1.0 / (var_fast_sodium_current_h_gate__alpha_h + var_fast_sodium_current_h_gate__beta_h); // millisecond
        const double var_fast_sodium_current_j_gate__alpha_j = (var_chaste_interface__membrane__V <  -40.0) ? (((( -127140.0 * exp(0.24440000000000001 * var_chaste_interface__membrane__V)) - (3.4740000000000003e-05 * exp( -0.043909999999999998 * var_chaste_interface__membrane__V))) * (var_chaste_interface__membrane__V + 37.780000000000001)) / (1.0 + exp(0.311 * (var_chaste_interface__membrane__V + 79.230000000000004)))) : 0.0; // per_millisecond
        const double var_fast_sodium_current_j_gate__beta_j = (var_chaste_interface__membrane__V <  -40.0) ? ((0.1212 * exp( -0.01052 * var_chaste_interface__membrane__V)) / (1.0 + exp( -0.13780000000000001 * (var_chaste_interface__membrane__V + 40.140000000000001)))) : ((0.29999999999999999 * exp( -2.5349999999999999e-07 * var_chaste_interface__membrane__V)) / (1.0 + exp( -0.10000000000000001 * (var_chaste_interface__membrane__V + 32.0)))); // per_millisecond
        const double var_fast_sodium_current_j_gate__tau_j = 1.0 / (var_fast_sodium_current_j_gate__alpha_j + var_fast_sodium_current_j_gate__beta_j); // millisecond
        const double var_transient_outward_K_current_oa_gate__tau_oa = pow((0.65000000000000002 * pow(exp((var_chaste_interface__membrane__V -  -10.0) *  -0.11764705882352941) + exp(((var_chaste_interface__membrane__V -  -10.0) - 40.0) *  -0.016949152542372881),  -1.0)) + (0.65000000000000002 * pow(2.5 + exp(((var_chaste_interface__membrane__V -  -10.0) + 72.0) * 0.058823529411764705),  -1.0)),  -1.0) * 0.33333333333333331; // millisecond
        const double var_transient_outward_K_current_oi_gate__tau_oi = pow(pow(18.530000000000001 + (1.0 * exp(((var_chaste_interface__membrane__V -  -10.0) + 103.7) * 0.091324200913242018)),  -1.0) + pow(35.560000000000002 + (1.0 * exp(((var_chaste_interface__membrane__V -  -10.0) - 8.7400000000000002) *  -0.13440860215053763)),  -1.0),  -1.0) * 0.33333333333333331; // millisecond
        const double var_ultrarapid_delayed_rectifier_K_current_ua_gate__tau_ua = pow((0.65000000000000002 * pow(exp((var_chaste_interface__membrane__V -  -10.0) *  -0.11764705882352941) + exp(((var_chaste_interface__membrane__V -  -10.0) - 40.0) *  -0.016949152542372881),  -1.0)) + (0.65000000000000002 * pow(2.5 + exp(((var_chaste_interface__membrane__V -  -10.0) + 72.0) * 0.058823529411764705),  -1.0)),  -1.0) * 0.33333333333333331; // millisecond
        const double var_ultrarapid_delayed_rectifier_K_current_ui_gate__tau_ui = pow(pow(21.0 + (1.0 * exp(((var_chaste_interface__membrane__V -  -10.0) - 195.0) *  -0.035714285714285712)),  -1.0) + (1.0 / exp(((var_chaste_interface__membrane__V -  -10.0) - 168.0) *  -0.0625)),  -1.0) * 0.33333333333333331; // millisecond
        const double var_rapid_delayed_rectifier_K_current_xr_gate__tau_xr = pow(((fabs(var_chaste_interface__membrane__V + 14.1) < 1e-10) ? 0.0015 : ((0.00029999999999999997 * (var_chaste_interface__membrane__V + 14.1)) / (1.0 - exp((var_chaste_interface__membrane__V + 14.1) *  -0.20000000000000001)))) + ((fabs(var_chaste_interface__membrane__V - 3.3328000000000002) < 1e-10) ? 0.00037836118 : ((7.3898000000000003e-05 * (var_chaste_interface__membrane__V - 3.3328000000000002)) / (exp((var_chaste_interface__membrane__V - 3.3328000000000002) * 0.19517145812596365) - 1.0))),  -1.0); // millisecond
        const double var_slow_delayed_rectifier_K_current_xs_gate__tau_xs = 0.5 * pow(((fabs(var_chaste_interface__membrane__V - 19.899999999999999) < 1e-10) ? 0.00068000000000000005 : ((4.0000000000000003e-05 * (var_chaste_interface__membrane__V - 19.899999999999999)) / (1.0 - exp((var_chaste_interface__membrane__V - 19.899999999999999) *  -0.058823529411764705)))) + ((fabs(var_chaste_interface__membrane__V - 19.899999999999999) < 1e-10) ? 0.00031500000000000001 : ((3.4999999999999997e-05 * (var_chaste_interface__membrane__V - 19.899999999999999)) / (exp((var_chaste_interface__membrane__V - 19.899999999999999) * 0.1111111111111111) - 1.0))),  -1.0); // millisecond
        const double var_L_type_Ca_channel_d_gate__tau_d = (fabs(var_chaste_interface__membrane__V + 10.0) < 1e-10) ? (4.5789999999999997 / (1.0 + exp((var_chaste_interface__membrane__V + 10.0) *  -0.16025641025641024))) : ((1.0 - exp((var_chaste_interface__membrane__V + 10.0) *  -0.16025641025641024)) / (0.035000000000000003 * (var_chaste_interface__membrane__V + 10.0) * (1.0 + exp((var_chaste_interface__membrane__V + 10.0) *  -0.16025641025641024)))); // millisecond
        const double var_L_type_Ca_channel_f_gate__tau_f = 9.0 * pow((0.019699999999999999 * exp( -0.00113569 * pow(var_chaste_interface__membrane__V + 10.0, 2.0))) + 0.02,  -1.0); // millisecond
        const double var_Ca_release_current_from_JSR_w_gate__tau_w = (fabs(var_chaste_interface__membrane__V - 7.9000000000000004) < 1e-10) ? 0.92307692307692313 : ((6.0 * (1.0 - exp((-(var_chaste_interface__membrane__V - 7.9000000000000004)) * 0.20000000000000001))) / ((1.0 + (0.29999999999999999 * exp((-(var_chaste_interface__membrane__V - 7.9000000000000004)) * 0.20000000000000001))) * 1.0 * (var_chaste_interface__membrane__V - 7.9000000000000004))); // millisecond
        
        rY[15] = (var_chaste_interface__Ca_release_current_from_JSR_w_gate__w + (((1.0 - pow(1.0 + exp((-(var_chaste_interface__membrane__V - 40.0)) * 0.058823529411764705),  -1.0)) / var_Ca_release_current_from_JSR_w_gate__tau_w) * var_chaste_interface__environment__dt)) / (1.0 - (( -1.0 / var_Ca_release_current_from_JSR_w_gate__tau_w) * var_chaste_interface__environment__dt));
        rY[10] = (var_chaste_interface__L_type_Ca_channel_d_gate__d + ((pow(1.0 + exp((var_chaste_interface__membrane__V + 10.0) *  -0.125),  -1.0) / var_L_type_Ca_channel_d_gate__tau_d) * var_chaste_interface__environment__dt)) / (1.0 - (( -1.0 / var_L_type_Ca_channel_d_gate__tau_d) * var_chaste_interface__environment__dt));
        rY[11] = (var_chaste_interface__L_type_Ca_channel_f_gate__f + (((exp((-(var_chaste_interface__membrane__V + 28.0)) * 0.14492753623188406) / (1.0 + exp((-(var_chaste_interface__membrane__V + 28.0)) * 0.14492753623188406))) / var_L_type_Ca_channel_f_gate__tau_f) * var_chaste_interface__environment__dt)) / (1.0 - (( -1.0 / var_L_type_Ca_channel_f_gate__tau_f) * var_chaste_interface__environment__dt));
        rY[2] = (var_chaste_interface__fast_sodium_current_h_gate__h + (((var_fast_sodium_current_h_gate__alpha_h / (var_fast_sodium_current_h_gate__alpha_h + var_fast_sodium_current_h_gate__beta_h)) / var_fast_sodium_current_h_gate__tau_h) * var_chaste_interface__environment__dt)) / (1.0 - (( -1.0 / var_fast_sodium_current_h_gate__tau_h) * var_chaste_interface__environment__dt));
        rY[3] = (var_chaste_interface__fast_sodium_current_j_gate__j + (((var_fast_sodium_current_j_gate__alpha_j / (var_fast_sodium_current_j_gate__alpha_j + var_fast_sodium_current_j_gate__beta_j)) / var_fast_sodium_current_j_gate__tau_j) * var_chaste_interface__environment__dt)) / (1.0 - (( -1.0 / var_fast_sodium_current_j_gate__tau_j) * var_chaste_interface__environment__dt));
        rY[1] = (var_chaste_interface__fast_sodium_current_m_gate__m + (((var_fast_sodium_current_m_gate__alpha_m / (var_fast_sodium_current_m_gate__alpha_m + var_fast_sodium_current_m_gate__beta_m)) / var_fast_sodium_current_m_gate__tau_m) * var_chaste_interface__environment__dt)) / (1.0 - (( -1.0 / var_fast_sodium_current_m_gate__tau_m) * var_chaste_interface__environment__dt));
        rY[8] = (var_chaste_interface__rapid_delayed_rectifier_K_current_xr_gate__xr + ((pow(1.0 + exp((var_chaste_interface__membrane__V + 14.1) *  -0.15384615384615385),  -1.0) / var_rapid_delayed_rectifier_K_current_xr_gate__tau_xr) * var_chaste_interface__environment__dt)) / (1.0 - (( -1.0 / var_rapid_delayed_rectifier_K_current_xr_gate__tau_xr) * var_chaste_interface__environment__dt));
        rY[9] = (var_chaste_interface__slow_delayed_rectifier_K_current_xs_gate__xs + ((pow(1.0 + exp((var_chaste_interface__membrane__V - 19.899999999999999) *  -0.07874015748031496),  -0.5) / var_slow_delayed_rectifier_K_current_xs_gate__tau_xs) * var_chaste_interface__environment__dt)) / (1.0 - (( -1.0 / var_slow_delayed_rectifier_K_current_xs_gate__tau_xs) * var_chaste_interface__environment__dt));
        rY[4] = (var_chaste_interface__transient_outward_K_current_oa_gate__oa + ((pow(1.0 + exp(((var_chaste_interface__membrane__V -  -10.0) + 10.470000000000001) *  -0.057012542759407071),  -1.0) / var_transient_outward_K_current_oa_gate__tau_oa) * var_chaste_interface__environment__dt)) / (1.0 - (( -1.0 / var_transient_outward_K_current_oa_gate__tau_oa) * var_chaste_interface__environment__dt));
        rY[5] = (var_chaste_interface__transient_outward_K_current_oi_gate__oi + ((pow(1.0 + exp(((var_chaste_interface__membrane__V -  -10.0) + 33.100000000000001) * 0.18867924528301888),  -1.0) / var_transient_outward_K_current_oi_gate__tau_oi) * var_chaste_interface__environment__dt)) / (1.0 - (( -1.0 / var_transient_outward_K_current_oi_gate__tau_oi) * var_chaste_interface__environment__dt));
        rY[6] = (var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ua_gate__ua + ((pow(1.0 + exp(((var_chaste_interface__membrane__V -  -10.0) + 20.300000000000001) *  -0.10416666666666667),  -1.0) / var_ultrarapid_delayed_rectifier_K_current_ua_gate__tau_ua) * var_chaste_interface__environment__dt)) / (1.0 - (( -1.0 / var_ultrarapid_delayed_rectifier_K_current_ua_gate__tau_ua) * var_chaste_interface__environment__dt));
        rY[7] = (var_chaste_interface__ultrarapid_delayed_rectifier_K_current_ui_gate__ui + ((pow(1.0 + exp(((var_chaste_interface__membrane__V -  -10.0) - 109.45) * 0.036390101892285295),  -1.0) / var_ultrarapid_delayed_rectifier_K_current_ui_gate__tau_ui) * var_chaste_interface__environment__dt)) / (1.0 - (( -1.0 / var_ultrarapid_delayed_rectifier_K_current_ui_gate__tau_ui) * var_chaste_interface__environment__dt));
        
        double _guess[8] = {rY[13],rY[14],rY[12],rY[17],rY[19],rY[20],rY[18],rY[16]};
        CardiacNewtonSolver<8,Dynamiccourtemanche_ramirez_nattel_model_1998FromCellMLBackwardEuler>* _p_solver = CardiacNewtonSolver<8,Dynamiccourtemanche_ramirez_nattel_model_1998FromCellMLBackwardEuler>::Instance();
        _p_solver->Solve(*this, var_chaste_interface__environment__time, _guess);
        rY[13] = _guess[0];
        rY[14] = _guess[1];
        rY[12] = _guess[2];
        rY[17] = _guess[3];
        rY[19] = _guess[4];
        rY[20] = _guess[5];
        rY[18] = _guess[6];
        rY[16] = _guess[7];
    }
    
template<>
void OdeSystemInformation<Dynamiccourtemanche_ramirez_nattel_model_1998FromCellMLBackwardEuler>::Initialise(void)
{
    this->mSystemName = "courtemanche_ramirez_nattel_model_1998";
    this->mFreeVariableName = "environment__time";
    this->mFreeVariableUnits = "millisecond";
    
    // rY[0]:
    this->mVariableNames.push_back("membrane_voltage");
    this->mVariableUnits.push_back("millivolt");
    this->mInitialConditions.push_back(-81.18);

    // rY[1]:
    this->mVariableNames.push_back("fast_sodium_current_m_gate__m");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(2.908e-3);

    // rY[2]:
    this->mVariableNames.push_back("fast_sodium_current_h_gate__h");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(9.649e-1);

    // rY[3]:
    this->mVariableNames.push_back("fast_sodium_current_j_gate__j");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(9.775e-1);

    // rY[4]:
    this->mVariableNames.push_back("transient_outward_K_current_oa_gate__oa");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(3.043e-2);

    // rY[5]:
    this->mVariableNames.push_back("transient_outward_K_current_oi_gate__oi");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(9.992e-1);

    // rY[6]:
    this->mVariableNames.push_back("ultrarapid_delayed_rectifier_K_current_ua_gate__ua");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(4.966e-3);

    // rY[7]:
    this->mVariableNames.push_back("ultrarapid_delayed_rectifier_K_current_ui_gate__ui");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(9.986e-1);

    // rY[8]:
    this->mVariableNames.push_back("rapid_delayed_rectifier_K_current_xr_gate__xr");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(3.296e-5);

    // rY[9]:
    this->mVariableNames.push_back("slow_delayed_rectifier_K_current_xs_gate__xs");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(1.869e-2);

    // rY[10]:
    this->mVariableNames.push_back("L_type_Ca_channel_d_gate__d");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(1.367e-4);

    // rY[11]:
    this->mVariableNames.push_back("L_type_Ca_channel_f_gate__f");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(9.996e-1);

    // rY[12]:
    this->mVariableNames.push_back("L_type_Ca_channel_f_Ca_gate__f_Ca");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(7.755e-1);

    // rY[13]:
    this->mVariableNames.push_back("Ca_release_current_from_JSR_u_gate__u");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(2.35e-112);

    // rY[14]:
    this->mVariableNames.push_back("Ca_release_current_from_JSR_v_gate__v");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(1);

    // rY[15]:
    this->mVariableNames.push_back("Ca_release_current_from_JSR_w_gate__w");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.9992);

    // rY[16]:
    this->mVariableNames.push_back("intracellular_ion_concentrations__Na_i");
    this->mVariableUnits.push_back("millimolar");
    this->mInitialConditions.push_back(1.117e+01);

    // rY[17]:
    this->mVariableNames.push_back("intracellular_ion_concentrations__Ca_i");
    this->mVariableUnits.push_back("millimolar");
    this->mInitialConditions.push_back(1.013e-4);

    // rY[18]:
    this->mVariableNames.push_back("intracellular_ion_concentrations__K_i");
    this->mVariableUnits.push_back("millimolar");
    this->mInitialConditions.push_back(1.39e+02);

    // rY[19]:
    this->mVariableNames.push_back("intracellular_ion_concentrations__Ca_rel");
    this->mVariableUnits.push_back("millimolar");
    this->mInitialConditions.push_back(1.488);

    // rY[20]:
    this->mVariableNames.push_back("intracellular_ion_concentrations__Ca_up");
    this->mVariableUnits.push_back("millimolar");
    this->mInitialConditions.push_back(1.488);

    this->mInitialised = true;
}


// Serialization for Boost >= 1.36
#include "SerializationExportWrapperForCpp.hpp"
CHASTE_CLASS_EXPORT(Dynamiccourtemanche_ramirez_nattel_model_1998FromCellMLBackwardEuler)
extern "C"
{
    AbstractCardiacCellInterface* MakeCardiacCell(
            boost::shared_ptr<AbstractIvpOdeSolver> pSolver,
            boost::shared_ptr<AbstractStimulusFunction> pStimulus)
    {
        return new Dynamiccourtemanche_ramirez_nattel_model_1998FromCellMLBackwardEuler(pSolver, pStimulus);
    }
    
}

