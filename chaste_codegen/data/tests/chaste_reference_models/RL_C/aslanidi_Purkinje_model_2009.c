//===========================================================================
// This source file was generated from CellML by chaste_codegen version (version omitted as unimportant)
//
// Model: aslanidi_2009
//
// Processed by chaste_codegen: https://github.com/ModellingWebLab/chaste-codegen
//     (translator: chaste_codegen, model type: RushLarsenC)
// on (date omitted as unimportant)
//
// <autogenerated>
//===========================================================================


#include "aslanidi_Purkinje_model_2009.h"

//------------------------------------------------------------------------------

#include <math.h>
#include <string.h>

//------------------------------------------------------------------------------
// State variables
//------------------------------------------------------------------------------

double Y[_NB_OF_STATE_VARIABLES_];
double dY[_NB_OF_STATE_VARIABLES_];
// 0: V (units: millivolt, initial value: -83.43812846286808, component: membrane)
// 1: Ca_i (units: millimolar, initial value: 0.00022355433459434943, component: Ca_i)
// 2: m (units: dimensionless, initial value: 0.002003390432234504, component: i_Na_m_gate)
// 3: h (units: dimensionless, initial value: 0.9786390933308567, component: i_Na_h_gate)
// 4: j (units: dimensionless, initial value: 0.09866447258167589, component: i_Na_j_gate)
// 5: m_L (units: dimensionless, initial value: 0.002003390432234504, component: i_Na_L_m_L_gate)
// 6: h_L (units: dimensionless, initial value: 0.8946968372659203, component: i_Na_L_h_L_gate)
// 7: d (units: dimensionless, initial value: 2.322223865147363e-06, component: i_Ca_L_d_gate)
// 8: f (units: dimensionless, initial value: 0.9985607329462358, component: i_Ca_L_f_gate)
// 9: f2 (units: dimensionless, initial value: 0.8173435436674658, component: i_Ca_L_f2_gate)
// 10: f_Ca (units: dimensionless, initial value: 0.9610551285529658, component: i_Ca_L_f_Ca_gate)
// 11: f_Ca2 (units: dimensionless, initial value: 0.868690796671854, component: i_Ca_L_f_Ca2_gate)
// 12: b (units: dimensionless, initial value: 0.0002563937630984438, component: i_Ca_T_b_gate)
// 13: g (units: dimensionless, initial value: 0.9720432601848331, component: i_Ca_T_g_gate)
// 14: a (units: dimensionless, initial value: 0.0004238729429342389, component: i_to_1_a_gate)
// 15: i (units: dimensionless, initial value: 0.9990935802459496, component: i_to_1_i_gate)
// 16: i2 (units: dimensionless, initial value: 0.9777368439681764, component: i_to_1_i2_gate)
// 17: xr (units: dimensionless, initial value: 0.07084939408222911, component: i_Kr_xr_gate)
// 18: xs1 (units: dimensionless, initial value: 0.0011737654433043125, component: i_Ks_xs1_gate)
// 19: xs2 (units: dimensionless, initial value: 0.001179442867470093, component: i_Ks_xs2_gate)
// 20: a (units: dimensionless, initial value: 0.0014909437525000811, component: i_to_2_a_gate)
// 21: Na_i (units: millimolar, initial value: 9.927155552932733, component: intracellular_ion_concentrations)
// 22: Cl_i (units: millimolar, initial value: 18.904682470140408, component: intracellular_ion_concentrations)
// 23: K_i (units: millimolar, initial value: 141.9670801746057, component: intracellular_ion_concentrations)
// 24: Ca_MK_trap (units: dimensionless, initial value: 8.789168284782809e-06, component: Ca_MK_act)
// 25: Ca_NSR (units: millimolar, initial value: 1.2132524695849454, component: Ca_NSR)
// 26: Ca_JSR (units: millimolar, initial value: 1.1433050636518596, component: Ca_JSR)
// 27: Ca_r (units: millimolar, initial value: 0.00022418117117903934, component: Ca_r)
// 28: ri (units: dimensionless, initial value: 0.7802870066567904, component: q_rel_ri_gate)
// 29: ro (units: dimensionless, initial value: 1.2785734760674763e-09, component: q_rel_ro_gate)

char YNames[_NB_OF_STATE_VARIABLES_][11];
char YUnits[_NB_OF_STATE_VARIABLES_][14];
char YComponents[_NB_OF_STATE_VARIABLES_][33];

//------------------------------------------------------------------------------
// Constants
//------------------------------------------------------------------------------

double A0_bck; // dimensionless (in A0_bc)
double Ampl_gain; // dimensionless (in Ampl_gai)
double Cext; // picoF (in Cex)
double E_l; // millivolt (in E_)
double I; // dimensionless (in )
double R_seal; // ohm (in R_sea)
double Scale_bck; // dimensionless (in Scale_bc)
double Scaling; // dimensionless (in Scalin)
double k_bck; // one_over_millivolt (in k_bc)
double leak_comp_perc; // dimensionless (in leak_comp_per)
double q_leak_max; // millimolar_per_millisecond (in q_leak)
double g_rel_max; // per_millisecond (in q_rel)
double q_up_max; // millimolar_per_millisecond (in q_up)
double conc_clamp; // dimensionless (in intracellular_ion_concentrations)
double Ca_o; // millimolar (in model_parameters)
double K_o; // millimolar (in model_parameters)
double Na_o; // millimolar (in model_parameters)
double g_Ca_L; // dimensionless (in i_Ca_L)
double g_Na; // milliS_per_microF (in i_Na)
double perc_reduced_inact_for_IpNa; // dimensionless (in i_Na)
double shift_INa_inact; // millivolt (in i_Na)
double g_K1_max; // milliS_per_microF (in i_K1)
double g_Kr_max; // milliS_per_microF (in i_Kr)
double g_Ks_max; // milliS_per_microF (in i_Ks)
double i_NaCa_max; // microA_per_microF (in i_NaCa)
double stim_amplitude; // microA_per_microF (in membrane)
double stim_duration; // millisecond (in membrane)
double stim_start; // millisecond (in membrane)
double stim_period; // millisecond (in membrane)
double g_to_1; // milliS_per_microF (in i_to_1)

double A0_bck; // dimensionless (in A0_bc)
double Ampl_gain; // dimensionless (in Ampl_gai)
double CT_K_Cl_max; // millimolar_per_millisecond (in CT_K_Cl)
double CT_Na_Cl_max; // millimolar_per_millisecond (in CT_Na_Cl)
double CSQN_max; // millimolar (in Ca_JSR)
double km_CSQN; // millimolar (in Ca_JSR)
double Ca_MK_0; // dimensionless (in Ca_MK_act)
double alpha_Ca_MK; // per_millisecond (in Ca_MK_act)
double beta_Ca_MK; // per_millisecond (in Ca_MK_act)
double km_Ca_MK; // millimolar (in Ca_MK_act)
double CMDN_max; // millimolar (in Ca_i)
double TRPN_max; // millimolar (in Ca_i)
double km_CMDN; // millimolar (in Ca_i)
double km_TRPN; // millimolar (in Ca_i)
double b_SL_max; // millimolar (in Ca_r)
double b_SR_max; // millimolar (in Ca_r)
double km_b_SL; // millimolar (in Ca_r)
double km_b_SR; // millimolar (in Ca_r)
double tau_ss; // millisecond (in Ca_r)
double Cext; // picoF (in Cex)
double E_l; // millivolt (in E_)
double I; // dimensionless (in )
double R_seal; // ohm (in R_sea)
double Scale_bck; // dimensionless (in Scale_bc)
double Scaling; // dimensionless (in Scalin)
double g_Cl_b; // milliS_per_microF (in background_currents)
double g_K_b; // milliS_per_microF (in background_currents)
double g_Na_b; // milliS_per_microF (in background_currents)
double r_NaK; // dimensionless (in equilibrium_potentials)
double g_Ca_T; // milliS_per_microF (in i_Ca_T)
double i_Ca_p_max; // microA_per_microF (in i_Ca_p)
double km_Ca_p; // millimolar (in i_Ca_p)
double g_K_p; // milliS_per_microF (in i_K_p)
double X_NaCa; // dimensionless (in i_NaCa)
double k_sat; // dimensionless (in i_NaCa)
double km_Ca_act; // millimolar (in i_NaCa)
double km_Ca_i; // millimolar (in i_NaCa)
double km_Ca_o; // millimolar (in i_NaCa)
double km_Na_i_1; // millimolar (in i_NaCa)
double km_Na_o; // millimolar (in i_NaCa)
double g_NaK; // microA_per_microF (in i_NaK)
double km_K_o; // millimolar (in i_NaK)
double km_Na_i_2; // millimolar (in i_NaK)
double g_Na_L; // milliS_per_microF (in i_Na_L)
double km_to_2; // millimolar (in i_to_2_a_gate)
double tau_a; // millisecond (in i_to_2_a_gate)
double k_bck; // one_over_millivolt (in k_bc)
double leak_comp_perc; // dimensionless (in leak_comp_per)
double stim_end; // millisecond (in membrane)
double Cl_o; // millimolar (in model_parameters)
double Cm; // microF_per_cm2 (in model_parameters)
double F; // coulomb_per_mole (in model_parameters)
double R; // joule_per_kilomole_kelvin (in model_parameters)
double T; // kelvin (in model_parameters)
double Vol_cell; // microlitre (in model_parameters)
double length; // cm (in model_parameters)
double radius; // cm (in model_parameters)
double rcg; // dimensionless (in model_parameters)
double z_Ca; // dimensionless (in model_parameters)
double NSR_max; // millimolar (in q_leak)
double tau_Ca_MK_max; // millisecond (in q_rel_ri_gate)
double tau_ro; // millisecond (in q_rel_ro_gate)
double tau_tr; // millisecond (in q_tr)
double X_q_up; // dimensionless (in q_up)
double dkm_plb_max; // millimolar (in q_up)
double dq_up_Ca_MK_max; // dimensionless (in q_up)
double km_up; // millimolar (in q_up)

//------------------------------------------------------------------------------
// Computed variables
//------------------------------------------------------------------------------

double CMDN; // dimensionless (in Ca_i)
double TRPN; // dimensionless (in Ca_i)
double b_myo; // dimensionless (in Ca_i)
double Ca_MK_bound; // dimensionless (in Ca_MK_act)
double Ca_MK_act; // dimensionless (in Ca_MK_act)
double b_SL; // dimensionless (in Ca_r)
double b_SR; // dimensionless (in Ca_r)
double Ca_r_tot; // dimensionless (in Ca_r)
double q_diff; // millimolar_per_millisecond (in Ca_r)
double I_ext; // dimensionless (in I_ex)
double g_leak; // one_over_ohm (in g_lea)
double tau_f_Ca; // millisecond (in i_Ca_L_f_Ca_gate)
double i_Ca_p; // microA_per_microF (in i_Ca_p)
double g_Ks; // milliS_per_microF (in i_Ks)
double a_infinity; // dimensionless (in i_to_2_a_gate)
double d_infinity; // dimensionless (in i_Ca_L_d_gate)
double tau_d; // millisecond (in i_Ca_L_d_gate)
double f2_infinity; // dimensionless (in i_Ca_L_f2_gate)
double tau_f2; // millisecond (in i_Ca_L_f2_gate)
double f_infinity; // dimensionless (in i_Ca_L_f_gate)
double tau_f; // millisecond (in i_Ca_L_f_gate)
double i_Ca_T; // microA_per_microF (in i_Ca_T)
double alpha_b; // per_millisecond (in i_Ca_T_b_gate)
double b_infinity; // dimensionless (in i_Ca_T_b_gate)
double beta_b; // per_millisecond (in i_Ca_T_b_gate)
double tau_b; // millisecond (in i_Ca_T_b_gate)
double alpha_g; // per_millisecond (in i_Ca_T_g_gate)
double beta_g; // per_millisecond (in i_Ca_T_g_gate)
double g_infinity; // dimensionless (in i_Ca_T_g_gate)
double tau_g; // millisecond (in i_Ca_T_g_gate)
double kp; // dimensionless (in i_K_p)
double rr_infinity; // dimensionless (in i_Kr)
double tau_xr; // millisecond (in i_Kr_xr_gate)
double xr_infinity; // dimensionless (in i_Kr_xr_gate)
double tau_xs1; // millisecond (in i_Ks_xs1_gate)
double xs1_infinity; // dimensionless (in i_Ks_xs1_gate)
double tau_xs2; // millisecond (in i_Ks_xs2_gate)
double xs2_infinity; // dimensionless (in i_Ks_xs2_gate)
double h_L_infinity; // dimensionless (in i_Na_L_h_L_gate)
double tau_h_L; // millisecond (in i_Na_L_h_L_gate)
double alpha_m_L; // per_millisecond (in i_Na_L_m_L_gate)
double beta_m_L; // per_millisecond (in i_Na_L_m_L_gate)
double m_L_infinity; // dimensionless (in i_Na_L_m_L_gate)
double tau_m_L; // millisecond (in i_Na_L_m_L_gate)
double alpha_h; // per_millisecond (in i_Na_h_gate)
double beta_h; // per_millisecond (in i_Na_h_gate)
double h_infinity; // dimensionless (in i_Na_h_gate)
double tau_h; // millisecond (in i_Na_h_gate)
double alpha_j; // per_millisecond (in i_Na_j_gate)
double beta_j; // per_millisecond (in i_Na_j_gate)
double j_infinity; // dimensionless (in i_Na_j_gate)
double tau_j; // millisecond (in i_Na_j_gate)
double alpha_m; // per_millisecond (in i_Na_m_gate)
double beta_m; // per_millisecond (in i_Na_m_gate)
double m_infinity; // dimensionless (in i_Na_m_gate)
double tau_m; // millisecond (in i_Na_m_gate)
double i_bck; // dimensionless (in i_bc)
double i_leak_comp; // dimensionless (in i_leak_com)
double i_inj; // dimensionless (in i_in)
double alpha_a; // per_millisecond (in i_to_1_a_gate)
double beta_a; // per_millisecond (in i_to_1_a_gate)
double a_infinity; // dimensionless (in i_to_1_a_gate)
double tau_a; // millisecond (in i_to_1_a_gate)
double alpha_i2; // per_millisecond (in i_to_1_i2_gate)
double beta_i2; // per_millisecond (in i_to_1_i2_gate)
double i2_infinity; // dimensionless (in i_to_1_i2_gate)
double tau_i2; // millisecond (in i_to_1_i2_gate)
double alpha_i; // per_millisecond (in i_to_1_i_gate)
double beta_i; // per_millisecond (in i_to_1_i_gate)
double i_infinity; // dimensionless (in i_to_1_i_gate)
double tau_i; // millisecond (in i_to_1_i_gate)
double i_to_2_max; // microA_per_microF (in i_to_2)
double i_to_2; // microA_per_microF (in i_to_2)
double i_stim; // microA_per_microF (in membrane)
double i_Ca_b; // microA_per_microF (in background_currents)
double i_Ca_L_max; // microA_per_microF (in i_Ca_L)
double i_Ca_L; // microA_per_microF (in i_Ca_L)
double f_Ca2_infinity; // dimensionless (in i_Ca_L_f_Ca2_gate)
double tau_f_Ca2; // millisecond (in i_Ca_L_f_Ca2_gate)
double f_Ca_infinity; // dimensionless (in i_Ca_L_f_Ca_gate)
double dNaCa_1; // millimolar4 (in i_NaCa)
double g_K1; // milliS_per_microF (in i_K1)
double g_Kr; // milliS_per_microF (in i_Kr)
double dNaCa_2; // millimolar4 (in i_NaCa)
double sigma; // dimensionless (in i_NaK)
double E_Cl; // millivolt (in equilibrium_potentials)
double i_Cl_b; // microA_per_microF (in background_currents)
double E_K; // millivolt (in equilibrium_potentials)
double CT_K_Cl; // millimolar_per_millisecond (in CT_K_Cl)
double i_K_b; // microA_per_microF (in background_currents)
double E_Ks; // millivolt (in equilibrium_potentials)
double E_Na; // millivolt (in equilibrium_potentials)
double CT_Na_Cl; // millimolar_per_millisecond (in CT_Na_Cl)
double i_Na_b; // microA_per_microF (in background_currents)
double alpha_xK1; // dimensionless (in i_K1_xK1_gate)
double beta_xK1; // dimensionless (in i_K1_xK1_gate)
double xK1; // dimensionless (in i_K1_xK1_gate)
double i_K1; // microA_per_microF (in i_K1)
double i_K_p; // microA_per_microF (in i_K_p)
double i_Kr; // microA_per_microF (in i_Kr)
double i_Ks; // microA_per_microF (in i_Ks)
double i_Na; // microA_per_microF (in i_Na)
double i_NaCa; // microA_per_microF (in i_NaCa)
double f_NaK; // dimensionless (in i_NaK)
double i_NaK; // microA_per_microF (in i_NaK)
double i_Na_L; // microA_per_microF (in i_Na_L)
double i_to_1; // microA_per_microF (in i_to_1)
double i_tot; // microA_per_microF (in membrane)
double Vol_jsr; // microlitre (in model_parameters)
double Vol_myo; // microlitre (in model_parameters)
double Vol_nsr; // microlitre (in model_parameters)
double Vol_ss; // microlitre (in model_parameters)
double a_geo; // cm2 (in model_parameters)
double a_cap; // cm2 (in model_parameters)
double q_leak; // millimolar_per_millisecond (in q_leak)
double vg; // dimensionless (in q_rel)
double g_rel; // per_millisecond (in q_rel)
double Ca_fac; // millimolar (in q_rel_ri_gate)
double ri_infinity; // dimensionless (in q_rel_ri_gate)
double tau_Ca_MK; // millisecond (in q_rel_ri_gate)
double tau_ri; // millisecond (in q_rel_ri_gate)
double q_rel; // millimolar_per_millisecond (in q_rel)
double ro_infinity_JSR; // dimensionless (in q_rel_ro_gate)
double ro_infinity; // dimensionless (in q_rel_ro_gate)
double q_tr; // millimolar_per_millisecond (in q_tr)
double dkm_plb; // millimolar (in q_up)
double dq_up_Ca_MK; // dimensionless (in q_up)
double q_up; // millimolar_per_millisecond (in q_up)


//------------------------------------------------------------------------------
// Initialisation
//------------------------------------------------------------------------------

void init()
{
    //---------------------------------------------------------------------------
    // State variables
    //---------------------------------------------------------------------------

    Y[0] = -83.43812846286808; // V (millivolt) (in membrane)
    Y[1] = 0.00022355433459434943; // Ca_i (millimolar) (in Ca_i)
    Y[2] = 0.002003390432234504; // m (dimensionless) (in i_Na_m_gate)
    Y[3] = 0.9786390933308567; // h (dimensionless) (in i_Na_h_gate)
    Y[4] = 0.09866447258167589; // j (dimensionless) (in i_Na_j_gate)
    Y[5] = 0.002003390432234504; // m_L (dimensionless) (in i_Na_L_m_L_gate)
    Y[6] = 0.8946968372659203; // h_L (dimensionless) (in i_Na_L_h_L_gate)
    Y[7] = 2.322223865147363e-06; // d (dimensionless) (in i_Ca_L_d_gate)
    Y[8] = 0.9985607329462358; // f (dimensionless) (in i_Ca_L_f_gate)
    Y[9] = 0.8173435436674658; // f2 (dimensionless) (in i_Ca_L_f2_gate)
    Y[10] = 0.9610551285529658; // f_Ca (dimensionless) (in i_Ca_L_f_Ca_gate)
    Y[11] = 0.868690796671854; // f_Ca2 (dimensionless) (in i_Ca_L_f_Ca2_gate)
    Y[12] = 0.0002563937630984438; // b (dimensionless) (in i_Ca_T_b_gate)
    Y[13] = 0.9720432601848331; // g (dimensionless) (in i_Ca_T_g_gate)
    Y[14] = 0.0004238729429342389; // a (dimensionless) (in i_to_1_a_gate)
    Y[15] = 0.9990935802459496; // i (dimensionless) (in i_to_1_i_gate)
    Y[16] = 0.9777368439681764; // i2 (dimensionless) (in i_to_1_i2_gate)
    Y[17] = 0.07084939408222911; // xr (dimensionless) (in i_Kr_xr_gate)
    Y[18] = 0.0011737654433043125; // xs1 (dimensionless) (in i_Ks_xs1_gate)
    Y[19] = 0.001179442867470093; // xs2 (dimensionless) (in i_Ks_xs2_gate)
    Y[20] = 0.0014909437525000811; // a (dimensionless) (in i_to_2_a_gate)
    Y[21] = 9.927155552932733; // Na_i (millimolar) (in intracellular_ion_concentrations)
    Y[22] = 18.904682470140408; // Cl_i (millimolar) (in intracellular_ion_concentrations)
    Y[23] = 141.9670801746057; // K_i (millimolar) (in intracellular_ion_concentrations)
    Y[24] = 8.789168284782809e-06; // Ca_MK_trap (dimensionless) (in Ca_MK_act)
    Y[25] = 1.2132524695849454; // Ca_NSR (millimolar) (in Ca_NSR)
    Y[26] = 1.1433050636518596; // Ca_JSR (millimolar) (in Ca_JSR)
    Y[27] = 0.00022418117117903934; // Ca_r (millimolar) (in Ca_r)
    Y[28] = 0.7802870066567904; // ri (dimensionless) (in q_rel_ri_gate)
    Y[29] = 1.2785734760674763e-09; // ro (dimensionless) (in q_rel_ro_gate)

    strcpy(YNames[0], "V");
    strcpy(YNames[1], "Ca_i");
    strcpy(YNames[2], "m");
    strcpy(YNames[3], "h");
    strcpy(YNames[4], "j");
    strcpy(YNames[5], "m_L");
    strcpy(YNames[6], "h_L");
    strcpy(YNames[7], "d");
    strcpy(YNames[8], "f");
    strcpy(YNames[9], "f2");
    strcpy(YNames[10], "f_Ca");
    strcpy(YNames[11], "f_Ca2");
    strcpy(YNames[12], "b");
    strcpy(YNames[13], "g");
    strcpy(YNames[14], "a");
    strcpy(YNames[15], "i");
    strcpy(YNames[16], "i2");
    strcpy(YNames[17], "xr");
    strcpy(YNames[18], "xs1");
    strcpy(YNames[19], "xs2");
    strcpy(YNames[20], "a");
    strcpy(YNames[21], "Na_i");
    strcpy(YNames[22], "Cl_i");
    strcpy(YNames[23], "K_i");
    strcpy(YNames[24], "Ca_MK_trap");
    strcpy(YNames[25], "Ca_NSR");
    strcpy(YNames[26], "Ca_JSR");
    strcpy(YNames[27], "Ca_r");
    strcpy(YNames[28], "ri");
    strcpy(YNames[29], "ro");

    strcpy(YUnits[0], "millivolt");
    strcpy(YUnits[1], "millimolar");
    strcpy(YUnits[2], "dimensionless");
    strcpy(YUnits[3], "dimensionless");
    strcpy(YUnits[4], "dimensionless");
    strcpy(YUnits[5], "dimensionless");
    strcpy(YUnits[6], "dimensionless");
    strcpy(YUnits[7], "dimensionless");
    strcpy(YUnits[8], "dimensionless");
    strcpy(YUnits[9], "dimensionless");
    strcpy(YUnits[10], "dimensionless");
    strcpy(YUnits[11], "dimensionless");
    strcpy(YUnits[12], "dimensionless");
    strcpy(YUnits[13], "dimensionless");
    strcpy(YUnits[14], "dimensionless");
    strcpy(YUnits[15], "dimensionless");
    strcpy(YUnits[16], "dimensionless");
    strcpy(YUnits[17], "dimensionless");
    strcpy(YUnits[18], "dimensionless");
    strcpy(YUnits[19], "dimensionless");
    strcpy(YUnits[20], "dimensionless");
    strcpy(YUnits[21], "millimolar");
    strcpy(YUnits[22], "millimolar");
    strcpy(YUnits[23], "millimolar");
    strcpy(YUnits[24], "dimensionless");
    strcpy(YUnits[25], "millimolar");
    strcpy(YUnits[26], "millimolar");
    strcpy(YUnits[27], "millimolar");
    strcpy(YUnits[28], "dimensionless");
    strcpy(YUnits[29], "dimensionless");

    //------------------------------------------------------------------------------
    // Constants
    //------------------------------------------------------------------------------

    A0_bck = 1.0278;
    Ampl_gain = 1.0;
    Cext = 1.0;
    E_l = 1.0;
    I = 1.0;
    R_seal = 1.0;
    Scale_bck = 1.0;
    Scaling = 1.0;
    k_bck = 0.098599999999999993;
    leak_comp_perc = 1.0;
    q_leak_max = 0.0043750000000000004;
    g_rel_max = 3000.0;
    q_up_max = 0.0043750000000000004;
    conc_clamp = 1.0;
    Ca_o = 1.8;
    K_o = 5.4000000000000004;
    Na_o = 140.0;
    g_Ca_L = 0.3392328;
    g_Na = 8.0;
    perc_reduced_inact_for_IpNa = 0;
    shift_INa_inact = 0;
    g_K1_max = 0.25;
    g_Kr_max = 0.040008488000000002;
    g_Ks_max = 0.052581329000000003;
    i_NaCa_max = 4.5;
    stim_amplitude = -80.0;
    stim_duration = 1.0;
    stim_start = 100.0;
    stim_period = 800.0;
    g_to_1 = 0.14135944;

    A0_bck = 1.0278;
    Ampl_gain = 1.0;
    CT_K_Cl_max = 7.0755999999999996e-6;
    CT_Na_Cl_max = 9.8442999999999999e-6;
    CSQN_max = 10.0;
    km_CSQN = 0.80000000000000004;
    Ca_MK_0 = 0.050000000000000003;
    alpha_Ca_MK = 0.050000000000000003;
    beta_Ca_MK = 0.00068000000000000005;
    km_Ca_MK = 0.14999999999999999;
    CMDN_max = 0.050000000000000003;
    TRPN_max = 0.070000000000000007;
    km_CMDN = 0.0023800000000000002;
    km_TRPN = 0.00050000000000000001;
    b_SL_max = 1.1240000000000001;
    b_SR_max = 0.047;
    km_b_SL = 0.0086999999999999994;
    km_b_SR = 0.00087000000000000001;
    tau_ss = 0.20000000000000001;
    Cext = 1.0;
    E_l = 1.0;
    I = 1.0;
    R_seal = 1.0;
    Scale_bck = 1.0;
    Scaling = 1.0;
    g_Cl_b = 0.00022499999999999999;
    g_K_b = 0.0050000000000000001;
    g_Na_b = 0.0025000000000000001;
    r_NaK = 0.018329999999999999;
    g_Ca_T = 0.13;
    i_Ca_p_max = 0.057500000000000002;
    km_Ca_p = 0.00050000000000000001;
    g_K_p = 0.0027599999999999999;
    X_NaCa = 0.40000000000000002;
    k_sat = 0.27000000000000002;
    km_Ca_act = 0.000125;
    km_Ca_i = 0.0035999999999999999;
    km_Ca_o = 1.3;
    km_Na_i_1 = 12.300000000000001;
    km_Na_o = 87.5;
    g_NaK = 0.61875000000000002;
    km_K_o = 1.5;
    km_Na_i_2 = 10.0;
    g_Na_L = 0.037374999999999999;
    km_to_2 = 0.1502;
    tau_a = 1.0;
    k_bck = 0.098599999999999993;
    leak_comp_perc = 1.0;
    stim_end = 100000.0;
    Cl_o = 100.0;
    Cm = 1.0;
    F = 96485.0;
    R = 8314.0;
    T = 310.0;
    Vol_cell = 0.34539999999999998;
    length = 0.01;
    radius = 0.0011000000000000001;
    rcg = 2.0;
    z_Ca = 2.0;
    NSR_max = 15.0;
    tau_Ca_MK_max = 10.0;
    tau_ro = 3.0;
    tau_tr = 120.0;
    X_q_up = 0.5;
    dkm_plb_max = 0.00017000000000000001;
    dq_up_Ca_MK_max = 0.75;
    km_up = 0.00092000000000000003;

}

void compute(double time)
{
   // time: time (millisecond)

    CMDN = 2.0 * CMDN_max * Y[1] / pow((km_CMDN + Y[1]), 2);
    TRPN = 2.0 * TRPN_max * Y[1] / pow((km_TRPN + Y[1]), 2);
    b_myo = 1 / (1.0 + CMDN + TRPN);
    Ca_MK_bound = (1.0 - Y[24]) * Ca_MK_0 / (1.0 + km_Ca_MK / Y[27]);
    Ca_MK_act = Ca_MK_bound + Y[24];
    b_SL = 2.0 * b_SL_max * Y[27] / pow((km_b_SL + Y[27]), 2);
    b_SR = 2.0 * b_SR_max * Y[27] / pow((km_b_SR + Y[27]), 2);
    Ca_r_tot = 1 / (1.0 + b_SL + b_SR);
    q_diff = (-Y[1] + Y[27]) / tau_ss;
    dY[24] = -beta_Ca_MK * Y[24] + (Ca_MK_bound + Y[24]) * Ca_MK_bound * alpha_Ca_MK;
    I_ext = I / (Ampl_gain * Cext);
    g_leak = 1 / R_seal;
    tau_f_Ca = 0.5 + 1 / (1.0 + 333.33333333333331 * Y[27]) + 10.0 * Ca_MK_act / (Ca_MK_act + km_Ca_MK);
    i_Ca_p = Y[1] * i_Ca_p_max / (Y[1] + km_Ca_p);
    g_Ks = (1.0 + 0.59999999999999998 / (1.0 + 6.4818210260626455e-7 * pow((1 / Y[1]), 1.3999999999999999))) * g_Ks_max;
    a_infinity = 1 / (1.0 + km_to_2 / Y[27]);
    dY[20] = (-Y[20] + a_infinity) / tau_a;
    d_infinity = 1 / (1.0 + exp(0.59347181008902072 - 0.14836795252225518 * Y[0]));
    tau_d = 0.58999999999999997 + 0.80000000000000004 * exp(0.67599999999999993 + 0.051999999999999998 * Y[0]) / (1.0 + exp(1.7160000000000002 + 0.13200000000000001 * Y[0]));
    dY[7] = (-Y[7] + d_infinity) / tau_d;
    f2_infinity = 1 / (1.0 + exp(1.8 + 0.10000000000000001 * Y[0]));
    tau_f2 = 38.0 + 24.217200000000005 * pow((-1 + 0.053763440860215048 * Y[0]), 2);
    dY[9] = (-Y[9] + f2_infinity) / tau_f2;
    f_infinity = 1 / (1.0 + exp(1.8 + 0.10000000000000001 * Y[0]));
    tau_f = 4.0 + 0.03125 * pow((-1 + 0.40000000000000002 * Y[0]), 2);
    dY[8] = (-Y[8] + f_infinity) / tau_f;
    i_Ca_T = (-50.0 + Y[0]) * Y[12] * Y[13] * g_Ca_T;
    alpha_b = 1.0680000000000001 * exp(0.54333333333333333 + 0.033333333333333333 * Y[0]);
    b_infinity = 1 / (1.0 + exp(-5.4098360655737707 - 0.16393442622950821 * Y[0]));
    beta_b = 1.0680000000000001 * exp(-0.54333333333333333 - 0.033333333333333333 * Y[0]);
    tau_b = 1 / (alpha_b + beta_b);
    dY[12] = (-Y[12] + b_infinity) / tau_b;
    alpha_g = 0.014999999999999999 * exp(-0.86074429771908767 - 0.012004801920768308 * Y[0]);
    beta_g = 0.014999999999999999 * exp(4.6558441558441563 + 0.064935064935064929 * Y[0]);
    g_infinity = 1 / (1.0 + exp(9.0909090909090917 + 0.15151515151515152 * Y[0]));
    tau_g = 1 / (alpha_g + beta_g);
    dY[13] = (-Y[13] + g_infinity) / tau_g;
    kp = 1 / (1.0 + exp(1.2521739130434781 - 0.16722408026755853 * Y[0]));
    rr_infinity = 1 / (1.0 + exp(-0.26470588235294124 + 0.049019607843137261 * Y[0]));
    tau_xr = 100.0 + 900.0 / (1.0 + exp(0.20000000000000001 * Y[0]));
    xr_infinity = 1 / (1.0 + exp(-0.0069387755102040824 - 0.081632653061224483 * Y[0]));
    dY[17] = (-Y[17] + xr_infinity) / tau_xr;
    tau_xs1 = 1 / ((((Y[0] >= 0.54999921875000002) && (Y[0] <= 0.55000078125000007)) ? (-2.8124999999965681e-10 / (-1.0 + exp(-9.999999999987797e-8)) + 640000.00000042573 * (-0.54999921875000002 + Y[0]) * (2.8124999999996902e-10 / (-1.0 + exp(9.9999999999988984e-8)) + 2.8124999999965681e-10 / (-1.0 + exp(-9.999999999987797e-8)))) : (0.00036000000000000002 * (-0.55000000000000004 + Y[0]) / (-1.0 + exp(-0.070400000000000004 + 0.128 * Y[0])))) + (((Y[0] >= -44.600000010030094) && (Y[0] <= -44.599999989969909)) ? (-7.6328986866047728e-13 / (1.0 - exp(9.9999999875755032e-8)) + 49850000.061936118 * (44.600000010030094 + Y[0]) * (7.6328986866047728e-13 / (1.0 - exp(9.9999999875755032e-8)) + 7.6328986866047728e-13 / (1.0 - exp(-9.9999999875755032e-8)))) : (7.6100000000000007e-5 * (44.600000000000001 + Y[0]) / (1.0 - exp(-444.66200000000003 - 9.9700000000000006 * Y[0])))));
    xs1_infinity = 1 / (1.0 + exp(0.65693430656934315 - 0.072992700729927015 * Y[0]));
    dY[18] = (-Y[18] + xs1_infinity) / tau_xs1;
    tau_xs2 = 2.0 / ((((Y[0] >= 0.54999921875000002) && (Y[0] <= 0.55000078125000007)) ? (-2.8124999999965681e-10 / (-1.0 + exp(-9.999999999987797e-8)) + 640000.00000042573 * (-0.54999921875000002 + Y[0]) * (2.8124999999996902e-10 / (-1.0 + exp(9.9999999999988984e-8)) + 2.8124999999965681e-10 / (-1.0 + exp(-9.999999999987797e-8)))) : (0.00036000000000000002 * (-0.55000000000000004 + Y[0]) / (-1.0 + exp(-0.070400000000000004 + 0.128 * Y[0])))) + (((Y[0] >= -44.600000010030094) && (Y[0] <= -44.599999989969909)) ? (-7.6328986866047728e-13 / (1.0 - exp(9.9999999875755032e-8)) + 49850000.061936118 * (44.600000010030094 + Y[0]) * (7.6328986866047728e-13 / (1.0 - exp(9.9999999875755032e-8)) + 7.6328986866047728e-13 / (1.0 - exp(-9.9999999875755032e-8)))) : (7.6100000000000007e-5 * (44.600000000000001 + Y[0]) / (1.0 - exp(-444.66200000000003 - 9.9700000000000006 * Y[0])))));
    xs2_infinity = 1 / (1.0 + exp(0.65693430656934315 - 0.072992700729927015 * Y[0]));
    dY[19] = (-Y[19] + xs2_infinity) / tau_xs2;
    h_L_infinity = 1 / (1.0 + exp(11.311475409836067 + 0.16393442622950821 * Y[0]));
    tau_h_L = 175.0 + 125.0 / (1.0 + exp(-4.166666666666667 - 0.16666666666666666 * Y[0]));
    dY[6] = (-Y[6] + h_L_infinity) / tau_h_L;
    if ((Y[0] >= -47.130001) && (Y[0] <= -47.129999000000005))
        alpha_m_L = -3.200000000092018e-7 / (1.0 - exp(1.0000000000287557e-7)) + 499999.99998562218 * (47.130001 + Y[0]) * (3.200000000092018e-7 / (1.0 - exp(1.0000000000287557e-7)) + 3.200000000092018e-7 / (1.0 - exp(-1.0000000000287557e-7)))
    else 
        alpha_m_L = 0.32000000000000001 * (47.130000000000003 + Y[0]) / (1.0 - exp(-4.7130000000000001 - 0.10000000000000001 * Y[0]))

    beta_m_L = 0.080000000000000002 * exp(-0.090909090909090912 * Y[0]);
    m_L_infinity = alpha_m_L / (alpha_m_L + beta_m_L);
    tau_m_L = 1 / (alpha_m_L + beta_m_L);
    dY[5] = (-Y[5] + m_L_infinity) / tau_m_L;
    if (Y[0] < -40.0)
        alpha_h = 0.13500000000000001 * exp(-11.764705882352942 + 0.14705882352941177 * shift_INa_inact - 0.14705882352941177 * Y[0])
    else 
        alpha_h = 0

    if (Y[0] < -40.0)
        beta_h = 310000.0 * exp(0.34999999999999998 * Y[0] - 0.34999999999999998 * shift_INa_inact) + 3.5600000000000001 * exp(0.079000000000000001 * Y[0] - 0.079000000000000001 * shift_INa_inact)
    else 
        beta_h = 7.6923076923076916 / (1.0 + exp(-0.96036036036036043 + 0.0900900900900901 * shift_INa_inact - 0.0900900900900901 * Y[0]))

    h_infinity = 0.01 * perc_reduced_inact_for_IpNa + (1.0 - 0.01 * perc_reduced_inact_for_IpNa) * alpha_h / (alpha_h + beta_h);
    tau_h = 1 / (alpha_h + beta_h);
    dY[3] = (-Y[3] + h_infinity) / tau_h;
    if (Y[0] < -40.0)
        alpha_j = (37.780000000000001 + Y[0]) * (-127140.0 * exp(0.24440000000000001 * Y[0] - 0.24440000000000001 * shift_INa_inact) - 3.4740000000000003e-5 * exp(0.043909999999999998 * shift_INa_inact - 0.043909999999999998 * Y[0])) / (1.0 + exp(24.640530000000002 + 0.311 * Y[0] - 0.311 * shift_INa_inact))
    else 
        alpha_j = 0

    if (Y[0] < -40.0)
        beta_j = 0.1212 * exp(0.01052 * shift_INa_inact - 0.01052 * Y[0]) / (1.0 + exp(-5.5312920000000005 + 0.13780000000000001 * shift_INa_inact - 0.13780000000000001 * Y[0]))
    else 
        beta_j = 0.29999999999999999 * exp(2.5349999999999999e-7 * shift_INa_inact - 2.5349999999999999e-7 * Y[0]) / (1.0 + exp(-3.2000000000000002 + 0.10000000000000001 * shift_INa_inact - 0.10000000000000001 * Y[0]))

    j_infinity = 0.01 * perc_reduced_inact_for_IpNa + (1.0 - 0.01 * perc_reduced_inact_for_IpNa) * alpha_j / (alpha_j + beta_j);
    tau_j = 1 / (alpha_j + beta_j);
    dY[4] = (-Y[4] + j_infinity) / tau_j;
    if ((Y[0] >= -47.130001) && (Y[0] <= -47.129999000000005))
        alpha_m = -3.200000000092018e-7 / (1.0 - exp(1.0000000000287557e-7)) + 499999.99998562218 * (47.130001 + Y[0]) * (3.200000000092018e-7 / (1.0 - exp(1.0000000000287557e-7)) + 3.200000000092018e-7 / (1.0 - exp(-1.0000000000287557e-7)))
    else 
        alpha_m = 0.32000000000000001 * (47.130000000000003 + Y[0]) / (1.0 - exp(-4.7130000000000001 - 0.10000000000000001 * Y[0]))

    beta_m = 0.080000000000000002 * exp(-0.090909090909090912 * Y[0]);
    m_infinity = alpha_m / (alpha_m + beta_m);
    tau_m = 1 / (alpha_m + beta_m);
    dY[2] = (-Y[2] + m_infinity) / tau_m;
    i_bck = A0_bck * Scale_bck / ((1 + exp(-Y[0] * k_bck)) * Cext);
    i_leak_comp = (-E_l + Y[0]) * g_leak * leak_comp_perc / (100 * Cext);
    i_inj = (-i_bck - i_leak_comp + I_ext) * Scaling;
    alpha_a = 25.0 * exp(-3.7999999999999998 + 0.050000000000000003 * Y[0]) / (1.0 + exp(-3.7999999999999998 + 0.050000000000000003 * Y[0]));
    beta_a = 25.0 * exp(-2.7000000000000002 - 0.050000000000000003 * Y[0]) / (1.0 + exp(-2.7000000000000002 - 0.050000000000000003 * Y[0]));
    a_infinity = alpha_a / (alpha_a + beta_a);
    tau_a = 1 / (alpha_a + beta_a);
    dY[14] = (-Y[14] + a_infinity) / tau_a;
    alpha_i2 = 0.0044200000000000003 / (1.0 + exp(1.7333333333333334 + 0.066666666666666666 * Y[0]));
    beta_i2 = 0.050000000000000003 * exp(-0.66666666666666663 + 0.066666666666666666 * Y[0]) / (1.0 + exp(-0.66666666666666663 + 0.066666666666666666 * Y[0]));
    i2_infinity = alpha_i2 / (alpha_i2 + beta_i2);
    tau_i2 = 21.5 + 30.0 / (1.0 + exp(-2.5 + 0.10000000000000001 * Y[0]));
    dY[16] = (-Y[16] + i2_infinity) / tau_i2;
    alpha_i = 0.029999999999999999 / (1.0 + exp(1.6666666666666667 + 0.066666666666666666 * Y[0]));
    beta_i = 0.10000000000000001 * exp(-2.6666666666666665 + 0.066666666666666666 * Y[0]) / (1.0 + exp(-2.6666666666666665 + 0.066666666666666666 * Y[0]));
    i_infinity = alpha_i / (alpha_i + beta_i);
    tau_i = 6.0 + 5.0 / (1.0 + exp(-1.6499999999999999 + 0.10000000000000001 * Y[0]));
    dY[15] = (-Y[15] + i_infinity) / tau_i;
    if ((Y[0] >= -2.6712338705498262e-6) && (Y[0] <= 2.6712338705498262e-6))
        i_to_2_max = 187179.41753901311 * (2.6712338705498262e-6 + Y[0]) * (3.8593999999999993e-9 * (-100.0 * exp(9.9999999999999995e-8) + Y[22]) / (1.0 - exp(9.9999999999999995e-8)) + 3.8593999999999993e-9 * (-100.0 * exp(-9.9999999999999995e-8) + Y[22]) / (1.0 - exp(-9.9999999999999995e-8))) - 3.8593999999999993e-9 * (-100.0 * exp(-9.9999999999999995e-8) + Y[22]) / (1.0 - exp(-9.9999999999999995e-8))
    else 
        i_to_2_max = 0.0014448004881001341 * (-100.0 * exp(0.037435883507802616 * Y[0]) + Y[22]) * Y[0] / (1.0 - exp(0.037435883507802616 * Y[0]))

    i_to_2 = 20.0 * Y[20] * i_to_2_max;
    if ((Y[30] >= stim_start) && (Y[30] <= stim_end) && (stim_duration >= -stim_start - stim_period * floor((-stim_start + Y[30]) / stim_period) + Y[30]))
        i_stim = stim_amplitude
    else 
        i_stim = 0

    if ((Y[0] >= -1.3356169352749131e-6) && (Y[0] <= 1.3356169352749131e-6))
        i_Ca_b = 374358.83507802623 * (1.3356169352749131e-6 + Y[0]) * (3.8499135947999997e-9 * (-0.34100000000000003 * Ca_o + Y[1] * exp(9.9999999999999995e-8)) / (-1.0 + exp(9.9999999999999995e-8)) + 3.8499135947999997e-9 * (-0.34100000000000003 * Ca_o + Y[1] * exp(-9.9999999999999995e-8)) / (-1.0 + exp(-9.9999999999999995e-8))) - 3.8499135947999997e-9 * (-0.34100000000000003 * Ca_o + Y[1] * exp(-9.9999999999999995e-8)) / (-1.0 + exp(-9.9999999999999995e-8))
    else 
        i_Ca_b = 0.0028824983370007683 * (-0.34100000000000003 * Ca_o + Y[1] * exp(0.074871767015605231 * Y[0])) * Y[0] / (-1.0 + exp(0.074871767015605231 * Y[0]))

    if ((Y[0] >= 14.999998664383064) && (Y[0] <= 15.000001335616936))
        i_Ca_L_max = 374358.83507888648 * (-14.999998664383064 + Y[0]) * (4.6891709999892238e-6 * (-0.34100000000000003 * Ca_o + Y[27] * exp(9.9999999999770198e-8)) / (-1.0 + exp(9.9999999999770198e-8)) + 4.6891709999892238e-6 * (-0.34100000000000003 * Ca_o + Y[27] * exp(-9.9999999999770198e-8)) / (-1.0 + exp(-9.9999999999770198e-8))) - 4.6891709999892238e-6 * (-0.34100000000000003 * Ca_o + Y[27] * exp(-9.9999999999770198e-8)) / (-1.0 + exp(-9.9999999999770198e-8))
    else 
        i_Ca_L_max = 3.510865186083326 * (-15.0 + Y[0]) * (-0.34100000000000003 * Ca_o + Y[27] * exp(-1.1230765052340785 + 0.074871767015605231 * Y[0])) / (-1.0 + exp(-1.1230765052340785 + 0.074871767015605231 * Y[0]))

    i_Ca_L = Y[10] * Y[11] * Y[7] * Y[8] * Y[9] * g_Ca_L * i_Ca_L_max;
    f_Ca2_infinity = 1 / (1.0 - 100.0 * i_Ca_L);
    tau_f_Ca2 = 125.0 + 300.0 / (1.0 + exp(-4.375 - 25.0 * i_Ca_L));
    dY[11] = (-Y[11] + f_Ca2_infinity) / tau_f_Ca2;
    f_Ca_infinity = 0.14999999999999999 + 0.55000000000000004 / (1.0 + 333.33333333333331 * Y[27]) + 0.29999999999999999 / (1.0 - 20.0 * i_Ca_L);
    dY[10] = (-Y[10] + f_Ca_infinity) / tau_f_Ca;
    dNaCa_1 = pow(Y[21], 3) * km_Ca_o + 1.5 * pow(km_Na_o, 3) * Y[1] + pow(km_Na_i_1, 3) * (1.0 + 1.5 * Y[1] / km_Ca_i) * Ca_o;
    g_K1 = 0.43033148291193518 * sqrt(K_o) * g_K1_max;
    g_Kr = 0.43033148291193518 * sqrt(K_o) * g_Kr_max;
    dNaCa_2 = pow(Y[21], 3) * Ca_o + 1.5 * pow(Na_o, 3) * Y[1] + pow(Na_o, 3) * (1.0 + Y[21] / km_Na_i_1) * km_Ca_i;
    sigma = -0.14285714285714285 + 0.14285714285714285 * exp(0.01485884101040119 * Na_o);
    E_Cl = -R * T * log(Cl_o / Y[22]) / F;
    i_Cl_b = (-E_Cl + Y[0]) * g_Cl_b;
    E_K = R * T * log(K_o / Y[23]) / F;
    CT_K_Cl = (-E_Cl + E_K) * CT_K_Cl_max / (87.825100000000006 - E_Cl + E_K);
    i_K_b = (-E_K + Y[0]) * g_K_b;
    E_Ks = R * T * log((r_NaK * Na_o + K_o) / (Y[21] * r_NaK + Y[23])) / F;
    E_Na = R * T * log(Na_o / Y[21]) / F;
    CT_Na_Cl = pow((-E_Cl + E_Na), 4) * CT_Na_Cl_max / (59494197.640692554 + pow((-E_Cl + E_Na), 4));
    i_Na_b = (-E_Na + Y[0]) * g_Na_b;
    alpha_xK1 = 1.02 / (1.0 + exp(-14.1227775 + 0.23849999999999999 * Y[0] - 0.23849999999999999 * E_K));
    beta_xK1 = (0.49124000000000001 * exp(0.43983232 + 0.080320000000000003 * Y[0] - 0.080320000000000003 * E_K) + exp(-36.698642499999998 + 0.061749999999999999 * Y[0] - 0.061749999999999999 * E_K)) / (1.0 + exp(-2.4444678999999998 + 0.51429999999999998 * E_K - 0.51429999999999998 * Y[0]));
    xK1 = alpha_xK1 / (alpha_xK1 + beta_xK1);
    i_K1 = (0.0040000000000000001 + g_K1 * xK1) * (-E_K + Y[0]);
    i_K_p = (-E_K + Y[0]) * g_K_p * kp;
    i_Kr = (-E_K + Y[0]) * Y[17] * g_Kr * rr_infinity;
    i_Ks = (-E_Ks + Y[0]) * Y[18] * Y[19] * g_Ks;
    i_Na = pow(Y[2], 3) * (-E_Na + Y[0]) * (0.20000000000000001 * Y[4] + 0.80000000000000004 * Y[3]) * g_Na;
    i_NaCa = (-1.5 * pow(Na_o, 3) * Y[1] * exp(-0.65000000000000002 * Y[0] * F / (R * T)) + pow(Y[21], 3) * X_NaCa * i_NaCa_max * Ca_o * exp(0.34999999999999998 * Y[0] * F / (R * T))) / ((1.0 + k_sat * exp(-0.65000000000000002 * Y[0] * F / (R * T))) * (1.0 + 0.44444444444444442 * pow(km_Ca_act, 2) / pow(Y[1], 2)) * (dNaCa_1 + dNaCa_2));
    f_NaK = 1 / (1.0 + 0.1245 * exp(-0.10000000000000001 * Y[0] * F / (R * T)) + 0.036499999999999998 * sigma * exp(-Y[0] * F / (R * T)));
    i_NaK = f_NaK * g_NaK * K_o / ((1.0 + pow(km_Na_i_2, 2) / pow(Y[21], 2)) * (km_K_o + K_o));
    i_Na_L = pow(Y[5], 3) * (-E_Na + Y[0]) * Y[6] * g_Na_L;
    i_to_1 = (-E_K + Y[0]) * (0.20000000000000001 * Y[16] + 0.80000000000000004 * Y[15]) * Y[14] * g_to_1;
    i_tot = i_Ca_b + i_Cl_b + i_K_b + i_Na_b + i_Ca_L + i_Ca_T + i_Ca_p + i_K1 + i_K_p + i_Kr + i_Ks + i_Na + i_NaCa + i_NaK + i_Na_L + i_to_1 + i_to_2;
    dY[0] = -i_inj - i_stim - i_tot;
    Vol_jsr = 0.0047999999999999996 * Vol_cell;
    Vol_myo = 0.68000000000000005 * Vol_cell;
    Vol_nsr = 0.055199999999999999 * Vol_cell;
    Vol_ss = 0.02 * Vol_cell;
    a_geo = 6.2800000000000002 * pow(radius, 2) + 6.2800000000000002 * length * radius;
    a_cap = a_geo * rcg;
    dY[22] = (-(i_Cl_b + i_to_2) * Cm * a_cap / (F * Vol_myo) + CT_K_Cl + CT_Na_Cl) * conc_clamp;
    dY[23] = (-(-2.0 * i_NaK + i_K_b + i_K1 + i_K_p + i_Kr + i_Ks + i_to_1) * Cm * a_cap / (F * Vol_myo) + CT_K_Cl) * conc_clamp;
    dY[21] = (-(3.0 * i_NaCa + 3.0 * i_NaK + i_Na_b + i_Na + i_Na_L) * Cm * a_cap / (F * Vol_myo) + CT_Na_Cl) * conc_clamp;
    q_leak = Y[25] * q_leak_max / NSR_max;
    vg = 1 / (1.0 + exp(2.6000000000000001 + 0.20000000000000001 * g_Ca_L * i_Ca_L_max));
    g_rel = g_rel_max * vg;
    Ca_fac = 1 / (1.0 + exp(3.3333333333333335 + 66.666666666666671 * i_Ca_L));
    ri_infinity = 1 / (1.0 + exp(-16.0 + 80.0 * Ca_fac + 40000.0 * Y[27]));
    tau_Ca_MK = Ca_MK_act * tau_Ca_MK_max / (Ca_MK_act + km_Ca_MK);
    tau_ri = 3.0 + (350.0 - tau_Ca_MK) / (1.0 + exp(-15.0 + 5000.0 * Y[27] + 15.0 * Ca_fac)) + tau_Ca_MK;
    dY[28] = (-Y[28] + ri_infinity) / tau_ri;
    q_rel = (-Y[27] + Y[26]) * Y[28] * Y[29] * g_rel;
    dY[27] = (-q_diff + Vol_jsr * q_rel / Vol_ss - i_Ca_L * Cm * a_cap / (F * Vol_ss * z_Ca)) * Ca_r_tot;
    ro_infinity_JSR = pow(Y[26], 1.8999999999999999) / (pow(Y[26], 1.8999999999999999) + 1644.6531773416521 * pow((Y[27] / (0.0028 + Y[27])), 1.8999999999999999));
    ro_infinity = pow(i_Ca_L, 2) * ro_infinity_JSR / (1.0 + pow(i_Ca_L, 2));
    dY[29] = (-Y[29] + ro_infinity) / tau_ro;
    q_tr = (-Y[26] + Y[25]) / tau_tr;
    dY[26] = (-q_rel + q_tr) / (1.0 + CSQN_max * km_CSQN / pow((km_CSQN + Y[26]), 2));
    dkm_plb = Ca_MK_act * dkm_plb_max / (Ca_MK_act + km_Ca_MK);
    dq_up_Ca_MK = Ca_MK_act * dq_up_Ca_MK_max / (Ca_MK_act + km_Ca_MK);
    q_up = (1.0 + dq_up_Ca_MK) * Y[1] * X_q_up * q_up_max / (-dkm_plb + Y[1] + km_up);
    dY[25] = -q_leak - Vol_jsr * q_tr / Vol_nsr + q_up;
    dY[1] = -((-q_leak + q_up) * Vol_nsr / Vol_myo - q_diff * Vol_ss / Vol_myo + 0.5 * (-2.0 * i_NaCa + i_Ca_b + i_Ca_p) * Cm * a_cap / (F * Vol_myo)) * b_myo;
}

//==============================================================================
// End of file
//==============================================================================
