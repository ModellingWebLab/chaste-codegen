//! @file
//! 
//! This source file was generated from CellML.
//! 
//! Model: matsuoka_model_2003
//! 
//! Processed by pycml - CellML Tools in Python
//!     (translators: , pycml: , optimize: )
//! on (date omitted as unimportant)
//! 
//! <autogenerated>

#include "matsuoka_model_2003.hpp"
#include <cmath>
#include <cassert>
#include <memory>
#include "Exception.hpp"
#include "OdeSystemInformation.hpp"
#include "RegularStimulus.hpp"
#include "HeartConfig.hpp"
#include "IsNan.hpp"
#include "MathsCustomFunctions.hpp"

    boost::shared_ptr<RegularStimulus> Dynamicmatsuoka_model_2003FromCellMLRushLarsen::UseCellMLDefaultStimulus()
    {
        // Use the default stimulus specified by CellML metadata
        const double var_membrane__Cm = 132.0; // picoF
        const double var_chaste_interface__membrane__stim_start = 50.0; // millisecond
        const double var_chaste_interface__membrane__stim_period = 400.0; // millisecond
        const double var_chaste_interface__membrane__stim_duration = 2.0; // millisecond
        const double var_chaste_interface__membrane__stim_amplitude = ( -4000.0 / var_membrane__Cm) * HeartConfig::Instance()->GetCapacitance(); // uA_per_cm2
        boost::shared_ptr<RegularStimulus> p_cellml_stim(new RegularStimulus(
                -fabs(var_chaste_interface__membrane__stim_amplitude),
                var_chaste_interface__membrane__stim_duration,
                var_chaste_interface__membrane__stim_period,
                var_chaste_interface__membrane__stim_start
                ));
        mpIntracellularStimulus = p_cellml_stim;
        return p_cellml_stim;
    }
    
    Dynamicmatsuoka_model_2003FromCellMLRushLarsen::Dynamicmatsuoka_model_2003FromCellMLRushLarsen(boost::shared_ptr<AbstractIvpOdeSolver> /* unused; should be empty */, boost::shared_ptr<AbstractStimulusFunction> pIntracellularStimulus)
        : AbstractRushLarsenCardiacCell(
                37,
                0,
                pIntracellularStimulus)
    {
        // Time units: millisecond
        // 
        this->mpSystemInfo = OdeSystemInformation<Dynamicmatsuoka_model_2003FromCellMLRushLarsen>::Instance();
        Init();

        // We have a default stimulus specified in the CellML file metadata
        this->mHasDefaultStimulusFromCellML = true;
    }
    
    Dynamicmatsuoka_model_2003FromCellMLRushLarsen::~Dynamicmatsuoka_model_2003FromCellMLRushLarsen()
    {
    }
    
    double Dynamicmatsuoka_model_2003FromCellMLRushLarsen::GetIIonic(const std::vector<double>* pStateVariables)
    {
        // For state variable interpolation (SVI) we read in interpolated state variables,
        // otherwise for ionic current interpolation (ICI) we use the state variables of this model (node).
        if (!pStateVariables) pStateVariables = &rGetStateVariables();
        const std::vector<double>& rY = *pStateVariables;
        double var_chaste_interface__membrane__Vm = (mSetVoltageDerivativeToZero ? this->mFixedVoltage : rY[0]);
        // Units: millivolt; Initial value: -85.95752434460744
        double var_chaste_interface__internal_ion_concentrations__Nai = rY[1];
        // Units: millimolar; Initial value: 4.925761439682025
        double var_chaste_interface__internal_ion_concentrations__Ki = rY[2];
        // Units: millimolar; Initial value: 143.1837333000449
        double var_chaste_interface__internal_ion_concentrations__Ca_Total = rY[3];
        // Units: millimolar; Initial value: 4.0180173572968586e-4
        double var_chaste_interface__ATP_production__ATPi = rY[4];
        // Units: millimolar; Initial value: 4.657102729020499
        double var_chaste_interface__sodium_current_voltage_dependent_gate__p_AP_Na = rY[5];
        // Units: dimensionless; Initial value: 1.779648367445368e-5
        double var_chaste_interface__sodium_current_ultra_slow_gate__y = rY[8];
        // Units: dimensionless; Initial value: 0.5861887862983165
        double var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AP_CaL = rY[9];
        // Units: dimensionless; Initial value: 1.5445004166497696e-6
        double var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_U = rY[12];
        // Units: dimensionless; Initial value: 0.17246483915629204
        double var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_UCa = rY[13];
        // Units: dimensionless; Initial value: 6.098246017787626e-5
        double var_chaste_interface__L_type_Ca_channel_ultra_slow_gate__y = rY[15];
        // Units: dimensionless; Initial value: 0.9985266538252986
        double var_chaste_interface__T_type_Ca_channel_y1_gate__y1 = rY[16];
        // Units: dimensionless; Initial value: 1.6882718240109127e-5
        double var_chaste_interface__T_type_Ca_channel_y2_gate__y2 = rY[17];
        // Units: dimensionless; Initial value: 0.8585352091865849
        double var_chaste_interface__time_independent_potassium_current_y_gate__y = rY[18];
        // Units: dimensionless; Initial value: 0.6080573900752752
        double var_chaste_interface__rapid_time_dependent_potassium_current_y1_gate__y1 = rY[19];
        // Units: dimensionless; Initial value: 0.0018339931180983765
        double var_chaste_interface__rapid_time_dependent_potassium_current_y2_gate__y2 = rY[20];
        // Units: dimensionless; Initial value: 0.20443083454225305
        double var_chaste_interface__rapid_time_dependent_potassium_current_y3_gate__y3 = rY[21];
        // Units: dimensionless; Initial value: 0.967887666264921
        double var_chaste_interface__slow_time_dependent_potassium_current_y1_gate__y1 = rY[22];
        // Units: dimensionless; Initial value: 0.09738789658609195
        double var_chaste_interface__slow_time_dependent_potassium_current_y2_gate__y2 = rY[23];
        // Units: dimensionless; Initial value: 0.09745345578743213
        double var_chaste_interface__transient_outward_current_y1_gate__y1 = rY[24];
        // Units: dimensionless; Initial value: 7.956883250874798e-4
        double var_chaste_interface__transient_outward_current_y2_gate__y2 = rY[25];
        // Units: dimensionless; Initial value: 0.9999125083105881
        double var_chaste_interface__sodium_calcium_exchanger_y_gate__y = rY[26];
        // Units: dimensionless; Initial value: 0.9891789193465331
        double var_chaste_interface__sodium_potassium_pump_y_gate__y = rY[27];
        // Units: dimensionless; Initial value: 0.5910747147428818
        
        const double var_membrane__Cm = 132.0; // picoF
        const double var_constant_field_equations__CF_Na = (var_chaste_interface__membrane__Vm == 0.0) ?  -140.0 : ((((96.486699999999999 * var_chaste_interface__membrane__Vm) * 0.0003879829271992715) * (var_chaste_interface__internal_ion_concentrations__Nai - (140.0 * exp(( -96.486699999999999 * var_chaste_interface__membrane__Vm) * 0.0003879829271992715)))) / (1.0 - exp(( -96.486699999999999 * var_chaste_interface__membrane__Vm) * 0.0003879829271992715))); // millimolar
        const double var_sodium_current__i_Na_Na = 2860.0 * var_constant_field_equations__CF_Na * var_chaste_interface__sodium_current_voltage_dependent_gate__p_AP_Na * var_chaste_interface__sodium_current_ultra_slow_gate__y; // picoA
        const double var_constant_field_equations__CF_K = (var_chaste_interface__membrane__Vm == 0.0) ? var_chaste_interface__internal_ion_concentrations__Ki : ((((96.486699999999999 * var_chaste_interface__membrane__Vm) * 0.0003879829271992715) * (var_chaste_interface__internal_ion_concentrations__Ki - (5.4000000000000004 * exp(( -96.486699999999999 * var_chaste_interface__membrane__Vm) * 0.0003879829271992715)))) / (1.0 - exp(( -96.486699999999999 * var_chaste_interface__membrane__Vm) * 0.0003879829271992715))); // millimolar
        const double var_sodium_current__i_Na_K = var_constant_field_equations__CF_K * var_chaste_interface__sodium_current_voltage_dependent_gate__p_AP_Na * var_chaste_interface__sodium_current_ultra_slow_gate__y * 286.0; // picoA
        const double var_internal_ion_concentrations__b1 = (0.050000000000000003 - var_chaste_interface__internal_ion_concentrations__Ca_Total) + 0.0023800000000000002; // millimolar
        const double var_internal_ion_concentrations__Cai = (sqrt(pow(var_internal_ion_concentrations__b1, 2.0) + (4.0 * (0.0023800000000000002 * var_chaste_interface__internal_ion_concentrations__Ca_Total))) - var_internal_ion_concentrations__b1) * 0.5; // millimolar
        const double var_constant_field_equations__CF_Ca = (var_chaste_interface__membrane__Vm == 0.0) ?  -1.8 : ((((var_chaste_interface__membrane__Vm * 192.9734) * 0.0003879829271992715) * (var_internal_ion_concentrations__Cai - (1.8 * exp((var_chaste_interface__membrane__Vm *  -192.9734) * 0.0003879829271992715)))) / (1.0 - exp((var_chaste_interface__membrane__Vm *  -192.9734) * 0.0003879829271992715))); // millimolar
        const double var_L_type_Ca_channel__p_open_CaL = (var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AP_CaL * (var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_U + var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_UCa) * var_chaste_interface__L_type_Ca_channel_ultra_slow_gate__y) / (1.0 + pow(1.3999999999999999 / var_chaste_interface__ATP_production__ATPi, 3.0)); // dimensionless
        const double var_L_type_Ca_channel__i_CaL_Ca = 8712.0 * var_constant_field_equations__CF_Ca * var_L_type_Ca_channel__p_open_CaL; // picoA
        const double var_L_type_Ca_channel__i_CaL_Na = var_constant_field_equations__CF_Na * var_L_type_Ca_channel__p_open_CaL * 0.16117199999999998; // picoA
        const double var_L_type_Ca_channel__i_CaL_K = var_constant_field_equations__CF_K * var_L_type_Ca_channel__p_open_CaL * 3.1798799999999998; // picoA
        const double var_time_independent_potassium_current__E_K = 26.71283192398538 * log(5.4000000000000004 / var_chaste_interface__internal_ion_concentrations__Ki); // millivolt
        const double var_rapid_time_dependent_potassium_current__i_Kr = (var_membrane__Cm * 0.0086400000000000001) * (var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) * ((0.59999999999999998 * var_chaste_interface__rapid_time_dependent_potassium_current_y1_gate__y1) + (0.40000000000000002 * var_chaste_interface__rapid_time_dependent_potassium_current_y2_gate__y2)) * var_chaste_interface__rapid_time_dependent_potassium_current_y3_gate__y3; // picoA
        const double var_sodium_calcium_exchanger__p_E1Na = 1.0 / (1.0 + (pow(8.75 / var_chaste_interface__internal_ion_concentrations__Nai, 3.0) * (1.0 + (var_internal_ion_concentrations__Cai * 724.63768115942037)))); // dimensionless
        const double var_sodium_calcium_exchanger__k2 = 1.0 * exp((var_chaste_interface__membrane__Vm *  -65.610955999999987) * 0.0003879829271992715); // per_millisecond
        const double var_sodium_calcium_exchanger__k1 = 1.0 * exp((var_chaste_interface__membrane__Vm * 30.875744000000001) * 0.0003879829271992715); // per_millisecond
        const double var_sodium_calcium_exchanger__i_NaCa = var_membrane__Cm * ((var_sodium_calcium_exchanger__k1 * var_sodium_calcium_exchanger__p_E1Na * var_chaste_interface__sodium_calcium_exchanger_y_gate__y) - (var_sodium_calcium_exchanger__k2 * 0.63996521928156069 * (1.0 - var_chaste_interface__sodium_calcium_exchanger_y_gate__y))) * 6.8099999999999996; // picoA
        const double var_sodium_potassium_pump__Nao_Eff = 140.0 * exp((var_chaste_interface__membrane__Vm *  -79.11909399999999) * 0.0003879829271992715); // millimolar
        const double var_sodium_potassium_pump__p_E2Na = 1.0 / (1.0 + (pow(69.799999999999997 / var_sodium_potassium_pump__Nao_Eff, 1.0600000000000001) * 31.148585460707125)); // dimensionless
        const double var_sodium_potassium_pump__p_E1Na = 1.0 / (1.0 + (pow(4.0499999999999998 / var_chaste_interface__internal_ion_concentrations__Nai, 1.0600000000000001) * (1.0 + pow(var_chaste_interface__internal_ion_concentrations__Ki * 0.030413625304136251, 1.1200000000000001)))); // dimensionless
        const double var_sodium_potassium_pump__k1 = 0.37 / (1.0 + (0.094 / var_chaste_interface__ATP_production__ATPi)); // per_millisecond
        const double var_sodium_potassium_pump__i_NaK = var_membrane__Cm * ((var_sodium_potassium_pump__k1 * var_sodium_potassium_pump__p_E1Na * var_chaste_interface__sodium_potassium_pump_y_gate__y) - (0.040000000000000001 * var_sodium_potassium_pump__p_E2Na * (1.0 - var_chaste_interface__sodium_potassium_pump_y_gate__y))) * 21.0; // picoA
        const double var_background_Kpl_current__i_Kpl = (var_chaste_interface__membrane__Vm ==  -3.0) ? (var_constant_field_equations__CF_K * 0.0014308470000000001) : ((0.00011 * var_constant_field_equations__CF_K * (var_chaste_interface__membrane__Vm + 3.0)) / (1.0 - exp((-(var_chaste_interface__membrane__Vm + 3.0)) * 0.076923076923076927))); // picoA
        const double var_background_lCa_current__p_open = 1.0 / (1.0 + pow(0.0011999999999999999 / var_internal_ion_concentrations__Cai, 3.0)); // dimensionless
        const double var_background_lCa_current__i_lCa_Na = 0.11 * var_constant_field_equations__CF_Na * var_background_lCa_current__p_open; // picoA
        const double var_background_lCa_current__i_lCa_K = 0.11 * var_constant_field_equations__CF_K * var_background_lCa_current__p_open; // picoA
        const double var_background_KATP_current__i_KATP = 82.527985493953864 * (var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) * (0.80000000000000004 / (1.0 + pow(var_chaste_interface__ATP_production__ATPi * 10.0, 2.0))); // picoA
        const double var_background_Cab_current__i_Cab = 0.040000000000000001 * var_constant_field_equations__CF_Ca; // picoA
        const double var_background_NSC_current__i_bNSC_K = var_constant_field_equations__CF_K * 0.15400000000000003; // picoA
        const double var_background_NSC_current__i_bNSC_Na = 0.38500000000000001 * var_constant_field_equations__CF_Na; // picoA
        const double var_T_type_Ca_channel__i_Ca_T = 612.0 * var_constant_field_equations__CF_Ca * var_chaste_interface__T_type_Ca_channel_y1_gate__y1 * var_chaste_interface__T_type_Ca_channel_y2_gate__y2; // picoA
        const double var_transient_outward_current__i_to_Na = 0.00297 * var_constant_field_equations__CF_Na * pow(var_chaste_interface__transient_outward_current_y1_gate__y1, 3.0) * var_chaste_interface__transient_outward_current_y2_gate__y2; // picoA
        const double var_transient_outward_current__i_to_K = 0.033000000000000002 * var_constant_field_equations__CF_K * pow(var_chaste_interface__transient_outward_current_y1_gate__y1, 3.0) * var_chaste_interface__transient_outward_current_y2_gate__y2; // picoA
        const double var_slow_time_dependent_potassium_current__i_Ks_Na = 0.2016 * var_constant_field_equations__CF_Na * pow(var_chaste_interface__slow_time_dependent_potassium_current_y1_gate__y1, 2.0) * ((0.90000000000000002 * var_chaste_interface__slow_time_dependent_potassium_current_y2_gate__y2) + 0.10000000000000001); // picoA
        const double var_slow_time_dependent_potassium_current__i_Ks_K = 5.04 * var_constant_field_equations__CF_K * pow(var_chaste_interface__slow_time_dependent_potassium_current_y1_gate__y1, 2.0) * ((0.90000000000000002 * var_chaste_interface__slow_time_dependent_potassium_current_y2_gate__y2) + 0.10000000000000001); // picoA
        const double var_time_independent_potassium_current__mu = (0.75 * exp(0.035000000000000003 * ((var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) - 10.0))) / (1.0 + exp(0.014999999999999999 * ((var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) - 140.0))); // per_millisecond
        const double var_time_independent_potassium_current__lambda = (3.0 * exp( -0.048000000000000001 * ((var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) - 10.0)) * (1.0 + exp(0.064000000000000001 * ((var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) - 38.0)))) / (1.0 + exp(0.029999999999999999 * ((var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) - 70.0))); // per_millisecond
        const double var_time_independent_potassium_current__fO = var_time_independent_potassium_current__lambda / (var_time_independent_potassium_current__mu + var_time_independent_potassium_current__lambda); // dimensionless
        const double var_time_independent_potassium_current__fB = var_time_independent_potassium_current__mu / (var_time_independent_potassium_current__mu + var_time_independent_potassium_current__lambda); // dimensionless
        const double var_time_independent_potassium_current__i_K1 = (var_membrane__Cm * 1.1459999999999999) * (var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) * (pow(var_time_independent_potassium_current__fO, 4.0) + (2.6666666666666665 * pow(var_time_independent_potassium_current__fO, 3.0) * var_time_independent_potassium_current__fB) + (2.0 * pow(var_time_independent_potassium_current__fO, 2.0) * pow(var_time_independent_potassium_current__fB, 2.0))) * var_chaste_interface__time_independent_potassium_current_y_gate__y; // picoA
        const double var_membrane__i_tot = (var_sodium_current__i_Na_Na + var_sodium_current__i_Na_K) + (var_L_type_Ca_channel__i_CaL_Na + var_L_type_Ca_channel__i_CaL_Ca + var_L_type_Ca_channel__i_CaL_K) + var_T_type_Ca_channel__i_Ca_T + var_time_independent_potassium_current__i_K1 + var_rapid_time_dependent_potassium_current__i_Kr + (var_slow_time_dependent_potassium_current__i_Ks_Na + var_slow_time_dependent_potassium_current__i_Ks_K) + (var_transient_outward_current__i_to_Na + var_transient_outward_current__i_to_K) + ((var_background_NSC_current__i_bNSC_K + var_background_NSC_current__i_bNSC_Na) + var_background_Cab_current__i_Cab + var_background_Kpl_current__i_Kpl + (var_background_lCa_current__i_lCa_K + var_background_lCa_current__i_lCa_Na) + var_background_KATP_current__i_KATP) + var_sodium_potassium_pump__i_NaK + var_sodium_calcium_exchanger__i_NaCa; // picoA
        const double var_chaste_interface__i_ionic = ((var_membrane__i_tot) / var_membrane__Cm) * HeartConfig::Instance()->GetCapacitance(); // uA_per_cm2
        
        const double i_ionic = var_chaste_interface__i_ionic;
        EXCEPT_IF_NOT(!std::isnan(i_ionic));
        return i_ionic;
    }
    
    void Dynamicmatsuoka_model_2003FromCellMLRushLarsen::EvaluateEquations(double var_chaste_interface__environment__time, std::vector<double> &rDY, std::vector<double> &rAlphaOrTau, std::vector<double> &rBetaOrInf)
    {
        std::vector<double>& rY = rGetStateVariables();
        double var_chaste_interface__membrane__Vm = (mSetVoltageDerivativeToZero ? this->mFixedVoltage : rY[0]);
        // Units: millivolt; Initial value: -85.95752434460744
        double var_chaste_interface__internal_ion_concentrations__Nai = rY[1];
        // Units: millimolar; Initial value: 4.925761439682025
        double var_chaste_interface__internal_ion_concentrations__Ki = rY[2];
        // Units: millimolar; Initial value: 143.1837333000449
        double var_chaste_interface__internal_ion_concentrations__Ca_Total = rY[3];
        // Units: millimolar; Initial value: 4.0180173572968586e-4
        double var_chaste_interface__ATP_production__ATPi = rY[4];
        // Units: millimolar; Initial value: 4.657102729020499
        double var_chaste_interface__sodium_current_voltage_dependent_gate__p_AP_Na = rY[5];
        // Units: dimensionless; Initial value: 1.779648367445368e-5
        double var_chaste_interface__sodium_current_voltage_dependent_gate__p_RP_Na = rY[6];
        // Units: dimensionless; Initial value: 0.3556412697995689
        double var_chaste_interface__sodium_current_voltage_dependent_gate__p_AI_Na = rY[7];
        // Units: dimensionless; Initial value: 0.40285968661346977
        double var_chaste_interface__sodium_current_ultra_slow_gate__y = rY[8];
        // Units: dimensionless; Initial value: 0.5861887862983165
        double var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AP_CaL = rY[9];
        // Units: dimensionless; Initial value: 1.5445004166497696e-6
        double var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_RP_CaL = rY[10];
        // Units: dimensionless; Initial value: 0.9968480629364956
        double var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AI_CaL = rY[11];
        // Units: dimensionless; Initial value: 8.77325391245903e-4
        double var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_U = rY[12];
        // Units: dimensionless; Initial value: 0.17246483915629204
        double var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_UCa = rY[13];
        // Units: dimensionless; Initial value: 6.098246017787626e-5
        double var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_C = rY[14];
        // Units: dimensionless; Initial value: 0.4250747299372254
        double var_chaste_interface__L_type_Ca_channel_ultra_slow_gate__y = rY[15];
        // Units: dimensionless; Initial value: 0.9985266538252986
        double var_chaste_interface__T_type_Ca_channel_y1_gate__y1 = rY[16];
        // Units: dimensionless; Initial value: 1.6882718240109127e-5
        double var_chaste_interface__T_type_Ca_channel_y2_gate__y2 = rY[17];
        // Units: dimensionless; Initial value: 0.8585352091865849
        double var_chaste_interface__time_independent_potassium_current_y_gate__y = rY[18];
        // Units: dimensionless; Initial value: 0.6080573900752752
        double var_chaste_interface__rapid_time_dependent_potassium_current_y1_gate__y1 = rY[19];
        // Units: dimensionless; Initial value: 0.0018339931180983765
        double var_chaste_interface__rapid_time_dependent_potassium_current_y2_gate__y2 = rY[20];
        // Units: dimensionless; Initial value: 0.20443083454225305
        double var_chaste_interface__rapid_time_dependent_potassium_current_y3_gate__y3 = rY[21];
        // Units: dimensionless; Initial value: 0.967887666264921
        double var_chaste_interface__slow_time_dependent_potassium_current_y1_gate__y1 = rY[22];
        // Units: dimensionless; Initial value: 0.09738789658609195
        double var_chaste_interface__slow_time_dependent_potassium_current_y2_gate__y2 = rY[23];
        // Units: dimensionless; Initial value: 0.09745345578743213
        double var_chaste_interface__transient_outward_current_y1_gate__y1 = rY[24];
        // Units: dimensionless; Initial value: 7.956883250874798e-4
        double var_chaste_interface__transient_outward_current_y2_gate__y2 = rY[25];
        // Units: dimensionless; Initial value: 0.9999125083105881
        double var_chaste_interface__sodium_calcium_exchanger_y_gate__y = rY[26];
        // Units: dimensionless; Initial value: 0.9891789193465331
        double var_chaste_interface__sodium_potassium_pump_y_gate__y = rY[27];
        // Units: dimensionless; Initial value: 0.5910747147428818
        double var_chaste_interface__SR_calcium_pump_y_gate__y = rY[28];
        // Units: dimensionless; Initial value: 0.46108441538480216
        double var_chaste_interface__RyR_channel__p_open_RyR = rY[29];
        // Units: dimensionless; Initial value: 3.4314360001543243e-4
        double var_chaste_interface__RyR_channel__p_close_RyR = rY[30];
        // Units: dimensionless; Initial value: 0.19135178123107768
        double var_chaste_interface__Ca_concentrations_in_SR__Ca_Total = rY[31];
        // Units: millimolar; Initial value: 9.455741736977666
        double var_chaste_interface__Ca_concentrations_in_SR__Caup = rY[32];
        // Units: millimolar; Initial value: 2.611712901567567
        double var_chaste_interface__NL_model__pCa = rY[33];
        // Units: dimensionless; Initial value: 0.02490898775497523
        double var_chaste_interface__NL_model__pCaCB = rY[34];
        // Units: dimensionless; Initial value: 0.001990153835322864
        double var_chaste_interface__NL_model__pCB = rY[35];
        // Units: dimensionless; Initial value: 4.2941813853474524e-4
        double var_chaste_interface__NL_model__X = rY[36];
        // Units: micrometre; Initial value: 0.9573749975411884
        
        
        // Mathematics
        double d_dt_chaste_interface__membrane__Vm;
        const double var_membrane__Cm = 132.0; // picoF
        const double var_chaste_interface__membrane__i_ext = GetIntracellularAreaStimulus(var_chaste_interface__environment__time);
        const double var_constant_field_equations__CF_Na = (var_chaste_interface__membrane__Vm == 0.0) ?  -140.0 : ((((96.486699999999999 * var_chaste_interface__membrane__Vm) * 0.0003879829271992715) * (var_chaste_interface__internal_ion_concentrations__Nai - (140.0 * exp(( -96.486699999999999 * var_chaste_interface__membrane__Vm) * 0.0003879829271992715)))) / (1.0 - exp(( -96.486699999999999 * var_chaste_interface__membrane__Vm) * 0.0003879829271992715))); // millimolar
        const double var_sodium_current__i_Na_Na = 2860.0 * var_constant_field_equations__CF_Na * var_chaste_interface__sodium_current_voltage_dependent_gate__p_AP_Na * var_chaste_interface__sodium_current_ultra_slow_gate__y; // picoA
        const double var_constant_field_equations__CF_K = (var_chaste_interface__membrane__Vm == 0.0) ? var_chaste_interface__internal_ion_concentrations__Ki : ((((96.486699999999999 * var_chaste_interface__membrane__Vm) * 0.0003879829271992715) * (var_chaste_interface__internal_ion_concentrations__Ki - (5.4000000000000004 * exp(( -96.486699999999999 * var_chaste_interface__membrane__Vm) * 0.0003879829271992715)))) / (1.0 - exp(( -96.486699999999999 * var_chaste_interface__membrane__Vm) * 0.0003879829271992715))); // millimolar
        const double var_sodium_current__i_Na_K = var_constant_field_equations__CF_K * var_chaste_interface__sodium_current_voltage_dependent_gate__p_AP_Na * var_chaste_interface__sodium_current_ultra_slow_gate__y * 286.0; // picoA
        const double var_internal_ion_concentrations__b1 = (0.050000000000000003 - var_chaste_interface__internal_ion_concentrations__Ca_Total) + 0.0023800000000000002; // millimolar
        const double var_internal_ion_concentrations__Cai = (sqrt(pow(var_internal_ion_concentrations__b1, 2.0) + (4.0 * (0.0023800000000000002 * var_chaste_interface__internal_ion_concentrations__Ca_Total))) - var_internal_ion_concentrations__b1) * 0.5; // millimolar
        const double var_constant_field_equations__CF_Ca = (var_chaste_interface__membrane__Vm == 0.0) ?  -1.8 : ((((var_chaste_interface__membrane__Vm * 192.9734) * 0.0003879829271992715) * (var_internal_ion_concentrations__Cai - (1.8 * exp((var_chaste_interface__membrane__Vm *  -192.9734) * 0.0003879829271992715)))) / (1.0 - exp((var_chaste_interface__membrane__Vm *  -192.9734) * 0.0003879829271992715))); // millimolar
        const double var_L_type_Ca_channel__p_open_CaL = (var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AP_CaL * (var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_U + var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_UCa) * var_chaste_interface__L_type_Ca_channel_ultra_slow_gate__y) / (1.0 + pow(1.3999999999999999 / var_chaste_interface__ATP_production__ATPi, 3.0)); // dimensionless
        const double var_L_type_Ca_channel__i_CaL_Ca = 8712.0 * var_constant_field_equations__CF_Ca * var_L_type_Ca_channel__p_open_CaL; // picoA
        const double var_L_type_Ca_channel__i_CaL_Na = var_constant_field_equations__CF_Na * var_L_type_Ca_channel__p_open_CaL * 0.16117199999999998; // picoA
        const double var_L_type_Ca_channel__i_CaL_K = var_constant_field_equations__CF_K * var_L_type_Ca_channel__p_open_CaL * 3.1798799999999998; // picoA
        const double var_time_independent_potassium_current__E_K = 26.71283192398538 * log(5.4000000000000004 / var_chaste_interface__internal_ion_concentrations__Ki); // millivolt
        const double var_rapid_time_dependent_potassium_current__i_Kr = (var_membrane__Cm * 0.0086400000000000001) * (var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) * ((0.59999999999999998 * var_chaste_interface__rapid_time_dependent_potassium_current_y1_gate__y1) + (0.40000000000000002 * var_chaste_interface__rapid_time_dependent_potassium_current_y2_gate__y2)) * var_chaste_interface__rapid_time_dependent_potassium_current_y3_gate__y3; // picoA
        const double var_sodium_calcium_exchanger__p_E1Na = 1.0 / (1.0 + (pow(8.75 / var_chaste_interface__internal_ion_concentrations__Nai, 3.0) * (1.0 + (var_internal_ion_concentrations__Cai * 724.63768115942037)))); // dimensionless
        const double var_sodium_calcium_exchanger__k2 = 1.0 * exp((var_chaste_interface__membrane__Vm *  -65.610955999999987) * 0.0003879829271992715); // per_millisecond
        const double var_sodium_calcium_exchanger__k1 = 1.0 * exp((var_chaste_interface__membrane__Vm * 30.875744000000001) * 0.0003879829271992715); // per_millisecond
        const double var_sodium_calcium_exchanger__i_NaCa = var_membrane__Cm * ((var_sodium_calcium_exchanger__k1 * var_sodium_calcium_exchanger__p_E1Na * var_chaste_interface__sodium_calcium_exchanger_y_gate__y) - (var_sodium_calcium_exchanger__k2 * 0.63996521928156069 * (1.0 - var_chaste_interface__sodium_calcium_exchanger_y_gate__y))) * 6.8099999999999996; // picoA
        const double var_sodium_potassium_pump__Nao_Eff = 140.0 * exp((var_chaste_interface__membrane__Vm *  -79.11909399999999) * 0.0003879829271992715); // millimolar
        const double var_sodium_potassium_pump__p_E2Na = 1.0 / (1.0 + (pow(69.799999999999997 / var_sodium_potassium_pump__Nao_Eff, 1.0600000000000001) * 31.148585460707125)); // dimensionless
        const double var_sodium_potassium_pump__p_E1Na = 1.0 / (1.0 + (pow(4.0499999999999998 / var_chaste_interface__internal_ion_concentrations__Nai, 1.0600000000000001) * (1.0 + pow(var_chaste_interface__internal_ion_concentrations__Ki * 0.030413625304136251, 1.1200000000000001)))); // dimensionless
        const double var_sodium_potassium_pump__k1 = 0.37 / (1.0 + (0.094 / var_chaste_interface__ATP_production__ATPi)); // per_millisecond
        const double var_sodium_potassium_pump__i_NaK = var_membrane__Cm * ((var_sodium_potassium_pump__k1 * var_sodium_potassium_pump__p_E1Na * var_chaste_interface__sodium_potassium_pump_y_gate__y) - (0.040000000000000001 * var_sodium_potassium_pump__p_E2Na * (1.0 - var_chaste_interface__sodium_potassium_pump_y_gate__y))) * 21.0; // picoA
        const double var_background_Kpl_current__i_Kpl = (var_chaste_interface__membrane__Vm ==  -3.0) ? (var_constant_field_equations__CF_K * 0.0014308470000000001) : ((0.00011 * var_constant_field_equations__CF_K * (var_chaste_interface__membrane__Vm + 3.0)) / (1.0 - exp((-(var_chaste_interface__membrane__Vm + 3.0)) * 0.076923076923076927))); // picoA
        const double var_background_lCa_current__p_open = 1.0 / (1.0 + pow(0.0011999999999999999 / var_internal_ion_concentrations__Cai, 3.0)); // dimensionless
        const double var_background_lCa_current__i_lCa_Na = 0.11 * var_constant_field_equations__CF_Na * var_background_lCa_current__p_open; // picoA
        const double var_background_lCa_current__i_lCa_K = 0.11 * var_constant_field_equations__CF_K * var_background_lCa_current__p_open; // picoA
        const double var_background_KATP_current__i_KATP = 82.527985493953864 * (var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) * (0.80000000000000004 / (1.0 + pow(var_chaste_interface__ATP_production__ATPi * 10.0, 2.0))); // picoA
        const double var_background_Cab_current__i_Cab = 0.040000000000000001 * var_constant_field_equations__CF_Ca; // picoA
        const double var_background_NSC_current__i_bNSC_K = var_constant_field_equations__CF_K * 0.15400000000000003; // picoA
        const double var_background_NSC_current__i_bNSC_Na = 0.38500000000000001 * var_constant_field_equations__CF_Na; // picoA
        const double var_T_type_Ca_channel__i_Ca_T = 612.0 * var_constant_field_equations__CF_Ca * var_chaste_interface__T_type_Ca_channel_y1_gate__y1 * var_chaste_interface__T_type_Ca_channel_y2_gate__y2; // picoA
        const double var_transient_outward_current__i_to_Na = 0.00297 * var_constant_field_equations__CF_Na * pow(var_chaste_interface__transient_outward_current_y1_gate__y1, 3.0) * var_chaste_interface__transient_outward_current_y2_gate__y2; // picoA
        const double var_transient_outward_current__i_to_K = 0.033000000000000002 * var_constant_field_equations__CF_K * pow(var_chaste_interface__transient_outward_current_y1_gate__y1, 3.0) * var_chaste_interface__transient_outward_current_y2_gate__y2; // picoA
        const double var_slow_time_dependent_potassium_current__i_Ks_Na = 0.2016 * var_constant_field_equations__CF_Na * pow(var_chaste_interface__slow_time_dependent_potassium_current_y1_gate__y1, 2.0) * ((0.90000000000000002 * var_chaste_interface__slow_time_dependent_potassium_current_y2_gate__y2) + 0.10000000000000001); // picoA
        const double var_slow_time_dependent_potassium_current__i_Ks_K = 5.04 * var_constant_field_equations__CF_K * pow(var_chaste_interface__slow_time_dependent_potassium_current_y1_gate__y1, 2.0) * ((0.90000000000000002 * var_chaste_interface__slow_time_dependent_potassium_current_y2_gate__y2) + 0.10000000000000001); // picoA
        const double var_time_independent_potassium_current__mu = (0.75 * exp(0.035000000000000003 * ((var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) - 10.0))) / (1.0 + exp(0.014999999999999999 * ((var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) - 140.0))); // per_millisecond
        const double var_time_independent_potassium_current__lambda = (3.0 * exp( -0.048000000000000001 * ((var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) - 10.0)) * (1.0 + exp(0.064000000000000001 * ((var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) - 38.0)))) / (1.0 + exp(0.029999999999999999 * ((var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) - 70.0))); // per_millisecond
        const double var_time_independent_potassium_current__fO = var_time_independent_potassium_current__lambda / (var_time_independent_potassium_current__mu + var_time_independent_potassium_current__lambda); // dimensionless
        const double var_time_independent_potassium_current__fB = var_time_independent_potassium_current__mu / (var_time_independent_potassium_current__mu + var_time_independent_potassium_current__lambda); // dimensionless
        const double var_time_independent_potassium_current__i_K1 = (var_membrane__Cm * 1.1459999999999999) * (var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) * (pow(var_time_independent_potassium_current__fO, 4.0) + (2.6666666666666665 * pow(var_time_independent_potassium_current__fO, 3.0) * var_time_independent_potassium_current__fB) + (2.0 * pow(var_time_independent_potassium_current__fO, 2.0) * pow(var_time_independent_potassium_current__fB, 2.0))) * var_chaste_interface__time_independent_potassium_current_y_gate__y; // picoA
        const double var_Ca_concentrations_in_SR__b1 = (10.0 - var_chaste_interface__Ca_concentrations_in_SR__Ca_Total) + 0.80000000000000004; // millimolar
        const double var_Ca_concentrations_in_SR__Carel = (sqrt(pow(var_Ca_concentrations_in_SR__b1, 2.0) + (4.0 * (0.80000000000000004 * var_chaste_interface__Ca_concentrations_in_SR__Ca_Total))) - var_Ca_concentrations_in_SR__b1) * 0.5; // millimolar
        const double var_RyR_channel__i_RyR = 62000.0 * (var_Ca_concentrations_in_SR__Carel - var_internal_ion_concentrations__Cai) * var_chaste_interface__RyR_channel__p_open_RyR; // picoA
        const double var_SR_calcium_pump__p_E1Ca = 1.0 / (1.0 + (0.080000000000000002 / var_chaste_interface__Ca_concentrations_in_SR__Caup)); // dimensionless
        const double var_SR_calcium_pump__k2 = 1.0 / (1.0 + (0.10000000000000001 / var_chaste_interface__ATP_production__ATPi)); // per_millisecond
        const double var_SR_calcium_pump__p_E2Ca = 1.0 / (1.0 + (0.00080000000000000004 / var_internal_ion_concentrations__Cai)); // dimensionless
        const double var_SR_calcium_pump__i_SR_U = ((0.01 * var_SR_calcium_pump__p_E1Ca * var_chaste_interface__SR_calcium_pump_y_gate__y) - (var_SR_calcium_pump__k2 * var_SR_calcium_pump__p_E2Ca * (1.0 - var_chaste_interface__SR_calcium_pump_y_gate__y))) * 162500.0; // picoA
        const double var_SR_L_current__i_SR_L = 459.0 * (var_chaste_interface__Ca_concentrations_in_SR__Caup - var_internal_ion_concentrations__Cai); // picoA
        const double var_NL_model__Q_r = (0.029999999999999999 * var_chaste_interface__NL_model__pCaCB) - (1560.0 * var_chaste_interface__NL_model__pCB * var_internal_ion_concentrations__Cai); // per_millisecond
        const double var_NL_model__h = 0.96237999754118841 - var_chaste_interface__NL_model__X; // micrometre
        const double var_NL_model__d_X_d_environment__time = 1.2 * (var_NL_model__h - 0.0050000000000000001); // micrometre_per_millisecond
        const double var_NL_model__Q_d2 = 0.027 * pow(var_NL_model__d_X_d_environment__time, 2.0) * var_chaste_interface__NL_model__pCaCB; // per_millisecond
        const double var_NL_model__Q_b = (39.0 * var_internal_ion_concentrations__Cai * (((1.0 - var_chaste_interface__NL_model__pCa) - var_chaste_interface__NL_model__pCaCB) - var_chaste_interface__NL_model__pCB)) - (0.029999999999999999 * var_chaste_interface__NL_model__pCa); // per_millisecond
        const double var_sodium_current_voltage_dependent_gate__k_RP_AP = 1.0 / ((0.1027 * exp((-var_chaste_interface__membrane__Vm) * 0.125)) + (0.25 * exp((-var_chaste_interface__membrane__Vm) * 0.02))); // per_millisecond
        const double var_sodium_current_voltage_dependent_gate__k_AP_AI = 1.0 / (0.80000000000000004 * exp((-var_chaste_interface__membrane__Vm) * 0.0025000000000000001)); // per_millisecond
        const double var_sodium_current_voltage_dependent_gate__k_AP_RP = 1.0 / ((26.0 * exp(var_chaste_interface__membrane__Vm * 0.058823529411764705)) + (0.02 * exp(var_chaste_interface__membrane__Vm * 0.00125))); // per_millisecond
        const double var_sodium_current_voltage_dependent_gate__p_RI_Na = ((1.0 - var_chaste_interface__sodium_current_voltage_dependent_gate__p_RP_Na) - var_chaste_interface__sodium_current_voltage_dependent_gate__p_AP_Na) - var_chaste_interface__sodium_current_voltage_dependent_gate__p_AI_Na; // dimensionless
        const double var_sodium_current_voltage_dependent_gate__k_RI_AI = 1.0 / ((0.0001027 * exp((-var_chaste_interface__membrane__Vm) * 0.125)) + (5.0 * exp((-var_chaste_interface__membrane__Vm) * 0.0025000000000000001))); // per_millisecond
        const double var_sodium_current_voltage_dependent_gate__k_AI_RI = 1.0 / ((1300.0 * exp(var_chaste_interface__membrane__Vm * 0.050000000000000003)) + (0.040000000000000001 * exp(var_chaste_interface__membrane__Vm * 0.00125))); // per_millisecond
        const double var_sodium_current_voltage_dependent_gate__k_RP_RI = 0.01 / (1.0 + ((8.7499999999999999e-05 * var_sodium_current_voltage_dependent_gate__k_AP_RP * var_sodium_current_voltage_dependent_gate__k_RI_AI) / (var_sodium_current_voltage_dependent_gate__k_AP_AI * var_sodium_current_voltage_dependent_gate__k_RP_AP * var_sodium_current_voltage_dependent_gate__k_AI_RI))); // per_millisecond
        const double var_L_type_Ca_channel_Ca_dependent_gate__iCaL = 0.067599999999999993 * var_constant_field_equations__CF_Ca; // picoA
        const double var_L_type_Ca_channel_voltage_dependent_gate__k_RP_AP = 1.0 / ((0.27000000000000002 * exp((-var_chaste_interface__membrane__Vm) * 0.16949152542372881)) + (1.5 * exp((-var_chaste_interface__membrane__Vm) * 0.015384615384615385))); // per_millisecond
        const double var_L_type_Ca_channel_voltage_dependent_gate__k_AP_RP = 1.0 / ((480.0 * exp(var_chaste_interface__membrane__Vm * 0.14285714285714285)) + (2.2000000000000002 * exp(var_chaste_interface__membrane__Vm * 0.015384615384615385))); // per_millisecond
        const double var_L_type_Ca_channel_voltage_dependent_gate__k_RI_AI = 1.0 / ((0.0018 * exp((-var_chaste_interface__membrane__Vm) * 0.13513513513513511)) + (2.0 * exp((-var_chaste_interface__membrane__Vm) * 0.01))); // per_millisecond
        const double var_L_type_Ca_channel_voltage_dependent_gate__k_AI_RI = 1.0 / ((2200000.0 * exp(var_chaste_interface__membrane__Vm * 0.13513513513513511)) + (11.0 * exp(var_chaste_interface__membrane__Vm * 0.01))); // per_millisecond
        const double var_L_type_Ca_channel_voltage_dependent_gate__k_RP_RI = 0.040000000000000001 / (1.0 + ((0.001 * var_L_type_Ca_channel_voltage_dependent_gate__k_AP_RP * var_L_type_Ca_channel_voltage_dependent_gate__k_RI_AI) / (0.0040000000000000001 * var_L_type_Ca_channel_voltage_dependent_gate__k_RP_AP * var_L_type_Ca_channel_voltage_dependent_gate__k_AI_RI))); // per_millisecond
        const double var_L_type_Ca_channel_voltage_dependent_gate__p_RI_CaL = ((1.0 - var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AP_CaL) - var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_RP_CaL) - var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AI_CaL; // dimensionless
        const double var_L_type_Ca_channel_Ca_dependent_gate__Cacm = var_internal_ion_concentrations__Cai - (0.29999999999999999 * var_L_type_Ca_channel_Ca_dependent_gate__iCaL); // millimolar
        const double var_L_type_Ca_channel_Ca_dependent_gate__CaEffC = var_L_type_Ca_channel_Ca_dependent_gate__Cacm * var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AP_CaL; // millimolar
        const double var_L_type_Ca_channel_Ca_dependent_gate__k_UUCa_Ca = 6.9539999999999997 * (var_L_type_Ca_channel_Ca_dependent_gate__CaEffC + (var_internal_ion_concentrations__Cai * (1.0 - var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AP_CaL))); // per_millisecond
        const double var_L_type_Ca_channel_Ca_dependent_gate__p_CCa = ((1.0 - var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_C) - var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_U) - var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_UCa; // dimensionless
        const double var_RyR_channel__k1 = (280000.0 * pow(var_internal_ion_concentrations__Cai * 1.0, 2.0)) + ( -150.0 * (var_L_type_Ca_channel_Ca_dependent_gate__iCaL * var_L_type_Ca_channel__p_open_CaL)); // per_millisecond
        const double var_SR_T_current__i_SR_T = 386.0 * (var_chaste_interface__Ca_concentrations_in_SR__Caup - var_Ca_concentrations_in_SR__Carel); // picoA
        const double var_NL_model__Q_a = (var_chaste_interface__NL_model__pCa * 0.0016468349681964688) - (0.0038999999999999998 * var_chaste_interface__NL_model__pCaCB); // per_millisecond
        const double d_dt_chaste_interface__internal_ion_concentrations__Nai = (-(var_sodium_current__i_Na_Na + var_slow_time_dependent_potassium_current__i_Ks_Na + var_transient_outward_current__i_to_Na + var_L_type_Ca_channel__i_CaL_Na + var_background_NSC_current__i_bNSC_Na + var_background_lCa_current__i_lCa_Na + (3.0 * var_sodium_potassium_pump__i_NaK) + (3.0 * var_sodium_calcium_exchanger__i_NaCa))) * 1.2955153404562495e-06; // 'millimole per litre per millisecond'
        const double d_dt_chaste_interface__internal_ion_concentrations__Ki = (-(((var_time_independent_potassium_current__i_K1 + var_rapid_time_dependent_potassium_current__i_Kr + var_transient_outward_current__i_to_K + var_background_KATP_current__i_KATP + var_slow_time_dependent_potassium_current__i_Ks_K + var_sodium_current__i_Na_K + var_L_type_Ca_channel__i_CaL_K + var_background_NSC_current__i_bNSC_K + var_background_lCa_current__i_lCa_K + var_background_Kpl_current__i_Kpl) - (2.0 * var_sodium_potassium_pump__i_NaK)) + ((var_chaste_interface__membrane__i_ext * var_membrane__Cm) / HeartConfig::Instance()->GetCapacitance()))) * 1.2955153404562495e-06; // 'millimole per litre per millisecond'
        const double d_dt_chaste_interface__internal_ion_concentrations__Ca_Total = ((-(((((var_L_type_Ca_channel__i_CaL_Ca + var_T_type_Ca_channel__i_Ca_T + var_background_Cab_current__i_Cab) - (2.0 * var_sodium_calcium_exchanger__i_NaCa)) - var_SR_calcium_pump__i_SR_U) - var_RyR_channel__i_RyR) - var_SR_L_current__i_SR_L)) * 6.4775767022812476e-07) + (0.070000000000000007 * ((var_NL_model__Q_d2 + var_NL_model__Q_r) - var_NL_model__Q_b)); // 'millimole per litre per millisecond'
        const double d_dt_chaste_interface__ATP_production__ATPi = (((0.0030000000000000001 * (5.0 - var_chaste_interface__ATP_production__ATPi)) + (var_chaste_interface__NL_model__pCaCB *  -0.028000000000000004)) - (var_sodium_potassium_pump__i_NaK * 1.2955153404562495e-06)) + (var_SR_calcium_pump__i_SR_U * 3.2387883511406238e-07); // 'millimole per litre per millisecond'
        const double d_dt_chaste_interface__sodium_current_voltage_dependent_gate__p_AP_Na = ((var_chaste_interface__sodium_current_voltage_dependent_gate__p_RP_Na * var_sodium_current_voltage_dependent_gate__k_RP_AP) + (var_chaste_interface__sodium_current_voltage_dependent_gate__p_AI_Na * 8.7499999999999999e-05)) - (var_chaste_interface__sodium_current_voltage_dependent_gate__p_AP_Na * (var_sodium_current_voltage_dependent_gate__k_AP_RP + var_sodium_current_voltage_dependent_gate__k_AP_AI)); // per_millisecond
        const double d_dt_chaste_interface__sodium_current_voltage_dependent_gate__p_RP_Na = ((var_chaste_interface__sodium_current_voltage_dependent_gate__p_AP_Na * var_sodium_current_voltage_dependent_gate__k_AP_RP) + (var_sodium_current_voltage_dependent_gate__p_RI_Na * (0.01 - var_sodium_current_voltage_dependent_gate__k_RP_RI))) - (var_chaste_interface__sodium_current_voltage_dependent_gate__p_RP_Na * (var_sodium_current_voltage_dependent_gate__k_RP_RI + var_sodium_current_voltage_dependent_gate__k_RP_AP)); // per_millisecond
        const double d_dt_chaste_interface__sodium_current_voltage_dependent_gate__p_AI_Na = ((var_sodium_current_voltage_dependent_gate__p_RI_Na * var_sodium_current_voltage_dependent_gate__k_RI_AI) + (var_chaste_interface__sodium_current_voltage_dependent_gate__p_AP_Na * var_sodium_current_voltage_dependent_gate__k_AP_AI)) - (var_chaste_interface__sodium_current_voltage_dependent_gate__p_AI_Na * (var_sodium_current_voltage_dependent_gate__k_AI_RI + 8.7499999999999999e-05)); // per_millisecond
        const double d_dt_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AP_CaL = ((var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_RP_CaL * var_L_type_Ca_channel_voltage_dependent_gate__k_RP_AP) + (var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AI_CaL * 0.001)) - (var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AP_CaL * (var_L_type_Ca_channel_voltage_dependent_gate__k_AP_RP + 0.0040000000000000001)); // per_millisecond
        const double d_dt_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_RP_CaL = ((var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AP_CaL * var_L_type_Ca_channel_voltage_dependent_gate__k_AP_RP) + (var_L_type_Ca_channel_voltage_dependent_gate__p_RI_CaL * (0.040000000000000001 - var_L_type_Ca_channel_voltage_dependent_gate__k_RP_RI))) - (var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_RP_CaL * (var_L_type_Ca_channel_voltage_dependent_gate__k_RP_RI + var_L_type_Ca_channel_voltage_dependent_gate__k_RP_AP)); // per_millisecond
        const double d_dt_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AI_CaL = ((var_L_type_Ca_channel_voltage_dependent_gate__p_RI_CaL * var_L_type_Ca_channel_voltage_dependent_gate__k_RI_AI) + (var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AP_CaL * 0.0040000000000000001)) - (var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AI_CaL * (var_L_type_Ca_channel_voltage_dependent_gate__k_AI_RI + 0.001)); // per_millisecond
        const double d_dt_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_U = ((var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_C * 0.14299999999999999) + (var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_UCa * 2.0019999999999998)) - (var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_U * (var_L_type_Ca_channel_Ca_dependent_gate__k_UUCa_Ca + 0.34999999999999998)); // per_millisecond
        const double d_dt_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_UCa = ((var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_U * var_L_type_Ca_channel_Ca_dependent_gate__k_UUCa_Ca) + (var_L_type_Ca_channel_Ca_dependent_gate__p_CCa * 0.00029999999999999997)) - (var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_UCa * 2.3519999999999999); // per_millisecond
        const double d_dt_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_C = ((var_L_type_Ca_channel_Ca_dependent_gate__p_CCa * 0.0041999999999999997) + (var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_U * 0.34999999999999998)) - (var_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_C * (0.14299999999999999 + (6.9539999999999997 * var_L_type_Ca_channel_Ca_dependent_gate__Cacm * var_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AP_CaL))); // per_millisecond
        const double d_dt_chaste_interface__time_independent_potassium_current_y_gate__y = ((1.0 / ((8000.0 * exp(((var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) - 97.0) * 0.11764705882352941)) + (7.0 * exp(((var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) - 97.0) * 0.0033333333333333335)))) * (1.0 - var_chaste_interface__time_independent_potassium_current_y_gate__y)) - (((pow(var_time_independent_potassium_current__fO, 4.0) * 1.0) / ((0.00013999999999999999 * exp((-((var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) - 97.0)) * 0.10989010989010989)) + (0.20000000000000001 * exp((-((var_chaste_interface__membrane__Vm - var_time_independent_potassium_current__E_K) - 97.0)) * 0.002)))) * var_chaste_interface__time_independent_potassium_current_y_gate__y); // per_millisecond
        const double d_dt_chaste_interface__slow_time_dependent_potassium_current_y2_gate__y2 = ((3.7000000000000002 * var_internal_ion_concentrations__Cai) * (1.0 - var_chaste_interface__slow_time_dependent_potassium_current_y2_gate__y2)) - (0.004444 * var_chaste_interface__slow_time_dependent_potassium_current_y2_gate__y2); // per_millisecond
        const double d_dt_chaste_interface__sodium_calcium_exchanger_y_gate__y = (((var_sodium_calcium_exchanger__k2 * 0.63996521928156069) + 0.20379327210477691) * (1.0 - var_chaste_interface__sodium_calcium_exchanger_y_gate__y)) - (((var_sodium_calcium_exchanger__k1 * var_sodium_calcium_exchanger__p_E1Na) + (1.0 * (1.0 / (1.0 + ((0.0013799999999999999 / var_internal_ion_concentrations__Cai) * (1.0 + pow(var_chaste_interface__internal_ion_concentrations__Nai * 0.11428571428571428, 3.0))))))) * var_chaste_interface__sodium_calcium_exchanger_y_gate__y); // per_millisecond
        const double d_dt_chaste_interface__sodium_potassium_pump_y_gate__y = (((0.040000000000000001 * var_sodium_potassium_pump__p_E2Na) + (0.16500000000000001 * (1.0 / (1.0 + (0.033169052037393509 * (1.0 + pow(var_sodium_potassium_pump__Nao_Eff * 0.014326647564469915, 1.0600000000000001))))))) * (1.0 - var_chaste_interface__sodium_potassium_pump_y_gate__y)) - (((var_sodium_potassium_pump__k1 * var_sodium_potassium_pump__p_E1Na) + (0.01 * (1.0 / (1.0 + (pow(32.880000000000003 / var_chaste_interface__internal_ion_concentrations__Ki, 1.1200000000000001) * (1.0 + pow(var_chaste_interface__internal_ion_concentrations__Nai * 0.24691358024691359, 1.0600000000000001))))))) * var_chaste_interface__sodium_potassium_pump_y_gate__y); // per_millisecond
        const double d_dt_chaste_interface__SR_calcium_pump_y_gate__y = (((var_SR_calcium_pump__k2 * var_SR_calcium_pump__p_E2Ca) + (0.01 * (1.0 - var_SR_calcium_pump__p_E2Ca))) * (1.0 - var_chaste_interface__SR_calcium_pump_y_gate__y)) - (((0.01 * var_SR_calcium_pump__p_E1Ca) + (1.0 * (1.0 - var_SR_calcium_pump__p_E1Ca))) * var_chaste_interface__SR_calcium_pump_y_gate__y); // per_millisecond
        const double d_dt_chaste_interface__RyR_channel__p_open_RyR = (var_chaste_interface__RyR_channel__p_close_RyR * var_RyR_channel__k1) - (var_chaste_interface__RyR_channel__p_open_RyR * (0.080000000000000002 / (1.0 + (0.35999999999999999 / var_Ca_concentrations_in_SR__Carel)))); // per_millisecond
        const double d_dt_chaste_interface__RyR_channel__p_close_RyR = ((0.000377 * pow(var_Ca_concentrations_in_SR__Carel * 1.0, 2.0)) * (1.0 - (var_chaste_interface__RyR_channel__p_open_RyR + var_chaste_interface__RyR_channel__p_close_RyR))) - ((var_RyR_channel__k1 + 0.00084900000000000004) * var_chaste_interface__RyR_channel__p_close_RyR); // per_millisecond
        const double d_dt_chaste_interface__Ca_concentrations_in_SR__Ca_Total = (var_SR_T_current__i_SR_T - var_RyR_channel__i_RyR) * 3.2387883511406234e-05; // 'millimole per litre per millisecond'
        const double d_dt_chaste_interface__Ca_concentrations_in_SR__Caup = (((-var_SR_calcium_pump__i_SR_U) - var_SR_T_current__i_SR_T) - var_SR_L_current__i_SR_L) * 1.2955153404562494e-05; // 'millimole per litre per millisecond'
        const double d_dt_chaste_interface__NL_model__pCa = var_NL_model__Q_b - var_NL_model__Q_a; // per_millisecond
        const double d_dt_chaste_interface__NL_model__pCaCB = (var_NL_model__Q_a - var_NL_model__Q_r) - var_NL_model__Q_d2; // per_millisecond
        const double d_dt_chaste_interface__NL_model__pCB = (var_NL_model__Q_r - (0.12 * var_chaste_interface__NL_model__pCB)) - (0.027 * pow(var_NL_model__d_X_d_environment__time, 2.0) * var_chaste_interface__NL_model__pCB); // per_millisecond
        const double d_dt_chaste_interface__NL_model__X = var_NL_model__d_X_d_environment__time; // micrometre_per_millisecond
        
        if (mSetVoltageDerivativeToZero)
        {
            d_dt_chaste_interface__membrane__Vm = 0.0;
        }
        else
        {
            const double var_membrane__i_tot = (var_sodium_current__i_Na_Na + var_sodium_current__i_Na_K) + (var_L_type_Ca_channel__i_CaL_Na + var_L_type_Ca_channel__i_CaL_Ca + var_L_type_Ca_channel__i_CaL_K) + var_T_type_Ca_channel__i_Ca_T + var_time_independent_potassium_current__i_K1 + var_rapid_time_dependent_potassium_current__i_Kr + (var_slow_time_dependent_potassium_current__i_Ks_Na + var_slow_time_dependent_potassium_current__i_Ks_K) + (var_transient_outward_current__i_to_Na + var_transient_outward_current__i_to_K) + ((var_background_NSC_current__i_bNSC_K + var_background_NSC_current__i_bNSC_Na) + var_background_Cab_current__i_Cab + var_background_Kpl_current__i_Kpl + (var_background_lCa_current__i_lCa_K + var_background_lCa_current__i_lCa_Na) + var_background_KATP_current__i_KATP) + var_sodium_potassium_pump__i_NaK + var_sodium_calcium_exchanger__i_NaCa; // picoA
            d_dt_chaste_interface__membrane__Vm = (-(var_membrane__i_tot + ((var_chaste_interface__membrane__i_ext * var_membrane__Cm) / HeartConfig::Instance()->GetCapacitance()))) / var_membrane__Cm; // 'millivolt per millisecond'
        }
        
        rDY[0] = d_dt_chaste_interface__membrane__Vm;
        rDY[1] = d_dt_chaste_interface__internal_ion_concentrations__Nai;
        rDY[2] = d_dt_chaste_interface__internal_ion_concentrations__Ki;
        rDY[3] = d_dt_chaste_interface__internal_ion_concentrations__Ca_Total;
        rDY[4] = d_dt_chaste_interface__ATP_production__ATPi;
        rDY[5] = d_dt_chaste_interface__sodium_current_voltage_dependent_gate__p_AP_Na;
        rDY[6] = d_dt_chaste_interface__sodium_current_voltage_dependent_gate__p_RP_Na;
        rDY[7] = d_dt_chaste_interface__sodium_current_voltage_dependent_gate__p_AI_Na;
        rAlphaOrTau[8] = 1.0 / ((9000000000.0 * exp(var_chaste_interface__membrane__Vm * 0.20000000000000001)) + (8000.0 * exp(var_chaste_interface__membrane__Vm * 0.01)));
        rBetaOrInf[8] = 1.0 / ((0.014 * exp((-var_chaste_interface__membrane__Vm) * 0.20000000000000001)) + (4000.0 * exp((-var_chaste_interface__membrane__Vm) * 0.01)));
        rDY[9] = d_dt_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AP_CaL;
        rDY[10] = d_dt_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_RP_CaL;
        rDY[11] = d_dt_chaste_interface__L_type_Ca_channel_voltage_dependent_gate__p_AI_CaL;
        rDY[12] = d_dt_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_U;
        rDY[13] = d_dt_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_UCa;
        rDY[14] = d_dt_chaste_interface__L_type_Ca_channel_Ca_dependent_gate__p_C;
        rAlphaOrTau[15] = 1.0 / ((250000.0 * exp(var_chaste_interface__membrane__Vm * 0.1111111111111111)) + (58.0 * exp(var_chaste_interface__membrane__Vm * 0.015384615384615385)));
        rBetaOrInf[15] = 1.0 / ((1800.0 * exp((-var_chaste_interface__membrane__Vm) * 0.071428571428571425)) + (66.0 * exp((-var_chaste_interface__membrane__Vm) * 0.015384615384615385)));
        rAlphaOrTau[16] = 1.0 / ((0.019 * exp((-var_chaste_interface__membrane__Vm) * 0.17857142857142858)) + (0.81999999999999995 * exp((-var_chaste_interface__membrane__Vm) * 0.0040000000000000001)));
        rBetaOrInf[16] = 1.0 / ((40.0 * exp(var_chaste_interface__membrane__Vm * 0.15873015873015872)) + (1.5 * exp(var_chaste_interface__membrane__Vm * 0.0001)));
        rAlphaOrTau[17] = 1.0 / ((62000.0 * exp(var_chaste_interface__membrane__Vm * 0.099009900990099015)) + (30.0 * exp(var_chaste_interface__membrane__Vm * 0.00033333333333333332)));
        rBetaOrInf[17] = 1.0 / ((0.00059999999999999995 * exp((-var_chaste_interface__membrane__Vm) * 0.14925373134328357)) + (1.2 * exp((-var_chaste_interface__membrane__Vm) * 0.040000000000000001)));
        rDY[18] = d_dt_chaste_interface__time_independent_potassium_current_y_gate__y;
        rAlphaOrTau[19] = 1.0 / ((20.0 * exp((-var_chaste_interface__membrane__Vm) * 0.086956521739130432)) + (5.0 * exp((-var_chaste_interface__membrane__Vm) * 0.0033333333333333335)));
        rBetaOrInf[19] = (1.0 / ((160.0 * exp(var_chaste_interface__membrane__Vm * 0.035714285714285712)) + (200.0 * exp(var_chaste_interface__membrane__Vm * 0.001)))) + (1.0 / (2500.0 * exp(var_chaste_interface__membrane__Vm * 0.050000000000000003)));
        rAlphaOrTau[20] = 1.0 / ((200.0 * exp((-var_chaste_interface__membrane__Vm) * 0.076923076923076927)) + (20.0 * exp((-var_chaste_interface__membrane__Vm) * 0.0033333333333333335)));
        rBetaOrInf[20] = (1.0 / ((1600.0 * exp(var_chaste_interface__membrane__Vm * 0.035714285714285712)) + (2000.0 * exp(var_chaste_interface__membrane__Vm * 0.001)))) + (1.0 / (10000.0 * exp(var_chaste_interface__membrane__Vm * 0.050000000000000003)));
        rAlphaOrTau[21] = 1.0 / ((10.0 * exp(var_chaste_interface__membrane__Vm * 0.058823529411764705)) + (2.5 * exp(var_chaste_interface__membrane__Vm * 0.0033333333333333335)));
        rBetaOrInf[21] = 1.0 / ((0.34999999999999998 * exp((-var_chaste_interface__membrane__Vm) * 0.058823529411764705)) + (2.0 * exp((-var_chaste_interface__membrane__Vm) * 0.0066666666666666671)));
        rAlphaOrTau[22] = 1.0 / ((85.0 * exp((-var_chaste_interface__membrane__Vm) * 0.095238095238095233)) + (370.0 * exp((-var_chaste_interface__membrane__Vm) * 0.016129032258064516)));
        rBetaOrInf[22] = 1.0 / ((1450.0 * exp(var_chaste_interface__membrane__Vm * 0.050000000000000003)) + (260.0 * exp(var_chaste_interface__membrane__Vm * 0.01)));
        rDY[23] = d_dt_chaste_interface__slow_time_dependent_potassium_current_y2_gate__y2;
        rAlphaOrTau[24] = 1.0 / ((11.0 * exp((-var_chaste_interface__membrane__Vm) * 0.035714285714285712)) + (0.20000000000000001 * exp((-var_chaste_interface__membrane__Vm) * 0.0025000000000000001)));
        rBetaOrInf[24] = 1.0 / ((4.4000000000000004 * exp(var_chaste_interface__membrane__Vm * 0.0625)) + (0.20000000000000001 * exp(var_chaste_interface__membrane__Vm * 0.002)));
        rAlphaOrTau[25] = (0.0038 * exp((-(var_chaste_interface__membrane__Vm + 13.5)) * 0.088495575221238937)) / (1.0 + (0.051334999999999999 * exp((-(var_chaste_interface__membrane__Vm + 13.5)) * 0.088495575221238937)));
        rBetaOrInf[25] = (0.0038 * exp((var_chaste_interface__membrane__Vm + 13.5) * 0.088495575221238937)) / (1.0 + (0.067083000000000004 * exp((var_chaste_interface__membrane__Vm + 13.5) * 0.088495575221238937)));
        rDY[26] = d_dt_chaste_interface__sodium_calcium_exchanger_y_gate__y;
        rDY[27] = d_dt_chaste_interface__sodium_potassium_pump_y_gate__y;
        rDY[28] = d_dt_chaste_interface__SR_calcium_pump_y_gate__y;
        rDY[29] = d_dt_chaste_interface__RyR_channel__p_open_RyR;
        rDY[30] = d_dt_chaste_interface__RyR_channel__p_close_RyR;
        rDY[31] = d_dt_chaste_interface__Ca_concentrations_in_SR__Ca_Total;
        rDY[32] = d_dt_chaste_interface__Ca_concentrations_in_SR__Caup;
        rDY[33] = d_dt_chaste_interface__NL_model__pCa;
        rDY[34] = d_dt_chaste_interface__NL_model__pCaCB;
        rDY[35] = d_dt_chaste_interface__NL_model__pCB;
        rDY[36] = d_dt_chaste_interface__NL_model__X;
    }
    
    void Dynamicmatsuoka_model_2003FromCellMLRushLarsen::ComputeOneStepExceptVoltage(const std::vector<double> &rDY, const std::vector<double> &rAlphaOrTau, const std::vector<double> &rBetaOrInf)
    {
        std::vector<double>& rY = rGetStateVariables();
        rY[1] += mDt * rDY[1];
        rY[2] += mDt * rDY[2];
        rY[3] += mDt * rDY[3];
        rY[4] += mDt * rDY[4];
        rY[5] += mDt * rDY[5];
        rY[6] += mDt * rDY[6];
        rY[7] += mDt * rDY[7];
        {
            const double tau_inv = rAlphaOrTau[8] + rBetaOrInf[8];
            const double y_inf = rAlphaOrTau[8] / tau_inv;
            rY[8] = y_inf + (rY[8] - y_inf)*exp(-mDt*tau_inv);
        }
        rY[9] += mDt * rDY[9];
        rY[10] += mDt * rDY[10];
        rY[11] += mDt * rDY[11];
        rY[12] += mDt * rDY[12];
        rY[13] += mDt * rDY[13];
        rY[14] += mDt * rDY[14];
        {
            const double tau_inv = rAlphaOrTau[15] + rBetaOrInf[15];
            const double y_inf = rAlphaOrTau[15] / tau_inv;
            rY[15] = y_inf + (rY[15] - y_inf)*exp(-mDt*tau_inv);
        }
        {
            const double tau_inv = rAlphaOrTau[16] + rBetaOrInf[16];
            const double y_inf = rAlphaOrTau[16] / tau_inv;
            rY[16] = y_inf + (rY[16] - y_inf)*exp(-mDt*tau_inv);
        }
        {
            const double tau_inv = rAlphaOrTau[17] + rBetaOrInf[17];
            const double y_inf = rAlphaOrTau[17] / tau_inv;
            rY[17] = y_inf + (rY[17] - y_inf)*exp(-mDt*tau_inv);
        }
        rY[18] += mDt * rDY[18];
        {
            const double tau_inv = rAlphaOrTau[19] + rBetaOrInf[19];
            const double y_inf = rAlphaOrTau[19] / tau_inv;
            rY[19] = y_inf + (rY[19] - y_inf)*exp(-mDt*tau_inv);
        }
        {
            const double tau_inv = rAlphaOrTau[20] + rBetaOrInf[20];
            const double y_inf = rAlphaOrTau[20] / tau_inv;
            rY[20] = y_inf + (rY[20] - y_inf)*exp(-mDt*tau_inv);
        }
        {
            const double tau_inv = rAlphaOrTau[21] + rBetaOrInf[21];
            const double y_inf = rAlphaOrTau[21] / tau_inv;
            rY[21] = y_inf + (rY[21] - y_inf)*exp(-mDt*tau_inv);
        }
        {
            const double tau_inv = rAlphaOrTau[22] + rBetaOrInf[22];
            const double y_inf = rAlphaOrTau[22] / tau_inv;
            rY[22] = y_inf + (rY[22] - y_inf)*exp(-mDt*tau_inv);
        }
        rY[23] += mDt * rDY[23];
        {
            const double tau_inv = rAlphaOrTau[24] + rBetaOrInf[24];
            const double y_inf = rAlphaOrTau[24] / tau_inv;
            rY[24] = y_inf + (rY[24] - y_inf)*exp(-mDt*tau_inv);
        }
        {
            const double tau_inv = rAlphaOrTau[25] + rBetaOrInf[25];
            const double y_inf = rAlphaOrTau[25] / tau_inv;
            rY[25] = y_inf + (rY[25] - y_inf)*exp(-mDt*tau_inv);
        }
        rY[26] += mDt * rDY[26];
        rY[27] += mDt * rDY[27];
        rY[28] += mDt * rDY[28];
        rY[29] += mDt * rDY[29];
        rY[30] += mDt * rDY[30];
        rY[31] += mDt * rDY[31];
        rY[32] += mDt * rDY[32];
        rY[33] += mDt * rDY[33];
        rY[34] += mDt * rDY[34];
        rY[35] += mDt * rDY[35];
        rY[36] += mDt * rDY[36];
    }
    
template<>
void OdeSystemInformation<Dynamicmatsuoka_model_2003FromCellMLRushLarsen>::Initialise(void)
{
    this->mSystemName = "matsuoka_model_2003";
    this->mFreeVariableName = "environment__time";
    this->mFreeVariableUnits = "millisecond";
    
    // rY[0]:
    this->mVariableNames.push_back("membrane_voltage");
    this->mVariableUnits.push_back("millivolt");
    this->mInitialConditions.push_back(-85.95752434460744);

    // rY[1]:
    this->mVariableNames.push_back("internal_ion_concentrations__Nai");
    this->mVariableUnits.push_back("millimolar");
    this->mInitialConditions.push_back(4.925761439682025);

    // rY[2]:
    this->mVariableNames.push_back("internal_ion_concentrations__Ki");
    this->mVariableUnits.push_back("millimolar");
    this->mInitialConditions.push_back(143.1837333000449);

    // rY[3]:
    this->mVariableNames.push_back("internal_ion_concentrations__Ca_Total");
    this->mVariableUnits.push_back("millimolar");
    this->mInitialConditions.push_back(4.0180173572968586e-4);

    // rY[4]:
    this->mVariableNames.push_back("ATP_production__ATPi");
    this->mVariableUnits.push_back("millimolar");
    this->mInitialConditions.push_back(4.657102729020499);

    // rY[5]:
    this->mVariableNames.push_back("sodium_current_voltage_dependent_gate__p_AP_Na");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(1.779648367445368e-5);

    // rY[6]:
    this->mVariableNames.push_back("sodium_current_voltage_dependent_gate__p_RP_Na");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.3556412697995689);

    // rY[7]:
    this->mVariableNames.push_back("sodium_current_voltage_dependent_gate__p_AI_Na");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.40285968661346977);

    // rY[8]:
    this->mVariableNames.push_back("sodium_current_ultra_slow_gate__y");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.5861887862983165);

    // rY[9]:
    this->mVariableNames.push_back("L_type_Ca_channel_voltage_dependent_gate__p_AP_CaL");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(1.5445004166497696e-6);

    // rY[10]:
    this->mVariableNames.push_back("L_type_Ca_channel_voltage_dependent_gate__p_RP_CaL");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.9968480629364956);

    // rY[11]:
    this->mVariableNames.push_back("L_type_Ca_channel_voltage_dependent_gate__p_AI_CaL");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(8.77325391245903e-4);

    // rY[12]:
    this->mVariableNames.push_back("L_type_Ca_channel_Ca_dependent_gate__p_U");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.17246483915629204);

    // rY[13]:
    this->mVariableNames.push_back("L_type_Ca_channel_Ca_dependent_gate__p_UCa");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(6.098246017787626e-5);

    // rY[14]:
    this->mVariableNames.push_back("L_type_Ca_channel_Ca_dependent_gate__p_C");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.4250747299372254);

    // rY[15]:
    this->mVariableNames.push_back("L_type_Ca_channel_ultra_slow_gate__y");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.9985266538252986);

    // rY[16]:
    this->mVariableNames.push_back("T_type_Ca_channel_y1_gate__y1");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(1.6882718240109127e-5);

    // rY[17]:
    this->mVariableNames.push_back("T_type_Ca_channel_y2_gate__y2");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.8585352091865849);

    // rY[18]:
    this->mVariableNames.push_back("time_independent_potassium_current_y_gate__y");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.6080573900752752);

    // rY[19]:
    this->mVariableNames.push_back("rapid_time_dependent_potassium_current_y1_gate__y1");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.0018339931180983765);

    // rY[20]:
    this->mVariableNames.push_back("rapid_time_dependent_potassium_current_y2_gate__y2");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.20443083454225305);

    // rY[21]:
    this->mVariableNames.push_back("rapid_time_dependent_potassium_current_y3_gate__y3");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.967887666264921);

    // rY[22]:
    this->mVariableNames.push_back("slow_time_dependent_potassium_current_y1_gate__y1");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.09738789658609195);

    // rY[23]:
    this->mVariableNames.push_back("slow_time_dependent_potassium_current_y2_gate__y2");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.09745345578743213);

    // rY[24]:
    this->mVariableNames.push_back("transient_outward_current_y1_gate__y1");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(7.956883250874798e-4);

    // rY[25]:
    this->mVariableNames.push_back("transient_outward_current_y2_gate__y2");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.9999125083105881);

    // rY[26]:
    this->mVariableNames.push_back("sodium_calcium_exchanger_y_gate__y");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.9891789193465331);

    // rY[27]:
    this->mVariableNames.push_back("sodium_potassium_pump_y_gate__y");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.5910747147428818);

    // rY[28]:
    this->mVariableNames.push_back("SR_calcium_pump_y_gate__y");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.46108441538480216);

    // rY[29]:
    this->mVariableNames.push_back("RyR_channel__p_open_RyR");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(3.4314360001543243e-4);

    // rY[30]:
    this->mVariableNames.push_back("RyR_channel__p_close_RyR");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.19135178123107768);

    // rY[31]:
    this->mVariableNames.push_back("Ca_concentrations_in_SR__Ca_Total");
    this->mVariableUnits.push_back("millimolar");
    this->mInitialConditions.push_back(9.455741736977666);

    // rY[32]:
    this->mVariableNames.push_back("Ca_concentrations_in_SR__Caup");
    this->mVariableUnits.push_back("millimolar");
    this->mInitialConditions.push_back(2.611712901567567);

    // rY[33]:
    this->mVariableNames.push_back("NL_model__pCa");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.02490898775497523);

    // rY[34]:
    this->mVariableNames.push_back("NL_model__pCaCB");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.001990153835322864);

    // rY[35]:
    this->mVariableNames.push_back("NL_model__pCB");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(4.2941813853474524e-4);

    // rY[36]:
    this->mVariableNames.push_back("NL_model__X");
    this->mVariableUnits.push_back("micrometre");
    this->mInitialConditions.push_back(0.9573749975411884);

    this->mInitialised = true;
}


// Serialization for Boost >= 1.36
#include "SerializationExportWrapperForCpp.hpp"
CHASTE_CLASS_EXPORT(Dynamicmatsuoka_model_2003FromCellMLRushLarsen)
extern "C"
{
    AbstractCardiacCellInterface* MakeCardiacCell(
            boost::shared_ptr<AbstractIvpOdeSolver> pSolver,
            boost::shared_ptr<AbstractStimulusFunction> pStimulus)
    {
        return new Dynamicmatsuoka_model_2003FromCellMLRushLarsen(pSolver, pStimulus);
    }
    
}

