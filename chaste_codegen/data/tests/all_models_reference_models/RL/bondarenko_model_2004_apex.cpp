//! @file
//! 
//! This source file was generated from CellML.
//! 
//! Model: bondarenko_model_2004_apex
//! 
//! Processed by pycml - CellML Tools in Python
//!     (translators: , pycml: , optimize: )
//! on (date omitted as unimportant)
//! 
//! <autogenerated>

#include "bondarenko_model_2004_apex.hpp"
#include <cmath>
#include <cassert>
#include <memory>
#include "Exception.hpp"
#include "OdeSystemInformation.hpp"
#include "RegularStimulus.hpp"
#include "HeartConfig.hpp"
#include "IsNan.hpp"
#include "MathsCustomFunctions.hpp"

    boost::shared_ptr<RegularStimulus> Dynamicbondarenko_model_2004_apexFromCellMLRushLarsen::UseCellMLDefaultStimulus()
    {
        // Use the default stimulus specified by CellML metadata
        const double var_chaste_interface__membrane__stim_start = 20.0; // millisecond
        const double var_chaste_interface__membrane__stim_period = 71.430000000000007; // millisecond
        const double var_chaste_interface__membrane__stim_duration = 0.5; // millisecond
        const double var_chaste_interface__membrane__stim_amplitude =  -80.0 * HeartConfig::Instance()->GetCapacitance(); // uA_per_cm2
        boost::shared_ptr<RegularStimulus> p_cellml_stim(new RegularStimulus(
                -fabs(var_chaste_interface__membrane__stim_amplitude),
                var_chaste_interface__membrane__stim_duration,
                var_chaste_interface__membrane__stim_period,
                var_chaste_interface__membrane__stim_start
                ));
        mpIntracellularStimulus = p_cellml_stim;
        return p_cellml_stim;
    }
    
    Dynamicbondarenko_model_2004_apexFromCellMLRushLarsen::Dynamicbondarenko_model_2004_apexFromCellMLRushLarsen(boost::shared_ptr<AbstractIvpOdeSolver> /* unused; should be empty */, boost::shared_ptr<AbstractStimulusFunction> pIntracellularStimulus)
        : AbstractRushLarsenCardiacCell(
                41,
                0,
                pIntracellularStimulus)
    {
        // Time units: millisecond
        // 
        this->mpSystemInfo = OdeSystemInformation<Dynamicbondarenko_model_2004_apexFromCellMLRushLarsen>::Instance();
        Init();

        // We have a default stimulus specified in the CellML file metadata
        this->mHasDefaultStimulusFromCellML = true;
    }
    
    Dynamicbondarenko_model_2004_apexFromCellMLRushLarsen::~Dynamicbondarenko_model_2004_apexFromCellMLRushLarsen()
    {
    }
    
    double Dynamicbondarenko_model_2004_apexFromCellMLRushLarsen::GetIIonic(const std::vector<double>* pStateVariables)
    {
        // For state variable interpolation (SVI) we read in interpolated state variables,
        // otherwise for ionic current interpolation (ICI) we use the state variables of this model (node).
        if (!pStateVariables) pStateVariables = &rGetStateVariables();
        const std::vector<double>& rY = *pStateVariables;
        double var_chaste_interface__membrane__V = (mSetVoltageDerivativeToZero ? this->mFixedVoltage : rY[0]);
        // Units: millivolt; Initial value: -82.4202
        double var_chaste_interface__calcium_concentration__Cai = rY[1];
        // Units: micromolar; Initial value: 0.115001
        double var_chaste_interface__L_type_calcium_current__O = rY[11];
        // Units: dimensionless; Initial value: 0.930308e-18
        double var_chaste_interface__sodium_concentration__Nai = rY[18];
        // Units: micromolar; Initial value: 14237.1
        double var_chaste_interface__fast_sodium_current__O_Na = rY[19];
        // Units: dimensionless; Initial value: 0.713483e-6
        double var_chaste_interface__potassium_concentration__Ki = rY[27];
        // Units: micromolar; Initial value: 143720
        double var_chaste_interface__fast_transient_outward_potassium_current__ato_f = rY[28];
        // Units: dimensionless; Initial value: 0.265563e-2
        double var_chaste_interface__fast_transient_outward_potassium_current__ito_f = rY[29];
        // Units: dimensionless; Initial value: 0.999977
        double var_chaste_interface__slow_transient_outward_potassium_current__ato_s = rY[30];
        // Units: dimensionless; Initial value: 0.417069e-3
        double var_chaste_interface__slow_transient_outward_potassium_current__ito_s = rY[31];
        // Units: dimensionless; Initial value: 0.998543
        double var_chaste_interface__slow_delayed_rectifier_potassium_current__nKs = rY[32];
        // Units: dimensionless; Initial value: 0.262753e-3
        double var_chaste_interface__ultra_rapidly_activating_delayed_rectifier_potassium_current__aur = rY[33];
        // Units: dimensionless; Initial value: 0.417069e-3
        double var_chaste_interface__ultra_rapidly_activating_delayed_rectifier_potassium_current__iur = rY[34];
        // Units: dimensionless; Initial value: 0.998543
        double var_chaste_interface__non_inactivating_steady_state_potassium_current__aKss = rY[35];
        // Units: dimensionless; Initial value: 0.417069e-3
        double var_chaste_interface__non_inactivating_steady_state_potassium_current__iKss = rY[36];
        // Units: dimensionless; Initial value: 1
        double var_chaste_interface__rapid_delayed_rectifier_potassium_current__O_K = rY[37];
        // Units: dimensionless; Initial value: 0.175298e-3
        
        const double var_L_type_calcium_current__i_CaL = 0.1729 * var_chaste_interface__L_type_calcium_current__O * (var_chaste_interface__membrane__V - 63.0); // picoA_per_picoF
        const double var_calcium_pump_current__i_pCa = (1.0 * pow(var_chaste_interface__calcium_concentration__Cai, 2.0)) / (0.25 + pow(var_chaste_interface__calcium_concentration__Cai, 2.0)); // picoA_per_picoF
        const double var_sodium_calcium_exchange_current__i_NaCa = (2.6970585464294846e-17 / (1.0 + (0.10000000000000001 * exp((var_chaste_interface__membrane__V *  -62.725000000000001) * 0.00040362096439578745)))) * ((exp((var_chaste_interface__membrane__V * 33.774999999999999) * 0.00040362096439578745) * pow(var_chaste_interface__sodium_concentration__Nai, 3.0) * 1800.0) - (exp((var_chaste_interface__membrane__V *  -62.725000000000001) * 0.00040362096439578745) * 2744000000000000.0 * var_chaste_interface__calcium_concentration__Cai)); // picoA_per_picoF
        const double var_calcium_background_current__i_Cab = 0.00036699999999999998 * (var_chaste_interface__membrane__V - (12.837160621761658 * log(1800.0 / var_chaste_interface__calcium_concentration__Cai))); // picoA_per_picoF
        const double var_fast_sodium_current__E_Na = 25.674321243523316 * log(126540.0 / ((0.90000000000000002 * var_chaste_interface__sodium_concentration__Nai) + (0.10000000000000001 * var_chaste_interface__potassium_concentration__Ki))); // millivolt
        const double var_fast_sodium_current__i_Na = 13.0 * var_chaste_interface__fast_sodium_current__O_Na * (var_chaste_interface__membrane__V - var_fast_sodium_current__E_Na); // picoA_per_picoF
        const double var_sodium_background_current__i_Nab = 0.0025999999999999999 * (var_chaste_interface__membrane__V - var_fast_sodium_current__E_Na); // picoA_per_picoF
        const double var_sodium_potassium_pump_current__i_NaK = ((((1.0 / (1.0 + (0.1245 * exp((var_chaste_interface__membrane__V *  -9.6500000000000004) * 0.00040362096439578745)) + (exp(((-var_chaste_interface__membrane__V) * 96.5) * 0.00040362096439578745) * 0.036533226130519084))) * 0.88) / (1.0 + pow(21000.0 / var_chaste_interface__sodium_concentration__Nai, 1.5))) * 5400.0) * 0.00014492753623188405; // picoA_per_picoF
        const double var_fast_transient_outward_potassium_current__E_K = 25.674321243523316 * log(5400.0 / var_chaste_interface__potassium_concentration__Ki); // millivolt
        const double var_fast_transient_outward_potassium_current__i_Kto_f = 0.40670000000000001 * pow(var_chaste_interface__fast_transient_outward_potassium_current__ato_f, 3.0) * var_chaste_interface__fast_transient_outward_potassium_current__ito_f * (var_chaste_interface__membrane__V - var_fast_transient_outward_potassium_current__E_K); // picoA_per_picoF
        const double var_slow_transient_outward_potassium_current__i_Kto_s = 0.0 * var_chaste_interface__slow_transient_outward_potassium_current__ato_s * var_chaste_interface__slow_transient_outward_potassium_current__ito_s * (var_chaste_interface__membrane__V - var_fast_transient_outward_potassium_current__E_K); // picoA_per_picoF
        const double var_time_independent_potassium_current__i_K1 = (0.28280213903743318 * (var_chaste_interface__membrane__V - var_fast_transient_outward_potassium_current__E_K)) / (1.0 + exp(0.089599999999999999 * (var_chaste_interface__membrane__V - var_fast_transient_outward_potassium_current__E_K))); // picoA_per_picoF
        const double var_slow_delayed_rectifier_potassium_current__i_Ks = 0.0057499999999999999 * pow(var_chaste_interface__slow_delayed_rectifier_potassium_current__nKs, 2.0) * (var_chaste_interface__membrane__V - var_fast_transient_outward_potassium_current__E_K); // picoA_per_picoF
        const double var_ultra_rapidly_activating_delayed_rectifier_potassium_current__i_Kur = 0.16 * var_chaste_interface__ultra_rapidly_activating_delayed_rectifier_potassium_current__aur * var_chaste_interface__ultra_rapidly_activating_delayed_rectifier_potassium_current__iur * (var_chaste_interface__membrane__V - var_fast_transient_outward_potassium_current__E_K); // picoA_per_picoF
        const double var_non_inactivating_steady_state_potassium_current__i_Kss = 0.050000000000000003 * var_chaste_interface__non_inactivating_steady_state_potassium_current__aKss * var_chaste_interface__non_inactivating_steady_state_potassium_current__iKss * (var_chaste_interface__membrane__V - var_fast_transient_outward_potassium_current__E_K); // picoA_per_picoF
        const double var_calcium_activated_chloride_current__i_ClCa = ((10.0 * (0.20000000000000001 / (1.0 + exp((-(var_chaste_interface__membrane__V - 46.700000000000003)) * 0.12820512820512822))) * var_chaste_interface__calcium_concentration__Cai) / (var_chaste_interface__calcium_concentration__Cai + 10.0)) * (var_chaste_interface__membrane__V -  -40.0); // picoA_per_picoF
        const double var_rapid_delayed_rectifier_potassium_current__i_Kr = 0.078 * var_chaste_interface__rapid_delayed_rectifier_potassium_current__O_K * (var_chaste_interface__membrane__V - (25.674321243523316 * log(8092.0 / ((0.97999999999999998 * var_chaste_interface__potassium_concentration__Ki) + (0.02 * var_chaste_interface__sodium_concentration__Nai))))); // picoA_per_picoF
        const double var_chaste_interface__i_ionic = (var_L_type_calcium_current__i_CaL + var_calcium_pump_current__i_pCa + var_sodium_calcium_exchange_current__i_NaCa + var_calcium_background_current__i_Cab + var_fast_sodium_current__i_Na + var_sodium_background_current__i_Nab + var_sodium_potassium_pump_current__i_NaK + var_fast_transient_outward_potassium_current__i_Kto_f + var_slow_transient_outward_potassium_current__i_Kto_s + var_time_independent_potassium_current__i_K1 + var_slow_delayed_rectifier_potassium_current__i_Ks + var_ultra_rapidly_activating_delayed_rectifier_potassium_current__i_Kur + var_non_inactivating_steady_state_potassium_current__i_Kss + var_rapid_delayed_rectifier_potassium_current__i_Kr + var_calcium_activated_chloride_current__i_ClCa) * HeartConfig::Instance()->GetCapacitance(); // uA_per_cm2
        
        const double i_ionic = var_chaste_interface__i_ionic;
        EXCEPT_IF_NOT(!std::isnan(i_ionic));
        return i_ionic;
    }
    
    void Dynamicbondarenko_model_2004_apexFromCellMLRushLarsen::EvaluateEquations(double var_chaste_interface__environment__time, std::vector<double> &rDY, std::vector<double> &rAlphaOrTau, std::vector<double> &rBetaOrInf)
    {
        std::vector<double>& rY = rGetStateVariables();
        double var_chaste_interface__membrane__V = (mSetVoltageDerivativeToZero ? this->mFixedVoltage : rY[0]);
        // Units: millivolt; Initial value: -82.4202
        double var_chaste_interface__calcium_concentration__Cai = rY[1];
        // Units: micromolar; Initial value: 0.115001
        double var_chaste_interface__calcium_concentration__Cass = rY[2];
        // Units: micromolar; Initial value: 0.115001
        double var_chaste_interface__calcium_concentration__CaJSR = rY[3];
        // Units: micromolar; Initial value: 1299.5
        double var_chaste_interface__calcium_concentration__CaNSR = rY[4];
        // Units: micromolar; Initial value: 1299.5
        double var_chaste_interface__calcium_fluxes__P_RyR = rY[5];
        // Units: dimensionless; Initial value: 0
        double var_chaste_interface__calcium_buffering__LTRPN_Ca = rY[6];
        // Units: micromolar; Initial value: 11.2684
        double var_chaste_interface__calcium_buffering__HTRPN_Ca = rY[7];
        // Units: micromolar; Initial value: 125.29
        double var_chaste_interface__ryanodine_receptors__P_O1 = rY[8];
        // Units: dimensionless; Initial value: 0.149102e-4
        double var_chaste_interface__ryanodine_receptors__P_O2 = rY[9];
        // Units: dimensionless; Initial value: 0.951726e-10
        double var_chaste_interface__ryanodine_receptors__P_C2 = rY[10];
        // Units: dimensionless; Initial value: 0.16774e-3
        double var_chaste_interface__L_type_calcium_current__O = rY[11];
        // Units: dimensionless; Initial value: 0.930308e-18
        double var_chaste_interface__L_type_calcium_current__C2 = rY[12];
        // Units: dimensionless; Initial value: 0.124216e-3
        double var_chaste_interface__L_type_calcium_current__C3 = rY[13];
        // Units: dimensionless; Initial value: 0.578679e-8
        double var_chaste_interface__L_type_calcium_current__C4 = rY[14];
        // Units: dimensionless; Initial value: 0.119816e-12
        double var_chaste_interface__L_type_calcium_current__I1 = rY[15];
        // Units: dimensionless; Initial value: 0.497923e-18
        double var_chaste_interface__L_type_calcium_current__I2 = rY[16];
        // Units: dimensionless; Initial value: 0.345847e-13
        double var_chaste_interface__L_type_calcium_current__I3 = rY[17];
        // Units: dimensionless; Initial value: 0.185106e-13
        double var_chaste_interface__sodium_concentration__Nai = rY[18];
        // Units: micromolar; Initial value: 14237.1
        double var_chaste_interface__fast_sodium_current__O_Na = rY[19];
        // Units: dimensionless; Initial value: 0.713483e-6
        double var_chaste_interface__fast_sodium_current__C_Na1 = rY[20];
        // Units: dimensionless; Initial value: 0.279132e-3
        double var_chaste_interface__fast_sodium_current__C_Na2 = rY[21];
        // Units: dimensionless; Initial value: 0.020752
        double var_chaste_interface__fast_sodium_current__I1_Na = rY[22];
        // Units: dimensionless; Initial value: 0.673345e-6
        double var_chaste_interface__fast_sodium_current__I2_Na = rY[23];
        // Units: dimensionless; Initial value: 0.155787e-8
        double var_chaste_interface__fast_sodium_current__IF_Na = rY[24];
        // Units: dimensionless; Initial value: 0.153176e-3
        double var_chaste_interface__fast_sodium_current__IC_Na2 = rY[25];
        // Units: dimensionless; Initial value: 0.0113879
        double var_chaste_interface__fast_sodium_current__IC_Na3 = rY[26];
        // Units: dimensionless; Initial value: 0.34278
        double var_chaste_interface__potassium_concentration__Ki = rY[27];
        // Units: micromolar; Initial value: 143720
        double var_chaste_interface__fast_transient_outward_potassium_current__ato_f = rY[28];
        // Units: dimensionless; Initial value: 0.265563e-2
        double var_chaste_interface__fast_transient_outward_potassium_current__ito_f = rY[29];
        // Units: dimensionless; Initial value: 0.999977
        double var_chaste_interface__slow_transient_outward_potassium_current__ato_s = rY[30];
        // Units: dimensionless; Initial value: 0.417069e-3
        double var_chaste_interface__slow_transient_outward_potassium_current__ito_s = rY[31];
        // Units: dimensionless; Initial value: 0.998543
        double var_chaste_interface__slow_delayed_rectifier_potassium_current__nKs = rY[32];
        // Units: dimensionless; Initial value: 0.262753e-3
        double var_chaste_interface__ultra_rapidly_activating_delayed_rectifier_potassium_current__aur = rY[33];
        // Units: dimensionless; Initial value: 0.417069e-3
        double var_chaste_interface__ultra_rapidly_activating_delayed_rectifier_potassium_current__iur = rY[34];
        // Units: dimensionless; Initial value: 0.998543
        double var_chaste_interface__non_inactivating_steady_state_potassium_current__aKss = rY[35];
        // Units: dimensionless; Initial value: 0.417069e-3
        double var_chaste_interface__non_inactivating_steady_state_potassium_current__iKss = rY[36];
        // Units: dimensionless; Initial value: 1
        double var_chaste_interface__rapid_delayed_rectifier_potassium_current__O_K = rY[37];
        // Units: dimensionless; Initial value: 0.175298e-3
        double var_chaste_interface__rapid_delayed_rectifier_potassium_current__C_K1 = rY[38];
        // Units: dimensionless; Initial value: 0.992513e-3
        double var_chaste_interface__rapid_delayed_rectifier_potassium_current__C_K2 = rY[39];
        // Units: dimensionless; Initial value: 0.641229e-3
        double var_chaste_interface__rapid_delayed_rectifier_potassium_current__I_K = rY[40];
        // Units: dimensionless; Initial value: 0.319129e-4
        
        
        // Mathematics
        double d_dt_chaste_interface__membrane__V;
        const double var_membrane__Cm = 1.0; // microF_per_cm2
        const double var_L_type_calcium_current__i_CaL = 0.1729 * var_chaste_interface__L_type_calcium_current__O * (var_chaste_interface__membrane__V - 63.0); // picoA_per_picoF
        const double var_calcium_pump_current__i_pCa = (1.0 * pow(var_chaste_interface__calcium_concentration__Cai, 2.0)) / (0.25 + pow(var_chaste_interface__calcium_concentration__Cai, 2.0)); // picoA_per_picoF
        const double var_sodium_calcium_exchange_current__i_NaCa = (2.6970585464294846e-17 / (1.0 + (0.10000000000000001 * exp((var_chaste_interface__membrane__V *  -62.725000000000001) * 0.00040362096439578745)))) * ((exp((var_chaste_interface__membrane__V * 33.774999999999999) * 0.00040362096439578745) * pow(var_chaste_interface__sodium_concentration__Nai, 3.0) * 1800.0) - (exp((var_chaste_interface__membrane__V *  -62.725000000000001) * 0.00040362096439578745) * 2744000000000000.0 * var_chaste_interface__calcium_concentration__Cai)); // picoA_per_picoF
        const double var_calcium_background_current__i_Cab = 0.00036699999999999998 * (var_chaste_interface__membrane__V - (12.837160621761658 * log(1800.0 / var_chaste_interface__calcium_concentration__Cai))); // picoA_per_picoF
        const double var_fast_sodium_current__E_Na = 25.674321243523316 * log(126540.0 / ((0.90000000000000002 * var_chaste_interface__sodium_concentration__Nai) + (0.10000000000000001 * var_chaste_interface__potassium_concentration__Ki))); // millivolt
        const double var_fast_sodium_current__i_Na = 13.0 * var_chaste_interface__fast_sodium_current__O_Na * (var_chaste_interface__membrane__V - var_fast_sodium_current__E_Na); // picoA_per_picoF
        const double var_sodium_background_current__i_Nab = 0.0025999999999999999 * (var_chaste_interface__membrane__V - var_fast_sodium_current__E_Na); // picoA_per_picoF
        const double var_sodium_potassium_pump_current__i_NaK = ((((1.0 / (1.0 + (0.1245 * exp((var_chaste_interface__membrane__V *  -9.6500000000000004) * 0.00040362096439578745)) + (exp(((-var_chaste_interface__membrane__V) * 96.5) * 0.00040362096439578745) * 0.036533226130519084))) * 0.88) / (1.0 + pow(21000.0 / var_chaste_interface__sodium_concentration__Nai, 1.5))) * 5400.0) * 0.00014492753623188405; // picoA_per_picoF
        const double var_fast_transient_outward_potassium_current__E_K = 25.674321243523316 * log(5400.0 / var_chaste_interface__potassium_concentration__Ki); // millivolt
        const double var_fast_transient_outward_potassium_current__i_Kto_f = 0.40670000000000001 * pow(var_chaste_interface__fast_transient_outward_potassium_current__ato_f, 3.0) * var_chaste_interface__fast_transient_outward_potassium_current__ito_f * (var_chaste_interface__membrane__V - var_fast_transient_outward_potassium_current__E_K); // picoA_per_picoF
        const double var_slow_transient_outward_potassium_current__i_Kto_s = 0.0 * var_chaste_interface__slow_transient_outward_potassium_current__ato_s * var_chaste_interface__slow_transient_outward_potassium_current__ito_s * (var_chaste_interface__membrane__V - var_fast_transient_outward_potassium_current__E_K); // picoA_per_picoF
        const double var_time_independent_potassium_current__i_K1 = (0.28280213903743318 * (var_chaste_interface__membrane__V - var_fast_transient_outward_potassium_current__E_K)) / (1.0 + exp(0.089599999999999999 * (var_chaste_interface__membrane__V - var_fast_transient_outward_potassium_current__E_K))); // picoA_per_picoF
        const double var_slow_delayed_rectifier_potassium_current__i_Ks = 0.0057499999999999999 * pow(var_chaste_interface__slow_delayed_rectifier_potassium_current__nKs, 2.0) * (var_chaste_interface__membrane__V - var_fast_transient_outward_potassium_current__E_K); // picoA_per_picoF
        const double var_ultra_rapidly_activating_delayed_rectifier_potassium_current__i_Kur = 0.16 * var_chaste_interface__ultra_rapidly_activating_delayed_rectifier_potassium_current__aur * var_chaste_interface__ultra_rapidly_activating_delayed_rectifier_potassium_current__iur * (var_chaste_interface__membrane__V - var_fast_transient_outward_potassium_current__E_K); // picoA_per_picoF
        const double var_non_inactivating_steady_state_potassium_current__i_Kss = 0.050000000000000003 * var_chaste_interface__non_inactivating_steady_state_potassium_current__aKss * var_chaste_interface__non_inactivating_steady_state_potassium_current__iKss * (var_chaste_interface__membrane__V - var_fast_transient_outward_potassium_current__E_K); // picoA_per_picoF
        const double var_rapid_delayed_rectifier_potassium_current__i_Kr = 0.078 * var_chaste_interface__rapid_delayed_rectifier_potassium_current__O_K * (var_chaste_interface__membrane__V - (25.674321243523316 * log(8092.0 / ((0.97999999999999998 * var_chaste_interface__potassium_concentration__Ki) + (0.02 * var_chaste_interface__sodium_concentration__Nai))))); // picoA_per_picoF
        const double var_calcium_fluxes__J_leak = 1.7399999999999999e-05 * (var_chaste_interface__calcium_concentration__CaNSR - var_chaste_interface__calcium_concentration__Cai); // micromolar_per_millisecond
        const double var_calcium_fluxes__J_rel = 4.5 * (var_chaste_interface__ryanodine_receptors__P_O1 + var_chaste_interface__ryanodine_receptors__P_O2) * (var_chaste_interface__calcium_concentration__CaJSR - var_chaste_interface__calcium_concentration__Cass) * var_chaste_interface__calcium_fluxes__P_RyR; // micromolar_per_millisecond
        const double var_calcium_fluxes__J_up = (0.45000000000000001 * pow(var_chaste_interface__calcium_concentration__Cai, 2.0)) / (0.25 + pow(var_chaste_interface__calcium_concentration__Cai, 2.0)); // micromolar_per_millisecond
        const double var_calcium_fluxes__J_tr = (var_chaste_interface__calcium_concentration__CaNSR - var_chaste_interface__calcium_concentration__CaJSR) * 0.050000000000000003; // micromolar_per_millisecond
        const double var_calcium_fluxes__J_xfer = (var_chaste_interface__calcium_concentration__Cass - var_chaste_interface__calcium_concentration__Cai) * 0.125; // micromolar_per_millisecond
        const double var_L_type_calcium_current__alpha = (0.40000000000000002 * exp((var_chaste_interface__membrane__V + 12.0) * 0.10000000000000001) * ((1.0 + (0.69999999999999996 * exp((-pow(var_chaste_interface__membrane__V + 40.0, 2.0)) * 0.10000000000000001))) - (0.75 * exp((-pow(var_chaste_interface__membrane__V + 20.0, 2.0)) * 0.0025000000000000001)))) / (1.0 + (0.12 * exp((var_chaste_interface__membrane__V + 12.0) * 0.10000000000000001))); // per_millisecond
        const double var_L_type_calcium_current__beta = 0.050000000000000003 * exp((-(var_chaste_interface__membrane__V + 12.0)) * 0.076923076923076927); // per_millisecond
        const double var_L_type_calcium_current__gamma = (0.23324 * var_chaste_interface__calcium_concentration__Cass) / (20.0 + var_chaste_interface__calcium_concentration__Cass); // per_millisecond
        const double var_L_type_calcium_current__Kpcf = 13.0 * (1.0 - exp((-pow(var_chaste_interface__membrane__V + 14.5, 2.0)) * 0.01)); // per_millisecond
        const double var_fast_sodium_current__C_Na3 = 1.0 - (var_chaste_interface__fast_sodium_current__O_Na + var_chaste_interface__fast_sodium_current__C_Na1 + var_chaste_interface__fast_sodium_current__C_Na2 + var_chaste_interface__fast_sodium_current__IF_Na + var_chaste_interface__fast_sodium_current__I1_Na + var_chaste_interface__fast_sodium_current__I2_Na + var_chaste_interface__fast_sodium_current__IC_Na2 + var_chaste_interface__fast_sodium_current__IC_Na3); // dimensionless
        const double var_fast_sodium_current__alpha_Na11 = 3.802 / ((0.1027 * exp((-(var_chaste_interface__membrane__V + 2.5)) * 0.058823529411764705)) + (0.20000000000000001 * exp((-(var_chaste_interface__membrane__V + 2.5)) * 0.0066666666666666671))); // per_millisecond
        const double var_fast_sodium_current__beta_Na11 = 0.19170000000000001 * exp((-(var_chaste_interface__membrane__V + 2.5)) * 0.04926108374384236); // per_millisecond
        const double var_fast_sodium_current__alpha_Na12 = 3.802 / ((0.1027 * exp((-(var_chaste_interface__membrane__V + 2.5)) * 0.066666666666666666)) + (0.23000000000000001 * exp((-(var_chaste_interface__membrane__V + 2.5)) * 0.0066666666666666671))); // per_millisecond
        const double var_fast_sodium_current__beta_Na12 = 0.20000000000000001 * exp((-(var_chaste_interface__membrane__V - 2.5)) * 0.04926108374384236); // per_millisecond
        const double var_fast_sodium_current__alpha_Na13 = 3.802 / ((0.1027 * exp((-(var_chaste_interface__membrane__V + 2.5)) * 0.083333333333333329)) + (0.25 * exp((-(var_chaste_interface__membrane__V + 2.5)) * 0.0066666666666666671))); // per_millisecond
        const double var_fast_sodium_current__beta_Na13 = 0.22 * exp((-(var_chaste_interface__membrane__V - 7.5)) * 0.04926108374384236); // per_millisecond
        const double var_fast_sodium_current__alpha_Na3 = 6.9999999999999997e-07 * exp((-(var_chaste_interface__membrane__V + 7.0)) * 0.12987012987012986); // per_millisecond
        const double var_fast_sodium_current__beta_Na3 = 0.0083999999999999995 + (2.0000000000000002e-05 * (var_chaste_interface__membrane__V + 7.0)); // per_millisecond
        const double var_fast_sodium_current__alpha_Na2 = 1.0 / ((0.188495 * exp((-(var_chaste_interface__membrane__V + 7.0)) * 0.060240963855421679)) + 0.39395599999999997); // per_millisecond
        const double var_fast_sodium_current__beta_Na2 = (var_fast_sodium_current__alpha_Na13 * var_fast_sodium_current__alpha_Na2 * var_fast_sodium_current__alpha_Na3) / (var_fast_sodium_current__beta_Na13 * var_fast_sodium_current__beta_Na3); // per_millisecond
        const double var_fast_sodium_current__alpha_Na4 = var_fast_sodium_current__alpha_Na2 * 0.001; // per_millisecond
        const double var_fast_sodium_current__beta_Na4 = var_fast_sodium_current__alpha_Na3; // per_millisecond
        const double var_fast_sodium_current__alpha_Na5 = var_fast_sodium_current__alpha_Na2 * 1.0526315789473684e-05; // per_millisecond
        const double var_fast_sodium_current__beta_Na5 = var_fast_sodium_current__alpha_Na3 * 0.02; // per_millisecond
        const double var_slow_transient_outward_potassium_current__ass = 1.0 / (1.0 + exp((-(var_chaste_interface__membrane__V + 22.5)) * 0.12987012987012986)); // dimensionless
        const double var_slow_transient_outward_potassium_current__iss = 1.0 / (1.0 + exp((var_chaste_interface__membrane__V + 45.200000000000003) * 0.17543859649122806)); // dimensionless
        const double var_rapid_delayed_rectifier_potassium_current__alpha_a1 = 0.013733 * exp(0.038198000000000003 * var_chaste_interface__membrane__V); // per_millisecond
        const double var_rapid_delayed_rectifier_potassium_current__beta_a1 = 6.8899999999999994e-05 * exp( -0.041779999999999998 * var_chaste_interface__membrane__V); // per_millisecond
        const double var_rapid_delayed_rectifier_potassium_current__alpha_i = 0.090820999999999999 * exp(0.023390999999999999 * (var_chaste_interface__membrane__V + 5.0)); // per_millisecond
        const double var_rapid_delayed_rectifier_potassium_current__beta_i = 0.0064970000000000002 * exp( -0.032680000000000001 * (var_chaste_interface__membrane__V + 5.0)); // per_millisecond
        const double d_dt_chaste_interface__calcium_concentration__Cai = pow(1.0 + (11.899999999999999 / pow(0.23799999999999999 + var_chaste_interface__calcium_concentration__Cai, 2.0)),  -1.0) * ((var_calcium_fluxes__J_leak + var_calcium_fluxes__J_xfer) - (var_calcium_fluxes__J_up + (((0.0023700000000000001 * var_chaste_interface__calcium_concentration__Cai * (140.0 - var_chaste_interface__calcium_buffering__HTRPN_Ca)) + (0.0327 * var_chaste_interface__calcium_concentration__Cai * (70.0 - var_chaste_interface__calcium_buffering__LTRPN_Ca))) - ((3.1999999999999999e-05 * var_chaste_interface__calcium_buffering__HTRPN_Ca) + (0.019599999999999999 * var_chaste_interface__calcium_buffering__LTRPN_Ca))) + ((((var_calcium_background_current__i_Cab + var_calcium_pump_current__i_pCa) - (2.0 * var_sodium_calcium_exchange_current__i_NaCa)) * 0.00015339999999999999 * var_membrane__Cm) * 200.51653058278123))); // 'micromole per litre per millisecond'
        const double d_dt_chaste_interface__calcium_concentration__Cass = pow(1.0 + (11.899999999999999 / pow(0.23799999999999999 + var_chaste_interface__calcium_concentration__Cass, 2.0)),  -1.0) * (((var_calcium_fluxes__J_rel * 1.1999999999999999e-07) * 673400673.40067339) - (((var_calcium_fluxes__J_xfer * 2.584e-05) * 673400673.40067339) + ((var_L_type_calcium_current__i_CaL * 0.00015339999999999999 * var_membrane__Cm) * 3489122.6601071167))); // 'micromole per litre per millisecond'
        const double d_dt_chaste_interface__calcium_concentration__CaJSR = pow(1.0 + (12000000.0 / pow(800.0 + var_chaste_interface__calcium_concentration__CaJSR, 2.0)),  -1.0) * (var_calcium_fluxes__J_tr - var_calcium_fluxes__J_rel); // 'micromole per litre per millisecond'
        const double d_dt_chaste_interface__calcium_concentration__CaNSR = (((var_calcium_fluxes__J_up - var_calcium_fluxes__J_leak) * 2.584e-05) * 476644.42326024786) - ((var_calcium_fluxes__J_tr * 1.1999999999999999e-07) * 476644.42326024786); // 'micromole per litre per millisecond'
        const double d_dt_chaste_interface__calcium_fluxes__P_RyR = ( -0.040000000000000001 * var_chaste_interface__calcium_fluxes__P_RyR) - (((0.10000000000000001 * var_L_type_calcium_current__i_CaL) * 0.14285714285714285) * exp((-pow(var_chaste_interface__membrane__V - 5.0, 2.0)) * 0.0015432098765432098)); // per_millisecond
        const double d_dt_chaste_interface__calcium_buffering__LTRPN_Ca = (0.0327 * var_chaste_interface__calcium_concentration__Cai * (70.0 - var_chaste_interface__calcium_buffering__LTRPN_Ca)) - (0.019599999999999999 * var_chaste_interface__calcium_buffering__LTRPN_Ca); // 'micromole per litre per millisecond'
        const double d_dt_chaste_interface__calcium_buffering__HTRPN_Ca = (0.0023700000000000001 * var_chaste_interface__calcium_concentration__Cai * (140.0 - var_chaste_interface__calcium_buffering__HTRPN_Ca)) - (3.1999999999999999e-05 * var_chaste_interface__calcium_buffering__HTRPN_Ca); // 'micromole per litre per millisecond'
        const double d_dt_chaste_interface__ryanodine_receptors__P_O1 = ((0.0060749999999999997 * pow(var_chaste_interface__calcium_concentration__Cass, 4.0) * (1.0 - (var_chaste_interface__ryanodine_receptors__P_C2 + var_chaste_interface__ryanodine_receptors__P_O1 + var_chaste_interface__ryanodine_receptors__P_O2))) + (0.96499999999999997 * var_chaste_interface__ryanodine_receptors__P_O2) + (0.00080000000000000004 * var_chaste_interface__ryanodine_receptors__P_C2)) - ((0.071249999999999994 * var_chaste_interface__ryanodine_receptors__P_O1) + (0.0040499999999999998 * pow(var_chaste_interface__calcium_concentration__Cass, 3.0) * var_chaste_interface__ryanodine_receptors__P_O1) + (0.0089999999999999993 * var_chaste_interface__ryanodine_receptors__P_O1)); // per_millisecond
        const double d_dt_chaste_interface__ryanodine_receptors__P_O2 = (0.0040499999999999998 * pow(var_chaste_interface__calcium_concentration__Cass, 3.0) * var_chaste_interface__ryanodine_receptors__P_O1) - (0.96499999999999997 * var_chaste_interface__ryanodine_receptors__P_O2); // per_millisecond
        const double d_dt_chaste_interface__ryanodine_receptors__P_C2 = (0.0089999999999999993 * var_chaste_interface__ryanodine_receptors__P_O1) - (0.00080000000000000004 * var_chaste_interface__ryanodine_receptors__P_C2); // per_millisecond
        const double d_dt_chaste_interface__L_type_calcium_current__O = ((var_L_type_calcium_current__alpha * var_chaste_interface__L_type_calcium_current__C4) + (0.00050000000000000001 * var_chaste_interface__L_type_calcium_current__I1) + (0.001 * ((var_L_type_calcium_current__alpha * var_chaste_interface__L_type_calcium_current__I2) - (var_L_type_calcium_current__Kpcf * var_chaste_interface__L_type_calcium_current__O)))) - ((4.0 * var_L_type_calcium_current__beta * var_chaste_interface__L_type_calcium_current__O) + (var_L_type_calcium_current__gamma * var_chaste_interface__L_type_calcium_current__O)); // per_millisecond
        const double d_dt_chaste_interface__L_type_calcium_current__C2 = ((4.0 * var_L_type_calcium_current__alpha * (1.0 - (var_chaste_interface__L_type_calcium_current__O + var_chaste_interface__L_type_calcium_current__C2 + var_chaste_interface__L_type_calcium_current__C2 + var_chaste_interface__L_type_calcium_current__C3 + var_chaste_interface__L_type_calcium_current__C4 + var_chaste_interface__L_type_calcium_current__I1 + var_chaste_interface__L_type_calcium_current__I2 + var_chaste_interface__L_type_calcium_current__I3))) + (2.0 * var_L_type_calcium_current__beta * var_chaste_interface__L_type_calcium_current__C3)) - ((var_L_type_calcium_current__beta * var_chaste_interface__L_type_calcium_current__C2) + (3.0 * var_L_type_calcium_current__alpha * var_chaste_interface__L_type_calcium_current__C2)); // per_millisecond
        const double d_dt_chaste_interface__L_type_calcium_current__C3 = ((3.0 * var_L_type_calcium_current__alpha * var_chaste_interface__L_type_calcium_current__C2) + (3.0 * var_L_type_calcium_current__beta * var_chaste_interface__L_type_calcium_current__C4)) - ((2.0 * var_L_type_calcium_current__beta * var_chaste_interface__L_type_calcium_current__C3) + (2.0 * var_L_type_calcium_current__alpha * var_chaste_interface__L_type_calcium_current__C3)); // per_millisecond
        const double d_dt_chaste_interface__L_type_calcium_current__C4 = ((2.0 * var_L_type_calcium_current__alpha * var_chaste_interface__L_type_calcium_current__C3) + (4.0 * var_L_type_calcium_current__beta * var_chaste_interface__L_type_calcium_current__O) + (0.01 * ((var_L_type_calcium_current__beta * var_chaste_interface__L_type_calcium_current__I1 * 0.002) - (var_L_type_calcium_current__alpha * var_L_type_calcium_current__gamma * var_chaste_interface__L_type_calcium_current__C4))) + (0.002 * ((4.0 * var_L_type_calcium_current__beta * var_chaste_interface__L_type_calcium_current__I2) - (var_L_type_calcium_current__Kpcf * var_chaste_interface__L_type_calcium_current__C4))) + (var_L_type_calcium_current__beta * var_chaste_interface__L_type_calcium_current__I3 * 0.002)) - ((3.0 * var_L_type_calcium_current__beta * var_chaste_interface__L_type_calcium_current__C4) + (var_L_type_calcium_current__alpha * var_chaste_interface__L_type_calcium_current__C4) + (1.0 * var_L_type_calcium_current__gamma * var_L_type_calcium_current__Kpcf * var_chaste_interface__L_type_calcium_current__C4)); // per_millisecond
        const double d_dt_chaste_interface__L_type_calcium_current__I1 = ((var_L_type_calcium_current__gamma * var_chaste_interface__L_type_calcium_current__O) + (0.001 * ((var_L_type_calcium_current__alpha * var_chaste_interface__L_type_calcium_current__I3) - (var_L_type_calcium_current__Kpcf * var_chaste_interface__L_type_calcium_current__I1))) + (0.01 * ((var_L_type_calcium_current__alpha * var_L_type_calcium_current__gamma * var_chaste_interface__L_type_calcium_current__C4) - (4.0 * var_L_type_calcium_current__beta * var_L_type_calcium_current__Kpcf * var_chaste_interface__L_type_calcium_current__I1)))) - (0.00050000000000000001 * var_chaste_interface__L_type_calcium_current__I1); // per_millisecond
        const double d_dt_chaste_interface__L_type_calcium_current__I2 = ((0.001 * ((var_L_type_calcium_current__Kpcf * var_chaste_interface__L_type_calcium_current__O) - (var_L_type_calcium_current__alpha * var_chaste_interface__L_type_calcium_current__I2))) + (0.00050000000000000001 * var_chaste_interface__L_type_calcium_current__I3) + (0.002 * ((var_L_type_calcium_current__Kpcf * var_chaste_interface__L_type_calcium_current__C4) - (4.0 * var_L_type_calcium_current__beta * var_chaste_interface__L_type_calcium_current__I2)))) - (var_L_type_calcium_current__gamma * var_chaste_interface__L_type_calcium_current__I2); // per_millisecond
        const double d_dt_chaste_interface__L_type_calcium_current__I3 = ((0.001 * ((var_L_type_calcium_current__Kpcf * var_chaste_interface__L_type_calcium_current__I1) - (var_L_type_calcium_current__alpha * var_chaste_interface__L_type_calcium_current__I3))) + (var_L_type_calcium_current__gamma * var_chaste_interface__L_type_calcium_current__I2) + (1.0 * var_L_type_calcium_current__gamma * var_L_type_calcium_current__Kpcf * var_chaste_interface__L_type_calcium_current__C4)) - ((var_L_type_calcium_current__beta * var_chaste_interface__L_type_calcium_current__I3 * 0.002) + (0.00050000000000000001 * var_chaste_interface__L_type_calcium_current__I3)); // per_millisecond
        const double d_dt_chaste_interface__sodium_concentration__Nai = ((-(var_fast_sodium_current__i_Na + var_sodium_background_current__i_Nab + (3.0 * var_sodium_potassium_pump_current__i_NaK) + (3.0 * var_sodium_calcium_exchange_current__i_NaCa))) * 0.00015339999999999999 * var_membrane__Cm) * 401.03306116556246; // 'micromole per litre per millisecond'
        const double d_dt_chaste_interface__fast_sodium_current__O_Na = ((var_fast_sodium_current__alpha_Na13 * var_chaste_interface__fast_sodium_current__C_Na1) + (var_fast_sodium_current__beta_Na2 * var_chaste_interface__fast_sodium_current__IF_Na)) - ((var_fast_sodium_current__beta_Na13 * var_chaste_interface__fast_sodium_current__O_Na) + (var_fast_sodium_current__alpha_Na2 * var_chaste_interface__fast_sodium_current__O_Na)); // per_millisecond
        const double d_dt_chaste_interface__fast_sodium_current__C_Na1 = ((var_fast_sodium_current__alpha_Na12 * var_chaste_interface__fast_sodium_current__C_Na2) + (var_fast_sodium_current__beta_Na13 * var_chaste_interface__fast_sodium_current__O_Na) + (var_fast_sodium_current__alpha_Na3 * var_chaste_interface__fast_sodium_current__IF_Na)) - ((var_fast_sodium_current__beta_Na12 * var_chaste_interface__fast_sodium_current__C_Na1) + (var_fast_sodium_current__alpha_Na13 * var_chaste_interface__fast_sodium_current__C_Na1) + (var_fast_sodium_current__beta_Na3 * var_chaste_interface__fast_sodium_current__C_Na1)); // per_millisecond
        const double d_dt_chaste_interface__fast_sodium_current__C_Na2 = ((var_fast_sodium_current__alpha_Na11 * var_fast_sodium_current__C_Na3) + (var_fast_sodium_current__beta_Na12 * var_chaste_interface__fast_sodium_current__C_Na1) + (var_fast_sodium_current__alpha_Na3 * var_chaste_interface__fast_sodium_current__IC_Na2)) - ((var_fast_sodium_current__beta_Na11 * var_chaste_interface__fast_sodium_current__C_Na2) + (var_fast_sodium_current__alpha_Na12 * var_chaste_interface__fast_sodium_current__C_Na2) + (var_fast_sodium_current__beta_Na3 * var_chaste_interface__fast_sodium_current__C_Na2)); // per_millisecond
        const double d_dt_chaste_interface__fast_sodium_current__I1_Na = ((var_fast_sodium_current__alpha_Na4 * var_chaste_interface__fast_sodium_current__IF_Na) + (var_fast_sodium_current__beta_Na5 * var_chaste_interface__fast_sodium_current__I2_Na)) - ((var_fast_sodium_current__beta_Na4 * var_chaste_interface__fast_sodium_current__I1_Na) + (var_fast_sodium_current__alpha_Na5 * var_chaste_interface__fast_sodium_current__I1_Na)); // per_millisecond
        const double d_dt_chaste_interface__fast_sodium_current__I2_Na = (var_fast_sodium_current__alpha_Na5 * var_chaste_interface__fast_sodium_current__I1_Na) - (var_fast_sodium_current__beta_Na5 * var_chaste_interface__fast_sodium_current__I2_Na); // per_millisecond
        const double d_dt_chaste_interface__fast_sodium_current__IF_Na = ((var_fast_sodium_current__alpha_Na2 * var_chaste_interface__fast_sodium_current__O_Na) + (var_fast_sodium_current__beta_Na3 * var_chaste_interface__fast_sodium_current__C_Na1) + (var_fast_sodium_current__beta_Na4 * var_chaste_interface__fast_sodium_current__I1_Na) + (var_fast_sodium_current__alpha_Na12 * var_chaste_interface__fast_sodium_current__IC_Na2)) - ((var_fast_sodium_current__beta_Na2 * var_chaste_interface__fast_sodium_current__IF_Na) + (var_fast_sodium_current__alpha_Na3 * var_chaste_interface__fast_sodium_current__IF_Na) + (var_fast_sodium_current__alpha_Na4 * var_chaste_interface__fast_sodium_current__IF_Na) + (var_fast_sodium_current__beta_Na12 * var_chaste_interface__fast_sodium_current__IF_Na)); // per_millisecond
        const double d_dt_chaste_interface__fast_sodium_current__IC_Na2 = ((var_fast_sodium_current__alpha_Na11 * var_chaste_interface__fast_sodium_current__IC_Na3) + (var_fast_sodium_current__beta_Na12 * var_chaste_interface__fast_sodium_current__IF_Na) + (var_fast_sodium_current__beta_Na3 * var_chaste_interface__fast_sodium_current__C_Na2)) - ((var_fast_sodium_current__beta_Na11 * var_chaste_interface__fast_sodium_current__IC_Na2) + (var_fast_sodium_current__alpha_Na12 * var_chaste_interface__fast_sodium_current__IC_Na2) + (var_fast_sodium_current__alpha_Na3 * var_chaste_interface__fast_sodium_current__IC_Na2)); // per_millisecond
        const double d_dt_chaste_interface__fast_sodium_current__IC_Na3 = ((var_fast_sodium_current__beta_Na11 * var_chaste_interface__fast_sodium_current__IC_Na2) + (var_fast_sodium_current__beta_Na3 * var_fast_sodium_current__C_Na3)) - ((var_fast_sodium_current__alpha_Na11 * var_chaste_interface__fast_sodium_current__IC_Na3) + (var_fast_sodium_current__alpha_Na3 * var_chaste_interface__fast_sodium_current__IC_Na3)); // per_millisecond
        const double d_dt_chaste_interface__potassium_concentration__Ki = ((-((var_fast_transient_outward_potassium_current__i_Kto_f + var_slow_transient_outward_potassium_current__i_Kto_s + var_time_independent_potassium_current__i_K1 + var_slow_delayed_rectifier_potassium_current__i_Ks + var_non_inactivating_steady_state_potassium_current__i_Kss + var_ultra_rapidly_activating_delayed_rectifier_potassium_current__i_Kur + var_rapid_delayed_rectifier_potassium_current__i_Kr) - (2.0 * var_sodium_potassium_pump_current__i_NaK))) * 0.00015339999999999999 * var_membrane__Cm) * 401.03306116556246; // 'micromole per litre per millisecond'
        const double d_dt_chaste_interface__non_inactivating_steady_state_potassium_current__iKss = 0.0; // per_millisecond
        const double d_dt_chaste_interface__rapid_delayed_rectifier_potassium_current__O_K = ((var_rapid_delayed_rectifier_potassium_current__alpha_a1 * var_chaste_interface__rapid_delayed_rectifier_potassium_current__C_K2) + (var_rapid_delayed_rectifier_potassium_current__beta_i * var_chaste_interface__rapid_delayed_rectifier_potassium_current__I_K)) - ((var_rapid_delayed_rectifier_potassium_current__beta_a1 * var_chaste_interface__rapid_delayed_rectifier_potassium_current__O_K) + (var_rapid_delayed_rectifier_potassium_current__alpha_i * var_chaste_interface__rapid_delayed_rectifier_potassium_current__O_K)); // per_millisecond
        const double d_dt_chaste_interface__rapid_delayed_rectifier_potassium_current__C_K1 = (((0.022348 * exp(0.01176 * var_chaste_interface__membrane__V)) * (1.0 - (var_chaste_interface__rapid_delayed_rectifier_potassium_current__C_K1 + var_chaste_interface__rapid_delayed_rectifier_potassium_current__C_K2 + var_chaste_interface__rapid_delayed_rectifier_potassium_current__O_K + var_chaste_interface__rapid_delayed_rectifier_potassium_current__I_K))) + (0.036777999999999998 * var_chaste_interface__rapid_delayed_rectifier_potassium_current__C_K2)) - (((0.047002000000000002 * exp( -0.063100000000000003 * var_chaste_interface__membrane__V)) * var_chaste_interface__rapid_delayed_rectifier_potassium_current__C_K1) + (0.023761000000000001 * var_chaste_interface__rapid_delayed_rectifier_potassium_current__C_K1)); // per_millisecond
        const double d_dt_chaste_interface__rapid_delayed_rectifier_potassium_current__C_K2 = ((0.023761000000000001 * var_chaste_interface__rapid_delayed_rectifier_potassium_current__C_K1) + (var_rapid_delayed_rectifier_potassium_current__beta_a1 * var_chaste_interface__rapid_delayed_rectifier_potassium_current__O_K)) - ((0.036777999999999998 * var_chaste_interface__rapid_delayed_rectifier_potassium_current__C_K2) + (var_rapid_delayed_rectifier_potassium_current__alpha_a1 * var_chaste_interface__rapid_delayed_rectifier_potassium_current__C_K2)); // per_millisecond
        const double d_dt_chaste_interface__rapid_delayed_rectifier_potassium_current__I_K = (var_rapid_delayed_rectifier_potassium_current__alpha_i * var_chaste_interface__rapid_delayed_rectifier_potassium_current__O_K) - (var_rapid_delayed_rectifier_potassium_current__beta_i * var_chaste_interface__rapid_delayed_rectifier_potassium_current__I_K); // per_millisecond
        
        if (mSetVoltageDerivativeToZero)
        {
            d_dt_chaste_interface__membrane__V = 0.0;
        }
        else
        {
            const double var_chaste_interface__membrane__i_stim = GetIntracellularAreaStimulus(var_chaste_interface__environment__time);
            const double var_calcium_activated_chloride_current__i_ClCa = ((10.0 * (0.20000000000000001 / (1.0 + exp((-(var_chaste_interface__membrane__V - 46.700000000000003)) * 0.12820512820512822))) * var_chaste_interface__calcium_concentration__Cai) / (var_chaste_interface__calcium_concentration__Cai + 10.0)) * (var_chaste_interface__membrane__V -  -40.0); // picoA_per_picoF
            d_dt_chaste_interface__membrane__V = -(var_L_type_calcium_current__i_CaL + var_calcium_pump_current__i_pCa + var_sodium_calcium_exchange_current__i_NaCa + var_calcium_background_current__i_Cab + var_fast_sodium_current__i_Na + var_sodium_background_current__i_Nab + var_sodium_potassium_pump_current__i_NaK + var_fast_transient_outward_potassium_current__i_Kto_f + var_slow_transient_outward_potassium_current__i_Kto_s + var_time_independent_potassium_current__i_K1 + var_slow_delayed_rectifier_potassium_current__i_Ks + var_ultra_rapidly_activating_delayed_rectifier_potassium_current__i_Kur + var_non_inactivating_steady_state_potassium_current__i_Kss + var_rapid_delayed_rectifier_potassium_current__i_Kr + var_calcium_activated_chloride_current__i_ClCa + (var_chaste_interface__membrane__i_stim / HeartConfig::Instance()->GetCapacitance())); // 'millivolt per millisecond'
        }
        
        rDY[0] = d_dt_chaste_interface__membrane__V;
        rDY[1] = d_dt_chaste_interface__calcium_concentration__Cai;
        rDY[2] = d_dt_chaste_interface__calcium_concentration__Cass;
        rDY[3] = d_dt_chaste_interface__calcium_concentration__CaJSR;
        rDY[4] = d_dt_chaste_interface__calcium_concentration__CaNSR;
        rDY[5] = d_dt_chaste_interface__calcium_fluxes__P_RyR;
        rDY[6] = d_dt_chaste_interface__calcium_buffering__LTRPN_Ca;
        rDY[7] = d_dt_chaste_interface__calcium_buffering__HTRPN_Ca;
        rDY[8] = d_dt_chaste_interface__ryanodine_receptors__P_O1;
        rDY[9] = d_dt_chaste_interface__ryanodine_receptors__P_O2;
        rDY[10] = d_dt_chaste_interface__ryanodine_receptors__P_C2;
        rDY[11] = d_dt_chaste_interface__L_type_calcium_current__O;
        rDY[12] = d_dt_chaste_interface__L_type_calcium_current__C2;
        rDY[13] = d_dt_chaste_interface__L_type_calcium_current__C3;
        rDY[14] = d_dt_chaste_interface__L_type_calcium_current__C4;
        rDY[15] = d_dt_chaste_interface__L_type_calcium_current__I1;
        rDY[16] = d_dt_chaste_interface__L_type_calcium_current__I2;
        rDY[17] = d_dt_chaste_interface__L_type_calcium_current__I3;
        rDY[18] = d_dt_chaste_interface__sodium_concentration__Nai;
        rDY[19] = d_dt_chaste_interface__fast_sodium_current__O_Na;
        rDY[20] = d_dt_chaste_interface__fast_sodium_current__C_Na1;
        rDY[21] = d_dt_chaste_interface__fast_sodium_current__C_Na2;
        rDY[22] = d_dt_chaste_interface__fast_sodium_current__I1_Na;
        rDY[23] = d_dt_chaste_interface__fast_sodium_current__I2_Na;
        rDY[24] = d_dt_chaste_interface__fast_sodium_current__IF_Na;
        rDY[25] = d_dt_chaste_interface__fast_sodium_current__IC_Na2;
        rDY[26] = d_dt_chaste_interface__fast_sodium_current__IC_Na3;
        rDY[27] = d_dt_chaste_interface__potassium_concentration__Ki;
        rAlphaOrTau[28] = 0.18064 * exp(0.035770000000000003 * (var_chaste_interface__membrane__V + 30.0));
        rBetaOrInf[28] = 0.39560000000000001 * exp( -0.062370000000000002 * (var_chaste_interface__membrane__V + 30.0));
        rAlphaOrTau[29] = (0.00015200000000000001 * exp((-(var_chaste_interface__membrane__V + 13.5)) * 0.14285714285714285)) / ((0.0067083000000000004 * exp((-(var_chaste_interface__membrane__V + 33.5)) * 0.14285714285714285)) + 1.0);
        rBetaOrInf[29] = (0.00095 * exp((var_chaste_interface__membrane__V + 33.5) * 0.14285714285714285)) / ((0.051334999999999999 * exp((var_chaste_interface__membrane__V + 33.5) * 0.14285714285714285)) + 1.0);
        rAlphaOrTau[30] = (0.49299999999999999 * exp( -0.062899999999999998 * var_chaste_interface__membrane__V)) + 2.0579999999999998;
        rBetaOrInf[30] = var_slow_transient_outward_potassium_current__ass;
        rAlphaOrTau[31] = 270.0 + (1050.0 / (1.0 + exp((var_chaste_interface__membrane__V + 45.200000000000003) * 0.17543859649122806)));
        rBetaOrInf[31] = var_slow_transient_outward_potassium_current__iss;
        rAlphaOrTau[32] = (4.8133299999999997e-06 * (var_chaste_interface__membrane__V + 26.5)) / (1.0 - exp( -0.128 * (var_chaste_interface__membrane__V + 26.5)));
        rBetaOrInf[32] = 9.5333299999999997e-05 * exp( -0.037999999999999999 * (var_chaste_interface__membrane__V + 26.5));
        rAlphaOrTau[33] = (0.49299999999999999 * exp( -0.062899999999999998 * var_chaste_interface__membrane__V)) + 2.0579999999999998;
        rBetaOrInf[33] = var_slow_transient_outward_potassium_current__ass;
        rAlphaOrTau[34] = 1200.0 - (170.0 / (1.0 + exp((var_chaste_interface__membrane__V + 45.200000000000003) * 0.17543859649122806)));
        rBetaOrInf[34] = var_slow_transient_outward_potassium_current__iss;
        rAlphaOrTau[35] = (39.299999999999997 * exp( -0.086199999999999999 * var_chaste_interface__membrane__V)) + 13.17;
        rBetaOrInf[35] = var_slow_transient_outward_potassium_current__ass;
        rDY[36] = d_dt_chaste_interface__non_inactivating_steady_state_potassium_current__iKss;
        rDY[37] = d_dt_chaste_interface__rapid_delayed_rectifier_potassium_current__O_K;
        rDY[38] = d_dt_chaste_interface__rapid_delayed_rectifier_potassium_current__C_K1;
        rDY[39] = d_dt_chaste_interface__rapid_delayed_rectifier_potassium_current__C_K2;
        rDY[40] = d_dt_chaste_interface__rapid_delayed_rectifier_potassium_current__I_K;
    }
    
    void Dynamicbondarenko_model_2004_apexFromCellMLRushLarsen::ComputeOneStepExceptVoltage(const std::vector<double> &rDY, const std::vector<double> &rAlphaOrTau, const std::vector<double> &rBetaOrInf)
    {
        std::vector<double>& rY = rGetStateVariables();
        rY[1] += mDt * rDY[1];
        rY[2] += mDt * rDY[2];
        rY[3] += mDt * rDY[3];
        rY[4] += mDt * rDY[4];
        rY[5] += mDt * rDY[5];
        rY[6] += mDt * rDY[6];
        rY[7] += mDt * rDY[7];
        rY[8] += mDt * rDY[8];
        rY[9] += mDt * rDY[9];
        rY[10] += mDt * rDY[10];
        rY[11] += mDt * rDY[11];
        rY[12] += mDt * rDY[12];
        rY[13] += mDt * rDY[13];
        rY[14] += mDt * rDY[14];
        rY[15] += mDt * rDY[15];
        rY[16] += mDt * rDY[16];
        rY[17] += mDt * rDY[17];
        rY[18] += mDt * rDY[18];
        rY[19] += mDt * rDY[19];
        rY[20] += mDt * rDY[20];
        rY[21] += mDt * rDY[21];
        rY[22] += mDt * rDY[22];
        rY[23] += mDt * rDY[23];
        rY[24] += mDt * rDY[24];
        rY[25] += mDt * rDY[25];
        rY[26] += mDt * rDY[26];
        rY[27] += mDt * rDY[27];
        {
            const double tau_inv = rAlphaOrTau[28] + rBetaOrInf[28];
            const double y_inf = rAlphaOrTau[28] / tau_inv;
            rY[28] = y_inf + (rY[28] - y_inf)*exp(-mDt*tau_inv);
        }
        {
            const double tau_inv = rAlphaOrTau[29] + rBetaOrInf[29];
            const double y_inf = rAlphaOrTau[29] / tau_inv;
            rY[29] = y_inf + (rY[29] - y_inf)*exp(-mDt*tau_inv);
        }
        rY[30] = rBetaOrInf[30] + (rY[30] - rBetaOrInf[30])*exp(-mDt/rAlphaOrTau[30]);
        rY[31] = rBetaOrInf[31] + (rY[31] - rBetaOrInf[31])*exp(-mDt/rAlphaOrTau[31]);
        {
            const double tau_inv = rAlphaOrTau[32] + rBetaOrInf[32];
            const double y_inf = rAlphaOrTau[32] / tau_inv;
            rY[32] = y_inf + (rY[32] - y_inf)*exp(-mDt*tau_inv);
        }
        rY[33] = rBetaOrInf[33] + (rY[33] - rBetaOrInf[33])*exp(-mDt/rAlphaOrTau[33]);
        rY[34] = rBetaOrInf[34] + (rY[34] - rBetaOrInf[34])*exp(-mDt/rAlphaOrTau[34]);
        rY[35] = rBetaOrInf[35] + (rY[35] - rBetaOrInf[35])*exp(-mDt/rAlphaOrTau[35]);
        rY[36] += mDt * rDY[36];
        rY[37] += mDt * rDY[37];
        rY[38] += mDt * rDY[38];
        rY[39] += mDt * rDY[39];
        rY[40] += mDt * rDY[40];
    }
    
template<>
void OdeSystemInformation<Dynamicbondarenko_model_2004_apexFromCellMLRushLarsen>::Initialise(void)
{
    this->mSystemName = "bondarenko_model_2004_apex";
    this->mFreeVariableName = "environment__time";
    this->mFreeVariableUnits = "millisecond";
    
    // rY[0]:
    this->mVariableNames.push_back("membrane_voltage");
    this->mVariableUnits.push_back("millivolt");
    this->mInitialConditions.push_back(-82.4202);

    // rY[1]:
    this->mVariableNames.push_back("calcium_concentration__Cai");
    this->mVariableUnits.push_back("micromolar");
    this->mInitialConditions.push_back(0.115001);

    // rY[2]:
    this->mVariableNames.push_back("calcium_concentration__Cass");
    this->mVariableUnits.push_back("micromolar");
    this->mInitialConditions.push_back(0.115001);

    // rY[3]:
    this->mVariableNames.push_back("calcium_concentration__CaJSR");
    this->mVariableUnits.push_back("micromolar");
    this->mInitialConditions.push_back(1299.5);

    // rY[4]:
    this->mVariableNames.push_back("calcium_concentration__CaNSR");
    this->mVariableUnits.push_back("micromolar");
    this->mInitialConditions.push_back(1299.5);

    // rY[5]:
    this->mVariableNames.push_back("calcium_fluxes__P_RyR");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0);

    // rY[6]:
    this->mVariableNames.push_back("calcium_buffering__LTRPN_Ca");
    this->mVariableUnits.push_back("micromolar");
    this->mInitialConditions.push_back(11.2684);

    // rY[7]:
    this->mVariableNames.push_back("calcium_buffering__HTRPN_Ca");
    this->mVariableUnits.push_back("micromolar");
    this->mInitialConditions.push_back(125.29);

    // rY[8]:
    this->mVariableNames.push_back("ryanodine_receptors__P_O1");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.149102e-4);

    // rY[9]:
    this->mVariableNames.push_back("ryanodine_receptors__P_O2");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.951726e-10);

    // rY[10]:
    this->mVariableNames.push_back("ryanodine_receptors__P_C2");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.16774e-3);

    // rY[11]:
    this->mVariableNames.push_back("L_type_calcium_current__O");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.930308e-18);

    // rY[12]:
    this->mVariableNames.push_back("L_type_calcium_current__C2");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.124216e-3);

    // rY[13]:
    this->mVariableNames.push_back("L_type_calcium_current__C3");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.578679e-8);

    // rY[14]:
    this->mVariableNames.push_back("L_type_calcium_current__C4");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.119816e-12);

    // rY[15]:
    this->mVariableNames.push_back("L_type_calcium_current__I1");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.497923e-18);

    // rY[16]:
    this->mVariableNames.push_back("L_type_calcium_current__I2");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.345847e-13);

    // rY[17]:
    this->mVariableNames.push_back("L_type_calcium_current__I3");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.185106e-13);

    // rY[18]:
    this->mVariableNames.push_back("sodium_concentration__Nai");
    this->mVariableUnits.push_back("micromolar");
    this->mInitialConditions.push_back(14237.1);

    // rY[19]:
    this->mVariableNames.push_back("fast_sodium_current__O_Na");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.713483e-6);

    // rY[20]:
    this->mVariableNames.push_back("fast_sodium_current__C_Na1");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.279132e-3);

    // rY[21]:
    this->mVariableNames.push_back("fast_sodium_current__C_Na2");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.020752);

    // rY[22]:
    this->mVariableNames.push_back("fast_sodium_current__I1_Na");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.673345e-6);

    // rY[23]:
    this->mVariableNames.push_back("fast_sodium_current__I2_Na");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.155787e-8);

    // rY[24]:
    this->mVariableNames.push_back("fast_sodium_current__IF_Na");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.153176e-3);

    // rY[25]:
    this->mVariableNames.push_back("fast_sodium_current__IC_Na2");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.0113879);

    // rY[26]:
    this->mVariableNames.push_back("fast_sodium_current__IC_Na3");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.34278);

    // rY[27]:
    this->mVariableNames.push_back("potassium_concentration__Ki");
    this->mVariableUnits.push_back("micromolar");
    this->mInitialConditions.push_back(143720);

    // rY[28]:
    this->mVariableNames.push_back("fast_transient_outward_potassium_current__ato_f");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.265563e-2);

    // rY[29]:
    this->mVariableNames.push_back("fast_transient_outward_potassium_current__ito_f");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.999977);

    // rY[30]:
    this->mVariableNames.push_back("slow_transient_outward_potassium_current__ato_s");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.417069e-3);

    // rY[31]:
    this->mVariableNames.push_back("slow_transient_outward_potassium_current__ito_s");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.998543);

    // rY[32]:
    this->mVariableNames.push_back("slow_delayed_rectifier_potassium_current__nKs");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.262753e-3);

    // rY[33]:
    this->mVariableNames.push_back("ultra_rapidly_activating_delayed_rectifier_potassium_current__aur");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.417069e-3);

    // rY[34]:
    this->mVariableNames.push_back("ultra_rapidly_activating_delayed_rectifier_potassium_current__iur");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.998543);

    // rY[35]:
    this->mVariableNames.push_back("non_inactivating_steady_state_potassium_current__aKss");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.417069e-3);

    // rY[36]:
    this->mVariableNames.push_back("non_inactivating_steady_state_potassium_current__iKss");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(1);

    // rY[37]:
    this->mVariableNames.push_back("rapid_delayed_rectifier_potassium_current__O_K");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.175298e-3);

    // rY[38]:
    this->mVariableNames.push_back("rapid_delayed_rectifier_potassium_current__C_K1");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.992513e-3);

    // rY[39]:
    this->mVariableNames.push_back("rapid_delayed_rectifier_potassium_current__C_K2");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.641229e-3);

    // rY[40]:
    this->mVariableNames.push_back("rapid_delayed_rectifier_potassium_current__I_K");
    this->mVariableUnits.push_back("dimensionless");
    this->mInitialConditions.push_back(0.319129e-4);

    this->mAttributes["SuggestedForwardEulerTimestep"] = 0.0002;
    
    this->mInitialised = true;
}


// Serialization for Boost >= 1.36
#include "SerializationExportWrapperForCpp.hpp"
CHASTE_CLASS_EXPORT(Dynamicbondarenko_model_2004_apexFromCellMLRushLarsen)
extern "C"
{
    AbstractCardiacCellInterface* MakeCardiacCell(
            boost::shared_ptr<AbstractIvpOdeSolver> pSolver,
            boost::shared_ptr<AbstractStimulusFunction> pStimulus)
    {
        return new Dynamicbondarenko_model_2004_apexFromCellMLRushLarsen(pSolver, pStimulus);
    }
    
}

